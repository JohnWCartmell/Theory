\documentclass[10pt,a4paper]{scrartcl}
\usepackage[margin=3cm]{geometry}
\usepackage{pstricks}
\usepackage{pst-node}
\usepackage{pst-tree}
\usepackage{stmaryrd}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{verbatim}
\usepackage{enumerate}
\usepackage{calc}
\usepackage{url}
\usepackage{hyperref}

\input{../SharedMacros/theorems.macros}
\input{../SharedMacros/ccategories.macros}
\input{../SharedMacros/gats.macros}
\input{../SharedMacros/metagat.macros}
\input{../SharedMacros/ermacros}
\input{../SharedMacros/erdiagram}
\input{../SharedMacros/indexedsets.macros}

\renewcommand{\erpictureFolder}[0]{../SharedPictures}

\setcounter{equation}{0}
\bibliographystyle{plain} % was hplain

\title{Dependency Categories}
\author{John Cartmell\footnote{john.w.cartmell gmail.com}\\ \normalsize{\textit{Ad Otium}}}
\subtitle{Status: \normalsize{DRAFT --TREAT WITH CAUTION}}
\begin{document}
\maketitle

\begin{abstract}

\noindent Under a new name, \textit{dependency category}, this paper corrects the description of \textit{network categories} given in  
\cite{Cartmell86B}. Dependency categories are a variation on the notion of contextual category (\cite{Cartmell78}, \cite{Cartmell86}) in that  the category of dependency categories, as defined here, is equivalent to the category of cancellative contextual categories.

As in \cite{Cartmell86B} the motivation has been to formalise
and foreground the network structure of type dependencies so as to provide a theoretical foundation for the use of networks of composition relationships in entity modelling as applied both conceptually and, for the most practical of purposes, in systems development. 

The objects of  categories of either persuasion, either contextual categories or dependency categories, can be thought 
of as contexts or as types that vary (also known as dependent types) but equally they can be thought of as entity 
types in the sense used in entity modelling. The
morphisms of either correspond with the many-one binary relationships that are the staple fare of entity modelling and in either case there is a  distinguished subset of morphisms depicted on diagrams using a triangular headed arrow ($\darrow$). In a contextual category  the distinguished 
subset forms a hierarchy, in a dependency category the distinguished morphisms form not a hierarchy but a wide acyclic subcategory.
In either case the distinguished morphisms correspond to certain relationships known as composition relationships which feature
in certain styles of entity modelling (\cite{ECMA-149}, \cite{Munck1988}, \cite{entitymodelling}) and which were implied in the influential paper by Chen \cite{Chen1976} who introduced the idea of certain entities being dependent on binary relationships 
with others for both their identification and their existence.
\end{abstract}

\section{Introduction}
\noindent In this figure
%\begin{center}
\raisebox{-0.5cm}{
\pspicture(0,-0.1)(1.1,1)
\psline(0,0)(0,1)(1,1)(1,0)(0,0)
\psline (0,0)(1,1)
%\psline(0,0.5)(1,0.5)
%\psline(0.5,0)(0.5,1)
\endpspicture
}
%\end{center}
there are two triangles and these have six sides -- though the lines depicting these number only five; 
this possibility comes about
because in the statement that the two triangles have six sides we are understanding \textit{side}
to be \textit{side of triangle} which is to say that we understand it to be a concept that varies as
triangle varies. A side, therefore, is a dependent type of thing -- it is some thing held in the mind
in the context of some other thing. 
Similarly, certain words, such as the word `pop', appear in sentences sometimes as
nouns but also sometimes as verbs, or adjectives or as adverbs, so illustrating that a word, in and by itself, cannot be said to 
be a `noun', `verb', 'adjective' or other such part of speech,  lest it be appearing in some grammatical sentence and so `noun' and `verb`
and the like -- as types of thing -- are dependent on sentence-like types of thing.  \\

\noindent If in a situation temperature varies over position then it is implied - and might educate us if our notion of temperature was only half formed - that the concept of temperature had somehow in its make up a dependency on the concept of spatial position. 
So it is  with types that vary. 
Concepts like `angle', `edge', `boundary', `bounding line' as we learn these concepts,
we learn that they do not stand alone; they are dependent concepts as are  face of cube,  endpoint of line,   junction between lines, citizen (of a country), tangent (to a curve), atom of a molecule,  nucleus of a cell, character of a play. \\

\noindent  When a quantity y varies as some variable x varies then as matter of course the quantity might be written $y_{x}$ with the x subscript  reminding us of the dependency; or the quantity might be written $y(x)$ so using the notation of function application.  
If the quantities in question are real numbers then we may write either

\begin{equation*}
y_{x)x\in R}
\end{equation*}

\noindent or as something along the lines of:

\begin{equation*}
\text{for } x \in R,  y(x) \in R
\end{equation*}

\noindent Equally we might introduce $y$ at the outset not as a quantity but as a function $y$, $y: R \rightarrow R$. Note however that in a particular scientific enquiry, at the outset, what comes first is the quantities that are measured and the enquiry will often be to understand the quantities which can be measured and to understand over what domains they vary influenced by which variables - to discover the independent and dependent variables.
The point that is being made here is that in scientific enquiry \textit{quantities that vary} precede functions and quantities that vary do so according to context. \\

\noindent In a formal mathematical notation (\cite{Cartmell86} we introduce symbols for functions and, subsequently, dependent types by way of formal rules. For example we 
introduce types $A$ and $B$ and some function $f$ delivering entities of type $B$ from entities of type $A$ by the rules:
\begin{align}
&\text{                                  }\tstyle \isT{A} \\
&\text{                                  }\tstyle \isT{B} \\
&\ofT{x}{A} \tstyle \ofT{f(x)}{B} 
\end{align}
\noindent In rules such as these, variables are introduced to the left of the turnstyle($\tstyle$) and 
an assertion is given to the right. The left hand side presents a context in which the right hand side is asserted. 
We also write $f: A \rightarrow B$ for such a function and consider there to be a category of types and functional dependencies and represent such in the diagrams of catgeory theory. \\

\noindent
A somewhat different diagrammatic notation is available within the sphere of Information Systems Development,  entity model diagrams in the style of Barker, Ellis, Martin, Schlaer-Mellor and others (see \cite{Rock-Evans1989}), focus  on binary relationships between types of entity --
functional dependencies between types of entity are said to be many-one relationships and are depicted using the crows foot notation as, for example, here:
\erplainFig{functionfAB}{H}{Many-one Binary Relationship f between entity types A and B}

\noindent Of course there are quantities which do not vary  -- they are constant -- they do not have contexts they depend  on.  If $a$ is a constant of type $A$ then we assert: 
\begin{equation*}
\tstyle \ofT{a}{A}
\end{equation*}

\noindent Using the symbol $R$ for the type of real numbers then we have:
\begin{align*}
&\tstyle \isT{R} \\
&\tstyle \ofT{\pi}{R}
\end{align*}

\noindent Other quantities vary over a number of different dimensions and we represent them as functions
with multiple arguments. 
If a quantity of type $f$ varies over types $A_1$ and $A_2$, as for example electric potential varies over
space and time then we write it as a function with two arguments:
\begin{align*}
&\text{                                  }\tstyle \isT{A_1} \\
&\text{                                  }\tstyle \isT{A_2} \\
&\text{                                  }\tstyle \isT{B} \\
&\ofT{x_1}{A_1},\ofT{x_2}{A_2} \tstyle \ofT{f(x_1,x_2)}{B} 
\end{align*}
\noindent
We might also represent $f$ by a multiarrow in a graph:
\setlength{\arraycolsep}{1cm}
\begin{center}
$
\begin{array}{cccc}
\Rnode{A1}{A_1}& & \\
                & \Rnode{J1}{}& \Rnode{B}{B} \\
\Rnode{A2}{A_2}& & \\
\end{array}
$
\ncamarr{f}{A1}{A2}{J1}{B}

\end{center}
\setlength{\arraycolsep}{.2cm}
or as a function whose domain is the cartesian product of $A1$ and $A2$, which generally would be represented as $A_1 \times A_2$. \\

\noindent Consider that types are a kind of abstract quantity and we are led to the possibility that types
may vary just as quantities do and in particular that the \textit{type} of a quantity may vary as the \textit{quantity} itself  does.  \\

\noindent Various notations are used to express such type dependencies. For formal
mathematical purposes, the functional
notation used for quantities that vary can equally be used for types that vary. 
If the type of quantity f varies as f varies then we can assert this as follows: \\
\begin{align*}
&\text{                                  }\tstyle \isT{A} \\
&\ofT{x}{A} \tstyle \isT{B(x)} \\
&\ofT{x}{A} \tstyle \ofT{f(x)}{B(x)} 
\end{align*}
Such a $B$ is said to be dependent on type $A$. 
So, for example, `the side opposite an angle' in a study of triangles is a quantity (an entity)  which varies both as the triangle varies and as the angle varies:

\begin{equation*}
x \in Triangle, y \in Angle(x): oppositeSide(y) \in Side(x)
\end{equation*}

\noindent Similarly we can 
make type assertions such as
\begin{equation*}
x \in Country \tstyle headOfState(x) \in Citizen(x)
\end{equation*}

\noindent In this type assertion `headOfState' is a quantity which is varying, dependent on Country and is of a type which varies as the country varies.\\

\noindent
If $B$ is a type dependent on $A$ then instead of imagining type $B$ as having a set 
of instances we can imagine instead an A-indexed family of sets of instances. If in addition 
there is a $b$ such that $x \in A, b(x) \in B(x)$ (as `headOfState' above) then think 
of a  section of the family of sets of instances of $B$, see figure \ref{section}. 
If $B{a)a\in A}$ in an A-indexed family of sets the a section of B is a function $b:A \rightarrow \bigcup_{a \in A}{B(a)}$ such that
for each $a \in A, b(a) \in B(a)$. 
\begin{figure}[h]
\begin{pspicture}(0,0.5)(9,5.5)
%\psgrid
%\putfamilyOfSets[rot]{basescale}{childscale}{x}{y}{childoffset}{nodeprefix}
\rput{*270}(1,5){
  \putfamilyOfSets[*270]{.75}{0.4}{2cm}{2.5cm}{2.3cm}{FAM}
  }
\rput[l](1.5,4.2){ \psframebox*{set A} }
\rput[l](6.5,2){ \psframebox*{set $B_a$, for every $a \in A$} }
\rput[l](6.5,1.5){ \psframebox*{element b(a) of the set $B_a$, for every $a \in A$} }

\ncarc[nodesep=2pt,arcangle=20]{->}{FAMBASEl}{Ll}
\ncarc[nodesep=2pt,arcangle=20]{->}{FAMBASEm}{Mm}
\ncarc[nodesep=2pt,arcangle=-20]{->}{FAMBASEr}{Rr}
\end{pspicture}
\caption{A section b of A-indexed family of sets B.}
\label{section}
\end{figure}


\noindent A second possibility, by analogy with the representation of a function as an arrow $f:B \morph A$, is to represent a dependency between one type $B$ and another $A$ by a directed edge $B \darrow A$ which then represents the functional relationship
between entities of type $B$ and the entities of type $A$ that they depend on.\\


\noindent In this case in any particular situation the types and their dependencies form a directed graph.
\\

\noindent Furthermore, any directed graph makes sense as, and can be interpreted as, a set of types and type dependencies 
providing (i) there are no cycles in
the graph and provided that (ii) all nodes B there are only finitely many A, such that $B \darrow A$ and (iii) there are 
no infinite sequences of the form $A_1 \darrow A_2 \darrow A_3 ....$. 
\\

\noindent As an example, the directed graph:
\begin{equation}
\begin{array}{ccc}
\Rnode{C}{C}   &            &                  \\ [0.8cm]
\Rnode{B1}{B_1}&            &\Rnode{B2}{B_2}   \\ [0.8cm]
               &\Rnode{A}{A}&                  \\ [0.8cm]
               &\Rnode{absolute}{1}&                
\end{array}
\ncsar{C}{B1}
\ncsar{B1}{A}
\ncsar{B2}{A} 
\ncsar{A}{absolute}
\end{equation}
\\

\noindent interpreted as types and type dependencies expresses the following:
\addtocounter{equation}{-1}
\begin{subequations}
\begin{align}
&A\mbox{ is a type} \\
&x\in A : B_1(x) \mbox{ is a type} \\
&x\in A : B_2(x) \mbox{ is a type} \\
&x\in A, y\in B_1(x): C(x,y) \mbox{ is a type}
\end{align}
\end{subequations}
\\

\noindent Similarly the directed graph:

\begin{equation}
\begin{array}{p{1.5cm}cccp{2cm}c}
&                 & \Rnode{C2}{C}      &                  \\ [0.8cm]
&                 & \Rnode{B}{B}       &                  \\ [0.8cm]
& \Rnode{A1}{A_1} &                    & \Rnode{A2}{A_2}  \\ [0.8cm]
&                 & \Rnode{absolute}{1}&  
\end{array}
\ncsar{C2}{B}
\ncsar{B}{A1}
\ncsar{B}{A2}
\ncsar{B3}{A3}
\ncsar{A1}{absolute}
\ncsar{A2}{absolute}
\end{equation}

\noindent can be interpreted as representing the following type system:


\begin{align*}
&A_1\mbox{ is a type} && \tag*{(\theequation a)}\\
&A_2\mbox{ is a type} && \tag*{(\theequation b)}\\
&x_1\in A_1, x_2 \in A_2 : B(x_1,x_2) \mbox{ is a type} && \tag*{(\theequation c)}\\
&x_1\in A_1, x_2 \in A_2, y \in B(x_1,x_2): C(x_1,x_2,y) \mbox{ is a type} && \tag*{(\theequation d)}\\
\end{align*}


\noindent
and this example can be represented in form  (\ref{contextualcategory}) within a contextual category werein the cartesian product of $A_1$ and $A_2$ can represented
as $p_{A_1}\sub A_2$
In this example type $B$ is explicitly dependent on two types ($A_1$ and $A_2$). In the approach of \cite{Cartmell78}, \cite{Cartmell86} this double dependency needs be  represented (in a contextual category) by a dependency of $B$ on a cartesian product
of $A_1$ and $A_2$. Two such cartesian products are available: $p_{A_1}\sub A_2$
and $p_{A_2}\sub A_1$. The resulting graph if the first one is chosen is shown in (\ref{contextualcategory}).

\begin{equation}
\label{contextualcategory}
\begin{array}{p{1.5cm}cccp{2cm}c}
& \Rnode{C}{C}                    &                  \\ [0.8cm]
& \Rnode{B}{B}                    &                  \\ [0.8cm]
& \Rnode{A1A2}{p_{A_1} \sub A_2}  &                  \\ [0.8cm]
& \Rnode{A1}{A_1}                 &                     & \Rnode{A2}{A_2}  \\ [0.8cm]
&                                 & \Rnode{absolute}{1} &  
\end{array}
\ncsar{C}{B}
\ncsar{B}{A1A2}
\ncsar{A1A2}{A1}
%\ncsar{B}{A2}
%\ncsar{B3}{A3}
\ncsar{A1}{absolute}
\ncsar{A2}{absolute}
\end{equation}


\noindent 
Such type dependencies as these can be represented by \textit{composition relationships} within certain styles of entity modelling (for one of these, see \href{www.entitymodelling.org}{www.entitymodelling.org}). Composition relationships may be distinguished on diagrams from other functional relationships by being drawn leaving the
lower edge of a box representing the type being depended on and entering the upper edge of the box representing the dependent type. \\

\noindent Examples are given in figures \ref{partsOfSpeech} and \ref{performance}.

\begin{center}
\begin{figure} [H]
\hspace {1.5cm}
(a)
\begin{tabular}{>{\textit} l l}
Symbol & \itshape{Introductory Rule} \\ 
\hline 
language &$\tstyle \isT{language} $\\
sentence &$x \in language \tstyle sentence(x) \mbox{ is a type} $\\
word &$x \in language \tstyle word(x) \mbox{ is a type} $\\
noun &$x \in language ,\ y \in sentence(x)  \tstyle noun(y) \mbox{ is a type} $\\
verb &$x \in language ,\ y \in sentence(x)  \tstyle verb(y) \mbox{ is a type} $\\
adjective &$x \in language ,\ y \in sentence(x)  \tstyle adjective(y) \mbox{ is a type}$
\end{tabular} 
\vspace{0.5cm}

\hspace{0.5cm}
(b)
\setlength{\arraycolsep}{0cm}
$
\begin{array}{ c c c c}
&                            &  \Rnode{1}{1}               &             \\ [1.3cm]
&                            & \Rnode{language}{language}  &             \\ [1.3cm]
& \Rnode{sentence}{sentence} &                     & \Rnode{word}{word}\\ [1.3cm]
\Rnode{noun}{noun}         & \Rnode{verb}{verb}  & \Rnode{adjective}{adjective} &
\end{array}
$
\hspace {1.0cm}
(c)
\erinlinePicture{partsOfSpeech}{4}
\ncsar{language}{1}
\ncsar{sentence}{language}
\ncsar{word}{language}
\ncsar{noun}{sentence}
\ncsar{verb}{sentence}
\ncsar{adjective}{sentence}
\caption{Three representations of a system of types (a) rules in a formal mathematical syntax,
(b) a graph of  type dependencies (c) an entity modelling diagram.}
\label{partsOfSpeech}
\end{figure}
\end{center}

\begin{center}
\begin{figure} [H]
\begin{center}
\erinlinePicture{latex/performanceOfPlayCompositional}{3.5}
\end{center}
\caption{A player plays the part of a character in the same play that they are performing in. }
\label{performance}
\end{figure}
\end{center}


Consider the following two rules:
\begin{subequations}
\begin{align} 
           & x_1 \in A, y_1 \in B_1(x_1), x_2 \in A, y_2 \in B_2(x_2) : C(x_1,y_1,x_2,y_2) \mbox{ is a type}\label{multipleInstanceA}\\
\mbox{and}& \notag \\
           & x \in A, y_1 \in B_1(x), y_2 \in B_2(x) : C(x,y_1,y_2) \mbox{ is a type} \label{singleInstanceA}
\end{align}
\end{subequations}

\noindent They both give rise to a graph shaped like this:

\begin{equation}
\begin{array}{ccc}
               &\Rnode{C}{C}   &             \\ [0.8cm]
\Rnode{B1}{B_1}&            &\Rnode{B2}{B_2}  \\ [0.8cm]
               &\Rnode{A}{A}&                 \\
\end{array}
\ncsar{C}{B1}
\ncsar{C}{B2}
\ncsar{B1}{A}
\ncsar{B2}{A} 
\end{equation}
\\

\noindent In the case of \eqref{singleInstanceA}, $C$ relies for context on instances of $B_1$ and $B_2$ which themselves are based within the context of a common instance of $A$.
\noindent In the case of \eqref{singleInstanceA}, but not, significantly, 
in the case \eqref{multipleInstanceA}, the path:
$ C \darrow B_1 \darrow A$ is equivalent to the path: $ C \darrow B_2 \darrow A$
and the diagram commutes. So dependencies compose in different ways and so
represent the types dependencies (the variables over which types vary); therefore it is the category of dependencies (not just the directed graph) which is significant to characterising the type dependency relationships.
\noindent  
Note that the model in figure \ref{performance} 
follows the pattern of (\ref{singleInstanceA}) rather than (\ref{multipleInstanceA}) which is to say that the diagram of relationships in figure \ref{performance} commutes.

\vspace{0.25cm}
\noindent We now proceed to give a series of definitions which
lead eventually to the definition of  \textit{dependency category}.
Dependency categories contain all the structure needed to represent dependent types in the 
sense that these are in the syntax of generalised algebraic theories (\cite{Cartmell86}) provided we restrict
ourselves to theories having the cancellation property.
As such the category of dependency categories is equivalent to the category of cancellative contextual categories.
\section {Acyclic Categories}
A category C is called \textit{acyclic}, if it has no inverses and no nonidentity
endomorphisms. This definition is given by Kozlov (see \cite{Kozlov2007}) who offers the following intuition:
\begin{erquote}
Another way to visualize acyclic categories is to think of them as those
that can be drawn on a sheet of paper, with dots indicating the objects, and
straight or slightly bent arrows, all pointing down, indicating the nonidentity
morphisms...
\end{erquote}

\noindent
Previous authors had referred to such categories as being \textit{loop-free}. \\

\noindent
The following is an example of an acyclic category given by Kolozov which we have rearranged and relabelled:

\begin{center}
\begin{equation}
\begin{array}{p{1.5cm}cccp{2cm}c}
&                & \Rnode{C}{C}&   \\ [1.4cm]
&                & \Rnode{B}{B} &  \\ [0.8cm]
&                & \Rnode{A}{A} &  
\end{array}
\end{equation}
\ncasar[-30]{y_1}{C}{B}
\ncasar[30]{y_2}{C}{B}
\ncasar{x}{B}{A}
\setlength {\saroffsetA}{-2pt}
\setlength {\saroffsetB}{-2pt}
\ncbsar[-50]{y_1 \circ x = y_2 \circ x}{C}{A}
\sarreset
\end{center}


\noindent This category can be taken as representing the following type system:
\addtocounter{equation}{-1}
\begin{align}
&A\mbox{ is a type} && \tag*{(\theequation a)}\\
&x\in A: B(x) \mbox{ is a type} && \tag*{(\theequation b)}\\
&x\in A_1, y_1 \in B(x), y_2 \in B(x) : C(x,y_1,y_2) \mbox{ is a type} && \tag*{(\theequation c)}
\end{align}

\noindent
Contrast with this acyclic category:
\begin{center}
\begin{equation}
\begin{array}{p{1.5cm}cccp{2cm}c}
&                & \Rnode{C}{C}&   \\ [1.4cm]
&                & \Rnode{B}{B} &  \\ [0.8cm]
&                & \Rnode{A}{A} &  
\end{array}
\end{equation}
\ncasar[-30]{y_1}{C}{B}
\ncasar[30]{y_2}{C}{B}
\ncasar{x}{B}{A}
\setlength {\saroffsetA}{-2pt}
\setlength {\saroffsetB}{-2pt}
\ncbsar[-60]{x_1 = y_1 \circ x}{C}{A}
\setlength {\saroffsetA}{2pt}
\setlength {\saroffsetB}{2pt}
\ncasar[60]{x_2 = y_2 \circ x}{C}{A}
\sarreset
\end{center}
\noindent
which represents :
\addtocounter{equation}{-1}
\begin{align}
&A\mbox{ is a type} && \tag*{(\theequation a)}\\
&x\in A: B(x) \mbox{ is a type} && \tag*{(\theequation b)}\\
&x_1\in A_1, y_1 \in B(x_1), x_2\in A_1, y_2 \in B(x_2) : C(x_1,x_2,y_1,y_2) \mbox{ is a type} && \tag*{(\theequation c)}
\end{align}

\section{Category with Distinguished Morphisms}

\begin{definition}
\noindent A category $\cat{C}$ is \textit{well-founded} provided that for 
any object $A$ of $C$ the set of morphisms with domain $A$ is finite. 
\end{definition}
\begin{definition}
Define a \textit{category with distinguished morphisms} to be a category \cat{C} along with a wide acyclic subcategory \cat{D} that is well-founded. 
Morphisms of the subcategory are referred to as d-morphism. 
We will write $f:B \dmorph A$ in \cat{C}
to mean that 
$f: B \morph A$ in \cat{C} and that $f$ is a d-morphism i.e is in the subcategory \cat{D} of distinguished morphisms\footnote{
Note that this the same notation has been used differently in \cite{Cartmell86} -- a contextual category does give rise to a category with distinguished morphisms but only
if the distinguished morphisms are taken to be not just those
denoted $p_B: B \dmorph A$ in that paper
but also all those in  the subcategory generated by such.
}. 
\end{definition} 

\section{Spans and Cospans}
\noindent
The category $\Lambda$ is defined to be this category:
\begin{center}
\begin{displaymath}
\begin{array}{cp{0.1cm}cp{0.1cm} c}
            & &\Rnode{d}{\bullet}                  \\ [0.4cm]
\Rnode{c1}{\bullet}& &                & & \Rnode{c2}{\bullet} 
\end{array}
\end{displaymath}
\ncarr{d}{c1}
\ncarr{d}{c2}
\end{center}

\noindent
If we need names for the individual objects and morphisms we will use the names show here:
\begin{center}
\begin{displaymath}
\begin{array}{cp{0.1cm}cp{0.1cm} c}
            & &\Rnode{d}{\Delta}                  \\ [0.4cm]
\Rnode{c1}{\Gamma_1}& &                & & \Rnode{c2}{\Gamma_2} 
\end{array}
\end{displaymath}
\jcbarr{\xi}{d}{c1}
\ncaarr{\gamma}{d}{c2}
\end{center}

\noindent
A \textit{span} within a category \cat{C} is exactly a functor 
$S: \Lambda \morph \cat{C}$; it is a pair of morphisms of \cat{C} that have a common domain object i.e it is any diagram of this form:

\begin{center}
\begin{equation}
\label{genericspan}
\begin{array}{cp{0.1cm}cp{0.1cm} c}
            & &\Rnode{d}{D}                  \\ [0.4cm]
\Rnode{c1}{C_1}& &                & & \Rnode{c2}{C_2} 
\end{array}
\end{equation}
\jcbarr{f}{d}{c1}
\ncaarr{g}{d}{c2}
\end{center}

\noindent Similarly a \textit{cospan} in a category \cat{C} is exactly a functor $S: \Lambda^{op} \morph \cat{C}$ and so it is exactly a diagram of this form:
\begin{center}
\begin{equation}
\label{genericcospan}
\begin{array}{cp{0.1cm}cp{0.1cm} c}
\Rnode{c1}{C_1}& &                & & \Rnode{c2}{C_2} \\ [0.4cm]
            & &\Rnode{b}{B}
\end{array}
\end{equation}
\jcbarr{x_1}{c1}{b}
\ncaarr{x_2}{c2}{b}
\end{center}

\noindent
The cospan (\ref{genericcospan}) of $C_1$ and $C_2$ is said to be a 
\textit{coincident cospan} of the span (\ref{genericspan}) iff the 
diagram:
\begin{center}
\begin{equation}
\begin{array}{cp{0.1cm}cp{0.1cm} c}
            & &\Rnode{d}{D}                           \\ [0.4cm]
\Rnode{c1}{C_1}& &                & & \Rnode{c2}{C_2} \\ [0.4cm]
            & &\Rnode{b}{B}
\end{array}
\end{equation}
\jcbarr{f}{d}{c1}
\ncaarr{g}{d}{c2}
\jcbarr{x_1}{c1}{b}
\ncaarr{x_2}{c2}{b}
\end{center}

\noindent commutes. \\

\noindent We will say that the cospan (\ref{genericcospan}) is a 
\textit{minimal coincident cospan} for the span (\ref{genericspan}) iff it is 
coincident  and there does no exist a cospan 
\begin{center}
\begin{equation}
\begin{array}{cp{0.1cm}cp{0.1cm} c}
\Rnode{c1}{C_1}& &                & & \Rnode{c2}{C_2} \\ [0.4cm]
            & &\Rnode{b}{B'}
\end{array}
\end{equation}
\jcbarr{x'_1}{c1}{b}
\ncaarr{x'_2}{c2}{b}
\end{center}

\noindent
that is coincident to (\ref{genericspan}) and such that there is a morphism 
$h: B' \morph B$ such that both \\
\vspace {0.25cm}

$
\begin{array}{cc}
\Rnode{C1}{C_1}                             \\ [0.7cm]
               & \Rnode{Bp}{B'}             \\ [0.8cm]
							 &  \Rnode{B}{B} 
\end{array}
$
\jcbarr[-30]{x_1}{C1}{B}
\ncaarr{h}{Bp}{B}
\ncaarr{x'_1}{C1}{Bp}
and
$
\begin{array}{p{1.5cm}cc}
&                &\Rnode{C2}{C_2}     \\ [0.7cm]
&\Rnode{Bp}{B'}                       \\ [0.8cm]
&\Rnode{B}{B}
\end{array}
$
\ncaarr[30]{x_2}{C2}{B}
\jcbarr{h}{Bp}{B}
\jcbarr{x'_2}{C2}{Bp}
commute. \\
\noindent
A cospan $F:\Lambda^{op} \morph \cat{C}$ is said to \textit{factor through}  a diagram 
$J:S \morph \cat{C}$ iff there exists a cospan $F': \Lambda^{op} \morph S$ 
such that $F' \circ J = F$. Intuitively, then, a cospan factors through a diagram iff it is a 
part of the diagram.
  
\section{Higher Cospans and Quotiented Higher Cospans}
The notion of a \textit{higher cospan} was
 introduced in \cite{Grandis2007} for diagrams
in a category of shape $\Lambda^{op^n}$but for us there are significant diagrams whose 
shape category is a quotient of  ${\Lambda^{op}}^n$ and since we are not aware
of further terminology in this area we introduce some here. It is appropriate to make use the join symbol ($\Join$) from relational algebra. \\

\noindent For any $n \geq 2$ define the category \ndidly to be this category:

\begin{center}
\begin{displaymath}
\begin{array}{cp{0.3cm}c         p{0.3cm}  c p{0.2cm} c}
\Rnode{d1}{\Delta_1}& &               & &     & &\Rnode{d2}{\Delta_2}  \\ [1.2cm]
\Rnode{c1}{\Gamma_1}& &\Rnode{c2}{\Gamma_2}& & ... & &\Rnode{cn}{\Gamma_n}
\end{array}
\end{displaymath}
\ncarr{d1}{c1}
\nbput[npos=0.4, labelsep=1pt]{\footnotesize $\xi_1$}
\ncarr{d1}{c2}
\nbput[npos=0.3, labelsep=1pt]{\footnotesize $\xi_2$}
\ncarr{d1}{cn}
\naput[npos=0.3, labelsep=1pt]{\footnotesize $\xi_n$}
\ncarr{d2}{c1}
\nbput[npos=0.3, labelsep=1pt]{\footnotesize $\gamma_1$}
\ncarr{d2}{c2}
\naput[npos=0.25, labelsep=1pt]{\footnotesize $\gamma_2$}
\ncarr{d2}{cn}
\naput[npos=0.4, labelsep=1pt]{\footnotesize $\gamma_n$}
\end{center}

\begin{definition}
A \textit{\ndidlycospan}
 in category \cat{C}  is any diagram in \cat{C} having 
shape $\ndidly$  i.e. it is any functor $F: \ndidly \morph \cat{C}$
\end{definition}

\section{ Some Other Preliminary Definitions\protect\footnote{Please regard the terminology introduced here as provisional -- the author would be glad to receive suggested improvements especially where he has failed to use prior established terminology.}}

\begin{definition}
\noindent If \cat{C} is a category  then a \textit{characterising family} for a span $s$ of \cat{C} is defined to be the set of its minimal coincident cospans.
\end{definition}


\noindent 

\begin{definition}
If \cat{C} is a category with distinguished morphisms 
and if $\tuple{f_1,...f_n}$ is a tuple of d-morphisms of \cat{C} 
with common domain then define the \textit{characterising diagram} of 
$\tuple{f_1,...f_n}$
to be the diagram with shape category \ndidly where 
$$n = 
\sum_{\substack{i,\\1 \leq i \leq n}} \  \sum_{\substack{j,\\ 1 \leq j \leq n,\\ j \neq i}} \ | \chi_{i,j} | $$
and where $\chi_{i,j}$ is the characterising family within the subcategory 
of d-morphisms of \cat{C} for the pair $f_i,f_j$ and 
$|\chi_{i,j}|$ is its cardinality,
and with functor $D: S \morph \cat{C}$ defined for $1 \leq i \leq n$, $1 \leq j \leq n$, $i \neq j$, $1 \leq k \leq | \chi_{i,j}$ by
$$ \xi_{i,j,k}   \mapsto F_{i,j,k}(\xi)$$
and
$$ \gamma_{i,j,k}   \mapsto F_{i,j,k}(\gamma) $$
where $F_{i,j,k}$ is the $k$'th cospan within the characteristic family of the pair $f_i,f_j$.
\end{definition}

\begin{definition}
If \cat{C} is a category with distinguished morphisms then a family of 
d-morphisms  $f_i: B \dmorph A_i$ is said to
be a basis for object B iff for every morphism $f: B \dmorph X$ in \cat{C} either 
\begin{enumerate}[(i)]
\item
$f$ factors through one of $f_i$ for some $i$ i.e there exists $g:A_i \morph X$, for some $i$, such that $f_i \circ g = f$ or
\item
there exists $1 \leq k_1 \leq k_2 ... k_m \leq n$, and d-morphisms 
$g_1,...,g_m$ such that for each $j$, $1 \leq j \leq m$, 
$g_j: X \dmorph A_{k_j}$ and

\begin{center}
\psset{arrowsize=5pt,arrowinset=0.7}
\psset{nodesep=7pt}
\setlength{\arraycolsep}{0.3cm}
\begin{displaymath}
\begin{array}{cp{0.5cm}c}
&&\Rnode{B}{B}\\ [1.5cm]
&&\Rnode{X}{X}\\ [1.5cm]
\Rnode{Akj}{A_{k_j}}&&\\
\end{array}
\end{displaymath}
\setlength{\sarnodesepB}{4pt}
\ncasar{f}{B}{X}
\ncbsar{f_{k_j}}{B}{Akj}
\psset{nodesepA=4pt,nodesepB=9pt}
\ncline{-}{X}{Akj}
\trput{\footnotesize $g_j$}
\ncput[nrot=:R,npos=1]{\pstriangle(0,0)(.2,.2)}
\end{center}
commutes and such that the diagram

\begin{center}
\psset{arrowsize=5pt,arrowinset=0.7}
\psset{nodesep=7pt}
\setlength{\arraycolsep}{0.3cm}
\begin{displaymath}
\begin{array}{ccp{0.2cm}p{0.075cm}c}
&&\Rnode{top}{$X$}& & \\[1.5cm]
\Rnode{A}{A_{k_1}}&\Rnode{B2}{A_{k_2}}&& ... & \Rnode{Bm}{A_{k_m}}\\
\end{array}
\end{displaymath}
\psset{nodesepA=4pt,nodesepB=7pt}
\ncline{-}{top}{A}
\tlput{\footnotesize $g_1$}
\ncput[nrot=:R,npos=1]{\pstriangle(0,0)(.2,.2)}
\ncline{-}{top}{B2}
\trput{\footnotesize $g_2$}
\ncput[nrot=:R,npos=1]{\pstriangle(0,0)(.2,.2)}
\ncline{-}{top}{Bm}
\trput{\footnotesize $g_m$}
\ncput[nrot=:R,npos=1]{\pstriangle(0,0)(.2,.2)}
\end{center}

is a limit cone\footnote{I want to say cannonical limit here but I can't.
Monitor this situation to see whether a problem or not. I think it is a minor annoyance. The question is whether if X dependent on Y and Y' isomorphic to Y then X is dependent on Y'. This in turn has an effect on the round trip from presentation to category back to presentation. } in category \cat{C} for the characteristic diagram of $g_1,...g_m$.
\end{enumerate}

\end{definition}

\section{Cones and Tight Cones}
Recall the definition of cone $\tuple{ N,\psi}$ to a diagram $F:J \morph C$ of a category $C$ as an object $N$ of $C$ and a family of morphisms $\psi_j$ indexed by objects $j$ of $J$ such that for all $f: j \morph j'$ in $J$, ($\psi_j \circ F(f) = \psi_{j'}$) the diagram 
\begin{center}
\begin{equation}
\begin{array}{cp{0cm}cp{0cm}c}
                  &&\Rnode{d}{N}  &&                   \\ [0.4cm]
\Rnode{c1}{F(j_1)}&&              && \Rnode{c2}{F(j_2)} 
\end{array}
\end{equation}
\jcbarr{\psi_{j}}{d}{c1}
\ncaarr{\psi_{j'}}{d}{c2}
\jcbarr{F(f)}{c1}{c2}
\end{center}
commutes.

We shall define a cone $\tuple{ N,\psi}$to be \textit{tight}\footnote{My terminology as I don't know standard terminology for this property.} iff for all pairs $j_1,j_2$ of objects of shape category $J$, every minimal coincident cospan of the span:

\begin{center}
\begin{equation}
\begin{array}{cp{0cm}cp{0cm} c}
            & &\Rnode{d}{N}                           \\ [0.7cm]
\Rnode{c1}{F(j_1)}& &                & & \Rnode{c2}{F(j_2)} 
\end{array}
\end{equation}
\jcbarr{\psi_{j_1}}{d}{c1}
\ncaarr{\psi_{j_2}}{d}{c2}
\end{center}

factors through the diagram $F$ i.e. every minimal coincident cospan is of the form:
\begin{center}
\begin{equation}
\begin{array}{cp{0cm}cp{0cm} c}                        
\Rnode{c1}{F(j_1)}& &                & & \Rnode{c2}{F(j_2)} \\ [1.0cm]
            & &\Rnode{d}{F(j)}  
\end{array}
\end{equation}
\jcbarr{F(f_1)}{c1}{d}
\ncaarr{F(f_2)}{c2}{d}
\end{center}

for some object $j$ of $J$ and for some morphisms 
$f_1:j_1 \morph j$, 
$f_2:j_2 \morph j$ in $J$. 

\section{Definition of Dependency Category}
A \textit{dependency category} is a category \cat{C} with distinguished morphisms and a terminal object $1$ and :

\begin{enumerate} [(i)]
	\item for any object A of \cat{C} the unique morphism $t_A:A \morph 1$ is a d-morphism
	
	
	\item for all diagrams D of d-morphisms \begin{center}
$
\begin{array}{cp{0cm}cp{0cm}c}
\Rnode{B1}{B}& &            &  &\Rnode{B2}{B'} \\ [1.2cm]
               & &\Rnode{A}{A}& &
\end{array}
$
\ncbsar{x}{B1}{A}
\ncasar{x'}{B2}{A}
\end{center}
	
an object  $ \fibrex{B_1}{B_2}{D}$ of \cat{C} and d-morphisms 
$p_1: \fibrex{B_1}{B_2}{D} \dmorph B_1$ and  $p_1: \fibrex{B_1}{B_2}{D} \dmorph B_1$ such that :

\begin{center}
\begin{displaymath}
\begin{array}{cp{0.1cm}cp{0.1cm} c}
            & &\Rnode{d}{\fibrex{B_1}{B_2}{D}}                  \\ [0.4cm]
\Rnode{c1}{B_1}& &                & & \Rnode{c2}{B_2} 
\end{array}
\end{displaymath}
\ncbsar{p_1}{d}{c1}
\ncasar{p_2}{d}{c2}
\end{center}

is a pullback in category \cat{C} and such that for any 
cone $\tuple{N,\psi}$ to diagram $D$
the mediating morphism $h: N \morph B_1 \underset{D}{\Join} B_2$ is a d-moprphism iff 
every morphism in the cone \ $\tuple{N,\psi}$ is a d-morphism and the cone is tight.

	\item Other pullbacks: if
\begin{center}
\begin{displaymath}
\begin{array}{cp{.9cm}c}
            & & \Rnode{X}{X} \\ [1.2cm]
\Rnode{A}{A}& & \Rnode{B}{B} \\
\end{array}
\end{displaymath}
\jcbarr{f}{A}{B}
\ncasar{y}{X}{B}
\end{center}

then there is a pullback 
\vspace{3mm}
\begin{center}
\begin{displaymath}
\begin{array}{cp{.9cm}c}
\Rnode{fstarX}{X[f|y]} & & \Rnode{X}{X}\\ [1.2cm]
\Rnode{A}{A}         & & \Rnode{B}{B}
\end{array}
\end{displaymath}
\ncbsar{f^*y}{fstarX}{A}
\jcbarr{f}{A}{B}
\ncaarr{q(f,y)}{fstarX}{X}
\ncasar{y}{X}{B}
\end{center}
and pullbacks cohere\footnote{exactly as for contextual category}
and if also:
\begin{center}
$
\begin{array}{cp{.9cm}c}
            & & \Rnode{X}{X} \\ [1.2cm]
& & \Rnode{Bprime}{B'} \\
\end{array}
$
\ncasar{$y'$}{X}{Bprime}
\end{center}
and $y \neq y'$ then $q(f,y) \circ y'$ is a d-morphism. 
\noindent Further, if
\begin{center}
$
\begin{array}{p{2cm}p{0.5cm}p{0.5cm}p{0.5cm}}
& & \Rnode{X}{X}& \\ [1.4cm]
\Rnode{A}{A} & \Rnode{B1}{$B_1$} & ... & \Rnode{Bm}{$B_m$}\\
\end{array}
$
\jcbarr{f}{A}{B1}
\ncbsar{y_1}{X}{B1}
\ncasar{y_m}{X}{Bm}
\end{center}
and $y_1,...y_m$ is a basis for $X$ 
\noindent then the set:
\vspace{2mm}
\begin{center}
\psset{arrowsize=5pt,arrowinset=0.7}
\psset{nodesep=7pt}
\setlength{\arraycolsep}{0.3cm}
\begin{displaymath}
\begin{array}{ccp{0.2cm}p{0.075cm}c}
&&\Rnode{top}{$X[f|y_1]$}& & \\[1.5cm]
\Rnode{A}{A}&\Rnode{B2}{B_2}&& ... & \Rnode{Bm}{B_m}\\
\end{array}
\end{displaymath}
\psset{nodesepA=4pt,nodesepB=7pt}
\ncline{-}{top}{A}
\tlput{\footnotesize $f^*y_1$}
\ncput[nrot=:R,npos=1]{\pstriangle(0,0)(.2,.2)}
\ncline{-}{top}{B2}
\trput{\footnotesize $f_*y_2$}
\ncput[nrot=:R,npos=1]{\pstriangle(0,0)(.2,.2)}
\ncline{-}{top}{Bm}
\trput{\footnotesize $f_*y_m$}
\ncput[nrot=:R,npos=1]{\pstriangle(0,0)(.2,.2)}
\end{center}
is a basis for  $f^*X$.


\item If in (iii) the morphism f is a dependency then  $q(f,y)$ is also a dependency and 

\noindent for any diagram D:
\begin{center}
$
\begin{array}{cp{0cm}cp{0cm}c}
\Rnode{B1}{B_1}& &            &  &\Rnode{B2}{B_2} \\ [1.2cm]
               & &\Rnode{A}{A}& &
\end{array}
$
\ncbsar{x_1}{B1}{A}
\ncasar{x_2}{B2}{A}
\end{center}

\noindent then
$B_2[x_1|x_2]=B_1[x_2|x_1] = \fibrex{B_1}{B_2}{D}$ and $q(x_1,x_2)= x_2\sub x_1 $ and $q(x_2,x_1)= x_1 \sub x_2$
\noindent
so that we have:

\begin{center}
$
\begin{array}{cp{0cm}cp{0cm}c}
               && \Rnode{X}{\fibrex{x_1}{x_2}{D}}&&                \\ [1.2cm]
\Rnode{B1}{B_1}&&                                && \Rnode{B2}{B_2} \\ [1.2cm]
               &&\Rnode{A}{A}                    && 
\end{array}
$
\ncbsar{x_1}{B1}{A}
\ncasar{x_2}{B2}{A}
\ncbsar{q(x_2,x_1)=x_1*x_2=p_1}{X}{B1}
\ncasar{q(x_1,x_2)=x_2*x_1=p_2}{X}{B2}
\end{center}






\item Equalisers and properties of equalisers: If
\setlength{\arraycolsep}{1cm}
\psset{arrowsize=5pt,arrowinset=0.7}
\psset{nodesep=7pt}
$
\begin{array}{c}
\Rnode{B}{B} \\ [1.1cm]
\Rnode{A}{A} \\
\end{array}
$
\psset{nodesepA=4pt,nodesepB=7pt}
\ncarc[arcangle=-30]{-}{B}{A}
\nbput{\footnotesize $x_1$}
\ncput[nrot=:R,npos=1]{\pstriangle(0,0)(.2,.2)}
\ncarc[arcangle=30]{-}{B}{A}
\naput{\footnotesize $x_2$}
\ncput[nrot=:R,npos=1]{\pstriangle(0,0)(.2,.2)}

then there is an equaliser: \\
\
\setlength{\arraycolsep}{.75cm}
$$
\begin{array}{ccc}
\Rnode{Eq}{\underset{x_1=x_2}{\sigma}B} & \Rnode{B}{B}  & \Rnode{A}{A} \\
\end{array}
$$
\psset{nodesepA=4pt,nodesepB=7pt}
\ncline[offset=4pt]{-}{B}{A}
\naput{\footnotesize $x_1$}
\ncput[nrot=:R,npos=1]{\pstriangle(0,0)(.2,.2)}
\ncline [offset=-4pt]{-}{B}{A}
\nbput{\footnotesize $x_2$}
\ncput[nrot=:R,npos=1]{\pstriangle(0,0)(.2,.2)}
\ncline{->}{Eq}{B}
\naput{\footnotesize $e$}
\noindent and the morphism $e \circ x_1$ which equals, by definition, $e \circ a_2$,  is a d-morphism as shown
in the following diagram:
\vspace{.2cm}
\begin{center}
\setlength{\arraycolsep}{.3cm}
$
\begin{array}{ccc}
\Rnode{Eq}{\underset{x_1=x_2}{\sigma}B} & &\Rnode{B}{B} \\[1.4cm]
 & \Rnode{A}{A} &\\
\end{array}
$
\psset{nodesepA=3pt,nodesepB=9pt}
\ncarc[arcangle=-15]{-}{B}{A}
\nbput{\footnotesize $x_1$}
\ncput[nrot=:R,npos=1]{\pstriangle(0,0)(.2,.2)}
\psset{nodesepA=4pt,nodesepB=7pt}
\ncarc[arcangle=15]{-}{B}{A}
\naput{\footnotesize $x_2$}
\ncput[nrot=:R,npos=1]{\pstriangle(0,0)(.2,.2)}
\ncline{->}{Eq}{B}
\naput{\footnotesize $e$}
\ncarc[arcangle=-5]{-}{Eq}{A}
\nbput{\footnotesize $e \circ x_1 = e \circ x_2$}
\ncput[nrot=:R,npos=1]{\pstriangle(0,0)(.2,.2)}
\end{center}

\noindent For any other d-morphism $a':B\darrow A'$ leaving B, the morphism $e \circ a'$ is a d-morphism; furthermore, if
\begin{center}
\setlength{\arraycolsep}{.1cm}
$
\begin{array}{ccp{.3cm}c}
                  & \multicolumn{2}{c}{\Rnode{B}{B}}& \\ [1.4cm]
\Rnode{A1}{A_1} &\Rnode{A2}{A_2}& ... & \Rnode{Am}{A_m}\\
\end{array}
$
\psset{labelsep=1pt,npos=0.6}
\ncbsar{x_1}{B}{A1}
\ncasar{x_2}{B}{A2}
\ncasar{x_m}{B}{Am}
\end{center}
and $x_1,...x_m$ is a basis for B 
then

\begin{center}
\setlength{\arraycolsep}{.1cm}
$
\begin{array}{cp{.35cm}cp{.4cm}c}
                  & \multicolumn{3}{c}{\Rnode{diamondB}{\underset{x_1=x_2}{\sigma}B}}& \\ [1.4cm]
\Rnode{A1}{A_1} & &\Rnode{A3}{A_3} &... & \Rnode{Am}{A_m}\\
\end{array}
$
\psset{labelsep=1pt,npos=0.6}
\ncbsar{e \circ a_1 = e \circ x_2}{diamondB}{A1}
\psset{labelsep=1pt,npos=0.8}
\ncasar{e \circ x_3}{diamondB}{A3}
\ncasar{e \circ x_m}{diamondB}{Am}
\end{center}
\setlength{\arraycolsep}{0.1cm}
\noindent is a basis for $\underset{x_1=x_2}{\sigma}B$. 

\noindent For any object $C$ and morphism $y: C \morph B$ such that
$y \circ x_1 = y \circ x_2$
the mediating morphism $h: C \morph \underset{x_1=x_2}{\sigma}B$ is a d-morphism iff 
the morphism $y$ is a d-morphism and the cone $\tuple{C,y}$ is tight i.e iff there does not exist an object $A'$ distinct from 
$A$ and morphisms $x'_1: B \dmorph A'$, $x'_2: B \dmorph A'$ and $x:A' \dmorph A$ such that each of the three diagrams contained here:

\begin{center}
$
\begin{array}{cp{0.5cm}cp{0.5cm}c}
               && \Rnode{X}{C}&&                  \\ [0.6cm]
\Rnode{B1}{B}&&                  && \Rnode{B2}{B} \\ [0.6cm]
               &&\Rnode{Ap}{A'}  &&               \\ [1cm]
               &&\Rnode{A}{A}    && 
\end{array}
$
\ncbsar{y}{X}{B1}
\ncasar{y}{X}{B2}
\ncbsar{x'_1}{B1}{Ap}
\ncasar{x'_2}{B2}{Ap}
\ncasar{x}{Ap}{A}
\ncbsar[-30]{x_1}{B1}{A}
\ncasar[30]{x_2}{B2}{A}
\end{center}

\noindent commute. \\


\noindent This completes the definition.

\end{enumerate}

\section{Construction of Limits of Other Dependency Diagrams}

\begin{lemma}
For all diagrams D of d-morphisms with shape \ndidly:
	
\begin{center}
\begin{displaymath}
\begin{array}{cp{0.3cm}c         p{0.3cm}  c p{0.2cm} c}
\Rnode{d1}{B}& &               & &     & &\Rnode{d2}{B'}  \\ [1.4cm]
\Rnode{c1}{A_1}& &\Rnode{c2}{A_2}& & ... & &\Rnode{cn}{A_n}
\end{array}
\end{displaymath}
\ncsar{d1}{c1}
\nbput[npos=0.4, labelsep=1pt]{\footnotesize $x_1$}
\ncsar{d1}{c2}
\nbput[npos=0.3, labelsep=1pt]{\footnotesize $x_2$}
\ncsar{d1}{cn}
\naput[npos=0.3, labelsep=1pt]{\footnotesize $x_n$}
\ncsar{d2}{c1}
\nbput[npos=0.3, labelsep=1pt]{\footnotesize $x'_1$}
\ncsar{d2}{c2}
\naput[npos=0.25, labelsep=1pt]{\footnotesize $x'_2$}
\ncsar{d2}{cn}
\naput[npos=0.4, labelsep=1pt]{\footnotesize $x'_n$}
\end{center}

there is an object  $ \fibrex{B_1}{B_2}{D}$ of \cat{C} and d-morphisms 
$p_1: \fibrex{B_1}{B_2}{D} \dmorph B_1$ and  $p_1: \fibrex{B_1}{B_2}{D} \dmorph B_1$ such that :

\begin{center}
\begin{displaymath}
\begin{array}{cp{0cm}cp{0cm} c}
            & &\Rnode{d}{\fibrex{B_1}{B_2}{D}}                  \\ [0.6cm]
\Rnode{c1}{B_1}& &                & & \Rnode{c2}{B_2} 
\end{array}
\end{displaymath}
\ncbsar{p_1}{d}{c1}
\ncasar{p_2}{d}{c2}
\end{center}

is a limit of diagram $D$ in category \cat{C} and such that for any cone $\tuple{N,\psi}$ to diagram $D$
the mediating morphism $h: N \morph B_1 \underset{D}{\Join} B_2$ is a d-morphism iff 
each morphism in the cone $\tuple{N,\psi}$ is a d-morphism and the 
cone is tight. 

\end{lemma}
\begin{proof}
\noindent This lemma can be proved by induction using the next lemma.
\end{proof}
\begin{lemma}
In any category \cat{C} if $F: S \morph \cat{C}$ is a diagram with limit $\tuple{L,\phi}$,
if $S'$ is a category extending $S$ by an object $\beta_0$ and a pair of morphisms $\xi_1: \beta_1 \morph \beta_0$ and $\xi_2: \beta_2 \morph \beta_0$, where $\beta_1$ and $\beta_2$ are objects of $S$, if $G: S \morph \cat{C}$ is a diagram that extends $F$, then if :
\begin{center}
\begin{equation}
\label{equaliser}
\begin{array}{cp{1cm}cp{1cm} c}
\Rnode{E}{E}& &    \Rnode{L}{L}  & & \Rnode{A}{\beta_0} 
\end{array}
\end{equation}
\ncaarr{e}{E}{L}
\setlength{\arroffsetA}{3pt}
\setlength{\arroffsetB}{3pt}
\ncarr{L}{A}
\naput{$\phi_B \circ G(\xi_1)$}
\setlength{\arroffsetA}{-3pt}
\setlength{\arroffsetB}{-3pt}
\ncarr{L}{A}
\nbput{$\phi_{B'} \circ G(\xi_2)$}
\arreset
\end{center}
is an equaliser in \cat{C} then $\tuple{E,\phi'}$ is a limit of the diagram $G$, where
$\phi'$ is the cone defined by
\begin{equation*}
\phi'_\beta =
\left\{
	\begin{array}{ll}
		e \circ \phi_\beta           & \mbox{if } \beta \mbox{ is an object of } S  \\
		\phi_{\beta_1} \circ G(\xi_1) & \mbox{if } \beta \mbox{ is } \beta_0 
	\end{array}
\right.
\end{equation*}

\end{lemma}
\begin{proof}
If $\tuple{N,\psi'}$is a cone to the diagram $G$ then, the restriction $\psi$ to objects in $F$ is a cone to  $S$. Therefore there exists a unique $h : N \morph L$ such that 
\begin{equation}
\label{hmediates}
h \circ \phi = \psi
\end{equation}

\noindent
Now, we have 
\begin{align*}
h \circ \phi_{\beta_1} \circ G(x)
             & = \psi_{\beta_1} \circ G(\xi_1)         && \mbox{by (\ref{hmediates})}\\
             & = \psi_{\beta_2} \circ G(\xi_2)         && \mbox{because } \psi \mbox{ is a cone to } G \\
             & = h \circ \phi_{\beta_2} \circ G(\xi_2) && \mbox{by (\ref{hmediates}) }\\
\end{align*}

\noindent
and so it follows, since (\ref{equaliser}) is an equaliser diagram,
that there is a unique $g: N \morph E$ such that 
\begin{equation}
\label{gmediates}
g \circ e = h
\end{equation}

\noindent
To show that $\tuple{E,\phi'}$ is a limit to the diagram G we show that 
$g \circ \phi' = \psi'$ and that $g$ is the unique such morphism,
$g: N \morph E$.
\noindent
We need show that for all objects $\beta$ of $S'$,  $(g \circ \phi')_\beta =\psi'_\beta$. 
We need consider two cases. In the first case for objects $\beta$ of $S$ we have:
\begin{align*}
g \circ \phi'_\beta
             & = (g \circ e) \circ \phi_\beta   &&  \mbox{ by definition of } \phi\\
             & = h \circ \phi_\beta             && \mbox{ by (\ref{gmediates})}   \\
             & = \psi_\beta                     && \mbox{ by (\ref{hmediates})}   \\
						 & = \psi'_\beta                    && \mbox{ by definition of } \psi\\
\end{align*}

\noindent
In the second case the object $\beta$ is the additional object $\beta_0$ of $S'$. For this object we have:
\begin{align*}
g \circ \phi'_{\beta_0}
   & = g \circ e \circ \phi_{\beta_1} \circ G(\xi_1)  && \mbox{by definition of }\phi' \\ 
             & = h \circ \phi_{\beta_1} \circ G(\xi_1) && \mbox{ by (\ref{gmediates})} \\
             & = \psi_{\beta_1}  \circ G(\xi_1)       && \mbox{ by (\ref{hmediates})} \\
						 & = \psi'_{\beta_1} \circ G(\xi_1)       && \mbox{ by definition of} \psi \\
						& = \psi'_{\beta_0}                        && \mbox{since }\psi' \mbox{ is a cone} \\ 
\end{align*}
and so, as required, we have shown that 
$g \circ \phi' = \psi'$.
\noindent Finally, if $g':N \morph E$ such that $g' \circ \phi' = \psi'$ then we have 
for any object $\beta$ of S that
$$(g'\circ\phi')_\beta = \psi'_\beta$$
\noindent
and therefore from the defintions of $\phi'$ and $\psi$ we have
that, for all objects $\beta$ of S,
$$
g' \circ e \circ \phi_\beta = \psi_\beta
$$
\noindent
and  from the definition of $h$ as the unique morphism such that
$h \circ \phi = \psi$ we have that 
$g' \circ e = h$.\\

\noindent
Now we have:
 
$$g' \circ e = h = g \circ e$$
from which it follows $g=g'$ because $e$ is an equaliser and therefore is a monomorphism. 
\end{proof}

\bibliography{../SharedBibliography/temp/bibliography}

\end{document}
