\documentclass[10pt,a4paper]{scrartcl}
\usepackage[margin=3cm]{geometry}
\usepackage{pstricks}
\usepackage{pst-node}
\usepackage{pst-tree}
\usepackage{stmaryrd}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{verbatim}
\usepackage{enumerate}
\usepackage{calc}
\usepackage{url}

\input{../SharedMacros/theorems.macros}
\input{../SharedMacros/ccategories.macros}
\input{../SharedMacros/gats.macros}
\input{../SharedMacros/metagat.macros}
\input{../SharedMacros/ermacros}
\input{../SharedMacros/erdiagram}

\renewcommand{\erpictureFolder}[0]{../SharedPictures}

\setcounter{equation}{0}
\bibliographystyle{plain} % was hplain

\title{Dependency Categories}
\author{John Cartmell}
\subtitle{Status: DRAFT\footnote{Treat with caution!}}
\begin{document}
\maketitle

\section{Context, Information Theory, Categories and Types That Vary}

\noindent Under a new name, \textit{dependency category}, this paper corrects the description of \textit{network categories} given in  
\cite{Cartmell86B}. Dependency categories are a variation on the notion of contextual category (\cite{Cartmell78}, \cite{Cartmell86}) in that  the category of dependency categories, as defined here, is equivalent to the category of contextual categories.

As in \cite{Cartmell86B} the motivation has been to formalise
and foreground the network structure of type dependencies so as to provide a theoretical foundation for the use of networks of composition relationships in entity modelling as applied both conceptually and, for the most practical of purposes, in systems development. 

The objects of  categories of either persuasion, either contextual categories or dependency categories, can be thought 
of as contexts or as types that vary (also known as dependent types) but equally they can be thought of as entity 
types in the sense used in entity modelling. The
morphisms of either correspond with the many-one binary relationships that are the staple fare of entity modelling and in either case there is a  distinguished subset of morphisms depicted on diagrams using a triangular headed arrow ($\darrow$). In a contextual category  the distinguished 
subset forms a hierarchy, in a dependency category the distinguished morphisms form not a hierarchy but a wide acyclic subcategory.
In either case the distinguished morphisms correspond to certain relationships known as composition relationships which are a feature
of certain styles of entity modelling (\cite{ECMA-149}, \cite{Munck1988}, \cite{entitymodelling}) and as first implied in the influential paper by Chen \cite{Chen1976} who introduced the idea of entities being dependent on binary relationships 
with others for both their identification and their existence.

As a motivating example consider the entity types and binary relationships involved in the representation of a numeric matrix. 
A matrix has rows, columns, elements and, for each element, numeric content. In the style of modelling introduced in \cite{entitymodelling} the structure of a numeric matrix can be represented by entity types and binary relationships as shown in figure \ref{matrixNumeric}.

The types in this example can be represented as types that  vary as shown here: \\

\begin{tabular}{l l}
Symbol & \itshape{Introductory Rule} \\ 
\hline 
$matrix$ &$\tstyle \isT{matrix} $\\
$row$ &$x \in matrix \tstyle row(x) \mbox{ is a type} $\\
$column$ &$x \in matrix \tstyle column(x) \mbox{ is a type} $\\
$element$&$x \in matrix, y_1 \in row(x), y_2 \in column(x) \tstyle element(y_1,y_2) \mbox{ is a type} $\\
$value$&$x \in matrix, y_1 \in row(x), y_2 \in column(x), e \in element(y_1,y_2) \tstyle value(e) \in number$ \\
\end{tabular}


\begin{figure}
\begin{center}
\begin{tabular} { c p{0.5cm} p{6cm}}
\raisebox{-4.8cm}{\input{\erpictureFolder/sparseMatrix}} & &
\textit{In this style of modelling, boxes represent types of entity, connections between boxes represent
many-one binary relationships. Each composition relationship is shown leaving the lower edge of a parent type and meeting the upper
edge of a dependent type. Other relationships, those connecting to left and right sides of boxes, are reference relationships.
The unnamed open box at the top of the diagram represents the absolute or the whole -- it corresponds to the terminal object of category theory.}
\end{tabular}
\end{center}
\caption{Representation of a numeric matrix. Note that the diamond of relationships is a commutative diagram and this has a strong influence on the data representation for data of this type.}
\label{matrixNumeric}
\end{figure}

\section{Directed Graphs and Systems of Dependent Type}

\noindent The directed graph:

\begin{center}
\begin{equation}
\begin{array}{p{1.5cm}cccp{2cm}c}
&                & \Rnode{C2}{C}&   \\ [0.8cm]
&                & \Rnode{B}{B} &  \\ [0.8cm]
&\Rnode{A1}{A_1} &              & \Rnode{A2}{A_2}\\ 
\end{array}
\ncsar{C2}{B}
\ncsar{B}{A1}
\ncsar{B}{A2}
\setlength {\saroffsetA}{-2pt}
\setlength {\saroffsetB}{-2pt}
\ncsar[-15]{C3}{B3}
\setlength {\saroffsetA}{2pt}
\setlength {\saroffsetB}{2pt}
\ncsar[15]{C3}{B3}
\sarreset
\ncsar{B3}{A3}
\end{equation}
\end{center}

\noindent can be interpreted as representing the following type system:

%\addtocounter{equation}{-1}
\begin{align}
&A_1\mbox{ is a type} && \tag*{(\theequation a)}\\
&A_2\mbox{ is a type} && \tag*{(\theequation b)}\\
&x_1\in A_1, x_2 \in A_2 : B(x_1,x_2) \mbox{ is a type} && \tag*{(\theequation c)}\\
&x_1\in A_1, x_2 \in A_2, y \in B(x_1,x_2): C(x_1,x_2,y) \mbox{ is a type} && \tag*{(\theequation d)}
\end{align}


\section {Acyclic Categories}
A category C is called \textit{acyclic}, if it has no inverses and no nonidentity
endomorphisms. This definition is given by Kozlov (see \cite{Kozlov2007}) who offers the following intuition:
\begin{erquote}
Another way to visualize acyclic categories is to think of them as those
that can be drawn on a sheet of paper, with dots indicating the objects, and
straight or slightly bent arrows, all pointing down, indicating the nonidentity
morphisms...
\end{erquote}


\noindent
Previous authors had referred to such categories as being \textit{loop-free}. \\

\noindent
The following is an example of an acyclic category given by Kolozov which we have rearranged and relabelled:

\begin{center}
\begin{equation}
\begin{array}{p{1.5cm}cccp{2cm}c}
&                & \Rnode{C}{C}&   \\ [1.4cm]
&                & \Rnode{B}{B} &  \\ [0.8cm]
&                & \Rnode{A}{A} &  
\end{array}
\end{equation}
\ncasar[-30]{y_1}{C}{B}
\ncasar[30]{y_2}{C}{B}
\ncasar{x}{B}{A}
\setlength {\saroffsetA}{-2pt}
\setlength {\saroffsetB}{-2pt}
\ncbsar[-50]{y_1 \circ x = y_2 \circ x}{C}{A}
\sarreset
\end{center}


\noindent This category can be taken as representing the following type system:
\addtocounter{equation}{-1}
\begin{align}
&A\mbox{ is a type} && \tag*{(\theequation a)}\\
&x\in A: B(x) \mbox{ is a type} && \tag*{(\theequation b)}\\
&x\in A_1, y_1 \in B(x), y_2 \in B(x) : C(x,y_1,y_2) \mbox{ is a type} && \tag*{(\theequation c)}
\end{align}

\noindent
Contrast with this acyclic category:
\begin{center}
\begin{equation}
\begin{array}{p{1.5cm}cccp{2cm}c}
&                & \Rnode{C}{C}&   \\ [1.4cm]
&                & \Rnode{B}{B} &  \\ [0.8cm]
&                & \Rnode{A}{A} &  
\end{array}
\end{equation}
\ncasar[-30]{y_1}{C}{B}
\ncasar[30]{y_2}{C}{B}
\ncasar{x}{B}{A}

\setlength {\saroffsetA}{-2pt}
\setlength {\saroffsetB}{-2pt}
\ncbsar[-60]{x_1 = y_1 \circ x}{C}{A}
\setlength {\saroffsetA}{2pt}
\setlength {\saroffsetB}{2pt}
\ncasar[60]{x_2 = y_2 \circ x}{C}{A}
\sarreset
\end{center}
\noindent
which represents :
\addtocounter{equation}{-1}
\begin{align}
&A\mbox{ is a type} && \tag*{(\theequation a)}\\
&x\in A: B(x) \mbox{ is a type} && \tag*{(\theequation b)}\\
&x_1\in A_1, y_1 \in B(x_1), x_2\in A_1, y_2 \in B(x_2) : C(x_1,x_2,y_1,y_2) \mbox{ is a type} && \tag*{(\theequation c)}
\end{align}

\section{Category with Distinguished Morphisms}

\begin{definition}
\noindent A category $\cat{C}$ is \textit{well-founded} provided that for 
any object $A$ of $C$ the set of morphisms with domain $A$ is finite. 
\end{definition}
\begin{definition}
Define a \textit{category with distinguished morphisms} to be a category \cat{C} along with a wide acyclic subcategory \cat{D} that is well-founded. 
Morphisms of the subcategory are referred to as d-morphism. 
We will write $f:B \dmorph A$ in \cat{C}
to mean that 
$f: B \morph A$ in \cat{C} and that $f$ is a d-morphism i.e is in the subcategory \cat{D} of distinguished morphisms\footnote{
Note that this the same notation has been used differently in \cite{Cartmell86} -- a contextual category does give rise to a category with distinguished morphisms but only
if the distinguished morphisms are taken to be not just those
denoted $p_B: B \dmorph A$ in that paper
but also all those in  the subcategory generated by such.
}. 
\end{definition} 

\section{Spans and Cospans}
\noindent
The category $\Lambda$ is defined to be this category:
\begin{center}
\begin{displaymath}
\begin{array}{cp{0.1cm}cp{0.1cm} c}
            & &\Rnode{d}{\bullet}                  \\ [0.4cm]
\Rnode{c1}{\bullet}& &                & & \Rnode{c2}{\bullet} 
\end{array}
\end{displaymath}
\ncarr{d}{c1}
\ncarr{d}{c2}
\end{center}

\noindent
If we need names for the individual objects and morphisms we will use the names show here:
\begin{center}
\begin{displaymath}
\begin{array}{cp{0.1cm}cp{0.1cm} c}
            & &\Rnode{d}{\Delta}                  \\ [0.4cm]
\Rnode{c1}{\Gamma_1}& &                & & \Rnode{c2}{\Gamma_2} 
\end{array}
\end{displaymath}
\jcbarr{\xi}{d}{c1}
\ncaarr{\gamma}{d}{c2}
\end{center}

\noindent
A \textit{span} within a category \cat{C} is exactly a functor 
$S: \Lambda \morph \cat{C}$; it is a pair of morphisms of \cat{C} that have a common domain object i.e it is any diagram of this form:

\begin{center}
\begin{equation}
\label{genericspan}
\begin{array}{cp{0.1cm}cp{0.1cm} c}
            & &\Rnode{d}{D}                  \\ [0.4cm]
\Rnode{c1}{C_1}& &                & & \Rnode{c2}{C_2} 
\end{array}
\end{equation}
\jcbarr{f}{d}{c1}
\ncaarr{g}{d}{c2}
\end{center}

\noindent Similarly a \textit{cospan} in a category \cat{C} is exactly a functor $S: \Lambda^{op} \morph \cat{C}$ and so it is exactly a diagram of this form:
\begin{center}
\begin{equation}
\label{genericcospan}
\begin{array}{cp{0.1cm}cp{0.1cm} c}
\Rnode{c1}{C_1}& &                & & \Rnode{c2}{C_2} \\ [0.4cm]
            & &\Rnode{b}{B}
\end{array}
\end{equation}
\jcbarr{x_1}{c1}{b}
\ncaarr{x_2}{c2}{b}
\end{center}

\noindent
The cospan (\ref{genericcospan}) of $C_1$ and $C_2$ is said to be a 
\textit{coincident cospan} of the span (\ref{genericspan}) iff the 
diagram:
\begin{center}
\begin{equation}
\begin{array}{cp{0.1cm}cp{0.1cm} c}
            & &\Rnode{d}{D}                           \\ [0.4cm]
\Rnode{c1}{C_1}& &                & & \Rnode{c2}{C_2} \\ [0.4cm]
            & &\Rnode{b}{B}
\end{array}
\end{equation}
\jcbarr{f}{d}{c1}
\ncaarr{g}{d}{c2}
\jcbarr{x_1}{c1}{b}
\ncaarr{x_2}{c2}{b}
\end{center}

\noindent commutes. \\

\noindent We will say that the cospan (\ref{genericcospan}) is a 
\textit{minimal coincident cospan} for the span (\ref{genericspan}) iff it is 
coincident  and there does no exist a cospan 
\begin{center}
\begin{equation}
\begin{array}{cp{0.1cm}cp{0.1cm} c}
\Rnode{c1}{C_1}& &                & & \Rnode{c2}{C_2} \\ [0.4cm]
            & &\Rnode{b}{B'}
\end{array}
\end{equation}
\jcbarr{x'_1}{c1}{b}
\ncaarr{x'_2}{c2}{b}
\end{center}

\noindent
that is coincident to (\ref{genericspan}) and such that there is a morphism 
$h: B' \morph B$ such that both \\
\vspace {0.25cm}

$
\begin{array}{cc}
\Rnode{C1}{C_1}                             \\ [0.7cm]
               & \Rnode{Bp}{B'}             \\ [0.8cm]
							 &  \Rnode{B}{B} 
\end{array}
$
\jcbarr[-30]{x_1}{C1}{B}
\ncaarr{h}{Bp}{B}
\ncaarr{x'_1}{C1}{Bp}
and
$
\begin{array}{p{1.5cm}cc}
&                &\Rnode{C2}{C_2}     \\ [0.7cm]
&\Rnode{Bp}{B'}                       \\ [0.8cm]
&\Rnode{B}{B}
\end{array}
$
\ncaarr[30]{x_2}{C2}{B}
\jcbarr{h}{Bp}{B}
\jcbarr{x'_2}{C2}{Bp}
commute. 
\noindent
A cospan $F:\Lambda^{op} \morph \cat{C}$ is said to \textit{factor through}  a diagram 
$J:S \morph \cat{C}$ iff there exists a cospan $F': \Lambda^{op} \morph S$ 
such that $F' \circ J = F$.
  
\section{Higher Cospans and Quotiented Higher Cospans}
The notion of a \textit{higher cospan} was
 introduced in \cite{Grandis2007} for diagrams
in a category of shape $\Lambda^{op^n}$but for us there are significant diagrams whose 
shape category is a quotient of  ${\Lambda^{op}}^n$ and since we are not aware
of further terminology in this area we introduce some here. It is appropriate to make use the join symbol ($\Join$) from relational algebra. \\

\noindent For any $n \geq 2$ define the category \ndidly to be this category:

\begin{center}
\begin{displaymath}
\begin{array}{cp{0.3cm}c         p{0.3cm}  c p{0.2cm} c}
\Rnode{d1}{\Delta_1}& &               & &     & &\Rnode{d2}{\Delta_2}  \\ [1.2cm]
\Rnode{c1}{\Gamma_1}& &\Rnode{c2}{\Gamma_2}& & ... & &\Rnode{cn}{\Gamma_n}
\end{array}
\end{displaymath}
\ncarr{d1}{c1}
\nbput[npos=0.4, labelsep=1pt]{\footnotesize $\xi_1$}
\ncarr{d1}{c2}
\nbput[npos=0.3, labelsep=1pt]{\footnotesize $\xi_2$}
\ncarr{d1}{cn}
\naput[npos=0.3, labelsep=1pt]{\footnotesize $\xi_n$}
\ncarr{d2}{c1}
\nbput[npos=0.3, labelsep=1pt]{\footnotesize $\gamma_1$}
\ncarr{d2}{c2}
\naput[npos=0.25, labelsep=1pt]{\footnotesize $\gamma_2$}
\ncarr{d2}{cn}
\naput[npos=0.4, labelsep=1pt]{\footnotesize $\gamma_n$}
\end{center}

\begin{definition}
A \textit{\ndidlycospan}
 in category \cat{C}  is any diagram in \cat{C} having 
shape $\ndidly$  i.e. it is any function $F: \ndidly \morph \cat{C}$
\end{definition}

\section{ Some Other Preliminary Definitions\protect\footnote{Please regard the terminology introduced here as provisional -- the author would be glad to receive suggested improvements especially where he has failed to use prior established terminology.}}

\begin{definition}
\noindent If \cat{C} is a category  then a \textit{characterising family} for a span $s$ of \cat{C} is defined to be the set of its minimal coincident cospans.
\end{definition}


\noindent 

\begin{definition}
If \cat{C} is a category with distinguished morphisms 
and if $\tuple{f_1,...f_n}$ is a tuple of d-morphisms of \cat{C} 
with common domain then define the \textit{characterising diagram} of 
$\tuple{f_1,...f_n}$
to be the diagram with shape category \ndidly where 
$$n = 
\sum_{\substack{i,\\1 \leq i \leq n}} \  \sum_{\substack{j,\\ 1 \leq j \leq n,\\ j \neq i}} \ | \chi_{i,j} | $$
and where $\chi_{i,j}$ is the characterising family within the subcategory 
of d-morphisms of \cat{C} for the pair $f_i,f_j$ and 
$|\chi_{i,j}|$ is its cardinality,
and with functor $D: S \morph \cat{C}$ defined for $1 \leq i \leq n$, $1 \leq j \leq n$, $i \neq j$, $1 \leq k \leq | \chi_{i,j}$ by
$$ \xi_{i,j,k}   \mapsto F_{i,j,k}(\xi)$$
and
$$ \gamma_{i,j,k}   \mapsto F_{i,j,k}(\gamma) $$
where $F_{i,j,k}$ is the $k$'th cospan within the characteristic family of the pair $f_i,f_j$.
\end{definition}

\begin{definition}
If \cat{C} is a category with distinguished morphisms then a family of 
d-morphisms  $f_i: B \dmorph A_i$ is said to
be a basis for object B iff for every morphism $f: B \dmorph X$ in \cat{C} either 
\begin{enumerate}[(i)]
\item
$f$ factors through one of $f_i$ for some $i$ i.e there exists $g:A_i \morph X$, for some $i$, such that $f_i \circ g = f$ or
\item
there exists $1 \leq k_1 \leq k_2 ... k_m \leq n$, and d-morphisms 
$g_1,...,g_m$ such that for each $j$, $1 \leq j \leq m$, 
$g_j: X \dmorph A_{k_j}$ and

$$
f \circ g_j = f_{k_j}
$$
and such that the diagram

\begin{center}
\psset{arrowsize=5pt,arrowinset=0.7}
\psset{nodesep=7pt}
\setlength{\arraycolsep}{0.3cm}
\begin{displaymath}
\begin{array}{ccp{0.2cm}p{0.075cm}c}
&&\Rnode{top}{$X$}& & \\[1.5cm]
\Rnode{A}{A_{j_1}}&\Rnode{B2}{A_{j_2}}&& ... & \Rnode{Bm}{A_{j_m}}\\
\end{array}
\end{displaymath}
\psset{nodesepA=4pt,nodesepB=7pt}
\ncline{-}{top}{A}
\tlput{\footnotesize $g_1$}
\ncput[nrot=:R,npos=1]{\pstriangle(0,0)(.2,.2)}
\ncline{-}{top}{B2}
\trput{\footnotesize $g_2$}
\ncput[nrot=:R,npos=1]{\pstriangle(0,0)(.2,.2)}
\ncline{-}{top}{Bm}
\trput{\footnotesize $g_m$}
\ncput[nrot=:R,npos=1]{\pstriangle(0,0)(.2,.2)}
\end{center}

is a limit cone\footnote{I want to say cannonical limit here but I can't.
Monitor this situation to see whether a problem or not. I think it is a minor annoyance. The question is whether if X dependent on Y and Y' isomorphic to Y then X is dependent on Y'. This in turn has an effect on the round trip from presentation to category back to presentation. } in category \cat{C} for the characteristic diagram of $g_1,...g_m$.
\end{enumerate}

\end{definition}

\section{Cones and Tight Cones}
Recall the definition of cone $\tuple{ N,\psi}$ to a diagram $F:J \morph C$ of a category $C$ as an object $N$ of $C$ and a family of morphisms $\psi_j$ indexed by objects $j$ of $J$ such that for all $f: j \morph j'$ in $J$, $\psi_j \circ F(f) = \psi_{j'}$. Define a cone $\tuple{ N,\psi}$to be \textit{tight} iff for all pairs $j_1,j_2$ of objects of shape category $J$, every minimal coincident cospan of the span:

\begin{center}
\begin{equation}
\begin{array}{cp{0cm}cp{0cm} c}
            & &\Rnode{d}{N}                           \\ [0.4cm]
\Rnode{c1}{F(j_1)}& &                & & \Rnode{c2}{F(j_2)} 
\end{array}
\end{equation}
\jcbarr{\psi_{j_1}}{d}{c1}
\ncaarr{\psi_{j_2}}{d}{c2}
\end{center}

factors through the diagram $F$.

\section{Definition of Dependency Category}
A \textit{dependency category} is a category \cat{C} with distinguished morphisms and a terminal object $1$ and :

\begin{enumerate} [(i)]
	\item for any object A of \cat{C} the unique morphism $t_A:A \morph 1$ is a d-morphism
	
	
	\item for all diagrams D of d-morphisms \begin{center}
$
\begin{array}{cp{0cm}cp{0cm}c}
\Rnode{B1}{B}& &            &  &\Rnode{B2}{B'} \\ [1.2cm]
               & &\Rnode{A}{A}& &
\end{array}
$
\ncbsar{x}{B1}{A}
\ncasar{x'}{B2}{A}
\end{center}
	
an object  $ \fibrex{B_1}{B_2}{D}$ of \cat{C} and d-morphisms 
$p_1: \fibrex{B_1}{B_2}{D} \dmorph B_1$ and  $p_1: \fibrex{B_1}{B_2}{D} \dmorph B_1$ such that :

\begin{center}
\begin{displaymath}
\begin{array}{cp{0.1cm}cp{0.1cm} c}
            & &\Rnode{d}{\fibrex{B_1}{B_2}{D}}                  \\ [0.4cm]
\Rnode{c1}{B_1}& &                & & \Rnode{c2}{B_2} 
\end{array}
\end{displaymath}
\ncbsar{p_1}{d}{c1}
\ncasar{p_2}{d}{c2}
\end{center}

is a pullback in category \cat{C} and such that for any 
cone $\tuple{N,\psi}$ to diagram $D$
the mediating morphism $h: N \morph B_1 \underset{D}{\Join} B_2$ is a d-moprphism iff 
every morphism in the cone \ $\tuple{N,\psi}$ is a d-morphism and the cone is tight.

	\item Other pullbacks: if
\begin{center}
\begin{displaymath}
\begin{array}{cp{.9cm}c}
            & & \Rnode{X}{X} \\ [1.2cm]
\Rnode{A}{A}& & \Rnode{B}{B} \\
\end{array}
\end{displaymath}
\jcbarr{f}{A}{B}
\ncasar{y}{X}{B}
\end{center}

then there is a pullback 
\vspace{3mm}
\begin{center}
\begin{displaymath}
\begin{array}{cp{.9cm}c}
\Rnode{fstarX}{X[f|y]} & & \Rnode{X}{X}\\ [1.2cm]
\Rnode{A}{A}         & & \Rnode{B}{B}
\end{array}
\end{displaymath}
\ncbsar{f^*y}{fstarX}{A}
\jcbarr{f}{A}{B}
\ncaarr{q(f,y)}{fstarX}{X}
\ncasar{y}{X}{B}
\end{center}
and pullbacks cohere\footnote{exactly as for contextual category}
and if also:
\begin{center}
$
\begin{array}{cp{.9cm}c}
            & & \Rnode{X}{X} \\ [1.2cm]
& & \Rnode{Bprime}{B'} \\
\end{array}
$
\ncasar{$y'$}{X}{Bprime}
\end{center}
and $y \neq y'$ then $q(f,y) \circ y'$ is a d-morphism. 
\noindent Further, if
\begin{center}
$
\begin{array}{p{2cm}p{0.5cm}p{0.5cm}p{0.5cm}}
& & \Rnode{X}{X}& \\ [1.4cm]
\Rnode{A}{A} & \Rnode{B1}{$B_1$} & ... & \Rnode{Bm}{$B_m$}\\
\end{array}
$
\jcbarr{f}{A}{B1}
\ncbsar{y_1}{X}{B1}
\ncasar{y_m}{X}{Bm}
\end{center}
and $y_1,...y_m$ is a basis for $X$ 
\noindent then the set:
\vspace{2mm}
\begin{center}
\psset{arrowsize=5pt,arrowinset=0.7}
\psset{nodesep=7pt}
\setlength{\arraycolsep}{0.3cm}
\begin{displaymath}
\begin{array}{ccp{0.2cm}p{0.075cm}c}
&&\Rnode{top}{$X[f|y_1]$}& & \\[1.5cm]
\Rnode{A}{A}&\Rnode{B2}{B_2}&& ... & \Rnode{Bm}{B_m}\\
\end{array}
\end{displaymath}
\psset{nodesepA=4pt,nodesepB=7pt}
\ncline{-}{top}{A}
\tlput{\footnotesize $f^*y_1$}
\ncput[nrot=:R,npos=1]{\pstriangle(0,0)(.2,.2)}
\ncline{-}{top}{B2}
\trput{\footnotesize $f_*y_2$}
\ncput[nrot=:R,npos=1]{\pstriangle(0,0)(.2,.2)}
\ncline{-}{top}{Bm}
\trput{\footnotesize $f_*y_m$}
\ncput[nrot=:R,npos=1]{\pstriangle(0,0)(.2,.2)}
\end{center}
is a basis for  $f^*X$.


\item If in (iii) the morphism f is a dependency then  $q(f,y)$ is also a dependency and 

\noindent for any diagram D:
\begin{center}
$
\begin{array}{cp{0cm}cp{0cm}c}
\Rnode{B1}{B_1}& &            &  &\Rnode{B2}{B_2} \\ [1.2cm]
               & &\Rnode{A}{A}& &
\end{array}
$
\ncbsar{x_1}{B1}{A}
\ncasar{x_2}{B2}{A}
\end{center}

\noindent then
$B_2[x_1|x_2]=B_1[x_2|x_1] = \fibrex{B_1}{B_2}{D}$ and $q(x_1,x_2)= x_2\sub x_1 $ and $q(x_2,x_1)= x_1 \sub x_2$
\noindent
so that we have:

\begin{center}
$
\begin{array}{cp{0cm}cp{0cm}c}
               && \Rnode{X}{\fibrex{x_1}{x_2}{D}}&&                \\ [1.2cm]
\Rnode{B1}{x_1}&&                                && \Rnode{B2}{x_2} \\ [1.2cm]
               &&\Rnode{A}{A}                    && 
\end{array}
$
\ncbsar{x_1}{B1}{A}
\ncasar{x_2}{B2}{A}
\ncbsar{q(x_2,x_1)=x_1*x_2=p_1}{X}{B1}
\ncasar{q(x_1,x_2)=x_2*x_1=p_2}{X}{B2}
\end{center}






\item Equalisers and properties of equalisers: If
\setlength{\arraycolsep}{1cm}
\psset{arrowsize=5pt,arrowinset=0.7}
\psset{nodesep=7pt}
$
\begin{array}{c}
\Rnode{B}{B} \\ [1.1cm]
\Rnode{A}{A} \\
\end{array}
$
\psset{nodesepA=4pt,nodesepB=7pt}
\ncarc[arcangle=-30]{-}{B}{A}
\nbput{\footnotesize $x_1$}
\ncput[nrot=:R,npos=1]{\pstriangle(0,0)(.2,.2)}
\ncarc[arcangle=30]{-}{B}{A}
\naput{\footnotesize $x_2$}
\ncput[nrot=:R,npos=1]{\pstriangle(0,0)(.2,.2)}
then there is an equaliser:
\setlength{\arraycolsep}{.75cm}
$
\begin{array}{ccc}
\Rnode{Eq}{\underset{x_1=x_2}{\sigma}B} & \Rnode{B}{B}  & \Rnode{A}{A} \\
\end{array}
$
\psset{nodesepA=4pt,nodesepB=7pt}
\ncline[offset=4pt]{-}{B}{A}
\naput{\footnotesize $x_1$}
\ncput[nrot=:R,npos=1]{\pstriangle(0,0)(.2,.2)}
\ncline [offset=-4pt]{-}{B}{A}
\nbput{\footnotesize $x_2$}
\ncput[nrot=:R,npos=1]{\pstriangle(0,0)(.2,.2)}
\ncline{->}{Eq}{B}
\naput{\footnotesize $e$}
\noindent and the morphism $e \circ x_1$ which equals, by definition, $e \circ a_2$  is a d-morphism as shown
in the following diagram:
\vspace{.2cm}
\begin{center}
\setlength{\arraycolsep}{.3cm}
$
\begin{array}{ccc}
\Rnode{Eq}{\underset{x_1=x_2}{\sigma}B} & &\Rnode{B}{B} \\[1.4cm]
 & \Rnode{A}{A} &\\
\end{array}
$
\psset{nodesepA=3pt,nodesepB=9pt}
\ncarc[arcangle=-15]{-}{B}{A}
\nbput{\footnotesize $x_1$}
\ncput[nrot=:R,npos=1]{\pstriangle(0,0)(.2,.2)}
\psset{nodesepA=4pt,nodesepB=7pt}
\ncarc[arcangle=15]{-}{B}{A}
\naput{\footnotesize $x_2$}
\ncput[nrot=:R,npos=1]{\pstriangle(0,0)(.2,.2)}
\ncline{->}{Eq}{B}
\naput{\footnotesize $e$}
\ncarc[arcangle=-5]{-}{Eq}{A}
\nbput{\footnotesize $e \circ x_1 = e \circ x_2$}
\ncput[nrot=:R,npos=1]{\pstriangle(0,0)(.2,.2)}
\end{center}

\noindent For any other d-morphism $a':B\darrow A'$ leaving B, the morphism $e \circ a'$ is a d-morphism; furthermore, if
\begin{center}
\setlength{\arraycolsep}{.1cm}
$
\begin{array}{ccp{.3cm}c}
                  & \multicolumn{2}{c}{\Rnode{B}{B}}& \\ [1.4cm]
\Rnode{A1}{A_1} &\Rnode{A2}{A_2}& ... & \Rnode{Am}{A_m}\\
\end{array}
$
\psset{labelsep=1pt,npos=0.6}
\ncbsar{x_1}{B}{A1}
\ncasar{x_2}{B}{A2}
\ncasar{x_m}{B}{Am}
\end{center}
and $x_1,...x_m$ is a basis for B 
then

\begin{center}
\setlength{\arraycolsep}{.1cm}
$
\begin{array}{cp{.35cm}cp{.4cm}c}
                  & \multicolumn{3}{c}{\Rnode{diamondB}{\underset{x_1=x_2}{\sigma}B}}& \\ [1.4cm]
\Rnode{A1}{A_1} & &\Rnode{A3}{A_3} &... & \Rnode{Am}{A_m}\\
\end{array}
$
\psset{labelsep=1pt,npos=0.6}
\ncbsar{e \circ a_1 = e \circ x_2}{diamondB}{A1}
\psset{labelsep=1pt,npos=0.8}
\ncasar{e \circ x_3}{diamondB}{A3}
\ncasar{e \circ x_m}{diamondB}{Am}
\end{center}
\setlength{\arraycolsep}{0.1cm}
\noindent is a basis for $\underset{x_1=x_2}{\sigma}B$. 

\noindent For any object $C$ and morphism $y: C \morph B$ such that
$y \circ x_1 = y \circ x_2$
the mediating morphism $h: C \morph \underset{x_1=x_2}{\sigma}B$ is a d-morphism iff 
the morphism $y$ is a d-morphism and the cone $\tuple{C,y}$ is tight i.e iff there does not exist an object $A'$ distinct from 
$A$ and morphisms $x'_1: B \dmorph A'$, $x'_2: B \dmorph A'$ and $x:A' \dmorph A$ such that each of the three diagrams contained here:

\begin{center}
$
\begin{array}{cp{0.5cm}cp{0.5cm}c}
               && \Rnode{X}{C}&&                  \\ [0.6cm]
\Rnode{B1}{B}&&                  && \Rnode{B2}{B} \\ [0.6cm]
               &&\Rnode{Ap}{A'}  &&               \\ [1cm]
               &&\Rnode{A}{A}    && 
\end{array}
$
\ncbsar{y}{X}{B1}
\ncasar{y}{X}{B2}
\ncbsar{x'_1}{B1}{Ap}
\ncasar{x'_2}{B2}{Ap}
\ncasar{x}{Ap}{A}
\ncbsar[-30]{x_1}{B1}{A}
\ncasar[30]{x_2}{B2}{A}
\end{center}

\noindent commute. \\


\noindent This completes the definition.

\end{enumerate}

\section{Construction of Limits of Other Dependency Diagrams}

\begin{lemma}
For all diagrams D of d-morphisms with shape \ndidly:
	
\begin{center}
\begin{displaymath}
\begin{array}{cp{0.3cm}c         p{0.3cm}  c p{0.2cm} c}
\Rnode{d1}{B}& &               & &     & &\Rnode{d2}{B'}  \\ [1.4cm]
\Rnode{c1}{A_1}& &\Rnode{c2}{A_2}& & ... & &\Rnode{cn}{A_n}
\end{array}
\end{displaymath}
\ncsar{d1}{c1}
\nbput[npos=0.4, labelsep=1pt]{\footnotesize $x_1$}
\ncsar{d1}{c2}
\nbput[npos=0.3, labelsep=1pt]{\footnotesize $x_2$}
\ncsar{d1}{cn}
\naput[npos=0.3, labelsep=1pt]{\footnotesize $x_n$}
\ncsar{d2}{c1}
\nbput[npos=0.3, labelsep=1pt]{\footnotesize $x'_1$}
\ncsar{d2}{c2}
\naput[npos=0.25, labelsep=1pt]{\footnotesize $x'_2$}
\ncsar{d2}{cn}
\naput[npos=0.4, labelsep=1pt]{\footnotesize $x'_n$}
\end{center}

there is an object  $ \fibrex{B_1}{B_2}{D}$ of \cat{C} and d-morphisms 
$p_1: \fibrex{B_1}{B_2}{D} \dmorph B_1$ and  $p_1: \fibrex{B_1}{B_2}{D} \dmorph B_1$ such that :

\begin{center}
\begin{displaymath}
\begin{array}{cp{0cm}cp{0cm} c}
            & &\Rnode{d}{\fibrex{B_1}{B_2}{D}}                  \\ [0.6cm]
\Rnode{c1}{B_1}& &                & & \Rnode{c2}{B_2} 
\end{array}
\end{displaymath}
\ncbsar{p_1}{d}{c1}
\ncasar{p_2}{d}{c2}
\end{center}

is a limit of diagram $D$ in category \cat{C} and such that for any cone $\tuple{N,\psi}$ to diagram $D$
the mediating morphism $h: N \morph B_1 \underset{D}{\Join} B_2$ is a d-morphism iff 
each morphism in the cone $\tuple{N,\psi}$ is a d-morphism and the 
cone is tight. 

\end{lemma}
\begin{proof}
\noindent This lemma can be proved by induction using the next lemma.
\end{proof}
\begin{lemma}
In any category \cat{C} if $F: S \morph \cat{C}$ is a diagram with limit $\tuple{L,\phi}$,
if $S'$ is a category extending $S$ by an object $\beta_0$ and a pair of morphisms $\xi_1: \beta_1 \morph \beta_0$ and $\xi_2: \beta_2 \morph \beta_0$, where $\beta_1$ and $\beta_2$ are objects of $S$, if $G: S \morph \cat{C}$ is a diagram that extends $F$, then if :
\begin{center}
\begin{equation}
\label{equaliser}
\begin{array}{cp{1cm}cp{1cm} c}
\Rnode{E}{E}& &    \Rnode{L}{L}  & & \Rnode{A}{\beta_0} 
\end{array}
\end{equation}
\ncaarr{e}{E}{L}
\setlength{\arroffsetA}{3pt}
\setlength{\arroffsetB}{3pt}
\ncarr{L}{A}
\naput{$\phi_B \circ G(\xi_1)$}
\setlength{\arroffsetA}{-3pt}
\setlength{\arroffsetB}{-3pt}
\ncarr{L}{A}
\nbput{$\phi_{B'} \circ G(\xi_2)$}
\arreset
\end{center}
is an equaliser in \cat{C} then $\tuple{E,\phi'}$ is a limit of the diagram $G$, where
$\phi'$ is the cone defined by
\begin{equation*}
\phi'_\beta =
\left\{
	\begin{array}{ll}
		e \circ \phi_\beta           & \mbox{if } \beta \mbox{ is an object of } S  \\
		\phi_{\beta_1} \circ G(\xi_1) & \mbox{if } \beta \mbox{ is } \beta_0 
	\end{array}
\right.
\end{equation*}

\end{lemma}
\begin{proof}
If $\tuple{N,\psi'}$is a cone to the diagram $G$ then, the restriction $\psi$ to objects in $F$ is a cone to  $S$. Therefore there exists a unique $h : N \morph L$ such that 
\begin{equation}
\label{hmediates}
h \circ \phi = \psi
\end{equation}

\noindent
Now, we have 
\begin{align*}
h \circ \phi_{\beta_1} \circ G(x)
             & = \psi_{\beta_1} \circ G(\xi_1)         && \mbox{by (\ref{hmediates})}\\
             & = \psi_{\beta_2} \circ G(\xi_2)         && \mbox{because } \psi \mbox{ is a cone to } G \\
             & = h \circ \phi_{\beta_2} \circ G(\xi_2) && \mbox{by (\ref{hmediates}) }\\
\end{align*}

\noindent
and so it follows, since (\ref{equaliser}) is an equaliser diagram,
that there is a unique $g: N \morph E$ such that 
\begin{equation}
\label{gmediates}
g \circ e = h
\end{equation}

\noindent
To show that $\tuple{E,\phi'}$ is a limit to the diagram G we show that 
$g \circ \phi' = \psi'$ and that $g$ is the unique such morphism,
$g: N \morph E$.
\noindent
We need show that for all objects $\beta$ of $S'$,  $(g \circ \phi')_\beta =\psi'_\beta$. 
We need consider two cases. In the first case for objects $\beta$ of $S$ we have:
\begin{align*}
g \circ \phi'_\beta
             & = (g \circ e) \circ \phi_\beta   &&  \mbox{ by definition of } \phi\\
             & = h \circ \phi_\beta             && \mbox{ by (\ref{gmediates})}   \\
             & = \psi_\beta                     && \mbox{ by (\ref{hmediates})}   \\
						 & = \psi'_\beta                    && \mbox{ by definition of } \psi\\
\end{align*}

\noindent
In the second case the object $\beta$ is the additional object $\beta_0$ of $S'$. For this object we have:
\begin{align*}
g \circ \phi'_{\beta_0}
   & = g \circ e \circ \phi_{\beta_1} \circ G(\xi_1)  && \mbox{by definition of }\phi' \\ 
             & = h \circ \phi_{\beta_1} \circ G(\xi_1) && \mbox{ by (\ref{gmediates})} \\
             & = \psi_{\beta_1}  \circ G(\xi_1)       && \mbox{ by (\ref{hmediates})} \\
						 & = \psi'_{\beta_1} \circ G(\xi_1)       && \mbox{ by definition of} \psi \\
						& = \psi'_{\beta_0}                        && \mbox{since }\psi' \mbox{ is a cone} \\ 
\end{align*}
and so, as required, we have shown that 
$g \circ \phi' = \psi'$.
\noindent Finally, if $g':N \morph E$ such that $g' \circ \phi' = \psi'$ then we have 
for any object $\beta$ of S that
$$(g'\circ\phi')_\beta = \psi'_\beta$$
\noindent
and therefore from the defintions of $\phi'$ and $\psi$ we have
that, for all objects $\beta$ of S,
$$
g' \circ e \circ \phi_\beta = \psi_\beta
$$
\noindent
and  from the definition of $h$ as the unique morphism such that
$h \circ \phi = \psi$ we have that 
$g' \circ e = h$.\\

\noindent
Now we have:
 
$$g' \circ e = h = g \circ e$$
from which it follows $g=g'$ because $e$ is an equaliser and therefore is a monomorphism. 
\end{proof}

\bibliography{../SharedBibliography/temp/bibliography}

\end{document}
