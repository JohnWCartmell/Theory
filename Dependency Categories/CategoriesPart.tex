\documentclass[10pt,a4paper]{scrartcl}
%\usepackage[margin=3cm]{geometry} %see below for making room for margin comments
\usepackage{url}
\usepackage{hyperref}
\usepackage{environ}
\NewEnviron{shrunkdisplay}{%
\begin{equation*}
\scalebox{0.9}{$\BODY$}
\end{equation*}
}

\input{../SharedMacros/theorems.macros}
\input{../SharedMacros/ccategories.macros}
\input{../SharedMacros/gats.macros}
\input{../SharedMacros/metagat.macros}
\input{../SharedMacros/ermacros}
\input{../SharedMacros/erdiagram}
\input{../SharedMacros/indexedsets.macros}
\usepackage{ulem} % for \sout for use by \oldt macro
\input{../SharedMacros/general.macros}

\renewcommand{\erpictureFolder}[0]{../SharedPictures}
\usepackage{mathtools}
% support margin notes
\usepackage[left=1.5cm, right=4cm, marginparwidth=3cm, top=2cm, bottom=2.0cm]{geometry}
\setcounter{equation}{0}
\bibliographystyle{plain} % was hplain

\title{Notes on Categories - Work in Progress}
\author{John Cartmell\footnote{john.w.cartmell gmail.com}\\ \normalsize{\textit{Ad Otium}}}
\begin{document}
\newcommand{\catc}{\cat{C}}
\newcommand{\catcw}{\cat{C}\ }

\section {Object Congruences}

\begin{definition}
If \catcw is a category  then by an \term{object congruence} $\tuple{\sim,i}$ on \catcw we mean  an equivalence relation $\sim$ on objects of the category and for each pair
of $a, a'$ of equivalent objects of \catcw a morphism $i_{a,a'}:a \morph a'$ such that
\begin{enumerate} [(i)]
\item  for all objects $a$ of \catc, $i_{a,a}=id_a$,
\item for all objects $a, a', a''$ of \catc, $i_{a,a'}\circ i_{a',a''}=i_{a,a''}$.
\end{enumerate} 
\end{definition}

\begin{lemma}
\llabel{iiso}
If $\tuple{\sim,i}$ is an object congruence on a category \catcw then
for all objects $a,a'$ such that $a \sim a'$, the morphism $i_{a,a'}$ is an isomorphism with inverse $i_{a',a}$.
\end{lemma}
\begin{proof}
\begin{align*}
i_{a,a'} \circ i_{a',a} &= i_{a,a} &&\mbox{from condition (ii) of definition of object congruence}, \\
                        &= id_a    &&\mbox{from condition (i) of definition of object congruence}.
\end{align*}
\end{proof}

Define the quotient category $Q_C$ defined by an object congruence $\tuple{\sim,i}$ within a category \catcw to be the category
having as objects equivalence classes of objects of $\catcw$ under the relations $\sim$ 
and having as morphisms  $Hom_{Q_C}([a],[b])$ equivalence classes of the set
\begin{displaymath}
\bigcup_{a' \in [a]}\bigcup_{b' \in [b]}Hom(a',b')
\end{displaymath}
under the equivalence relation $\approx$ which is defined, for $f: a \morph b$ and $f': a' \morph b'$ in  \catcw, by
\begin{displaymath}
f \approx f' \mbox{ iff } f \circ i_{b,b'} = i_{a,a'} \circ f'.
\end{displaymath}
That $\approx$ is an equivalence relationship is established by showing it to be symmetric and transitive.
It is symmetric because 
if $f: a \morph b$ and $f': a' \morph b'$ in  \catcw and if $f \approx f'$ then 
\begin{align*}
                  && f \circ i_{b,b'} & = i_{a,a'} \circ f'  && \mbox{by definition of $f \approx f'$} \\
\mbox{therefore}		&& i_{a',a} \circ f \circ i_{b,b'}  \circ i_{b',b}  & = i_{a',a} \circ i_{a,a'} \circ f' \circ i_{b',b} && \\
\mbox{therefore}		&& i_{a',a} \circ f  = f' \circ i_{b',b} && \mbox{by lemma \lref{iiso}, as required.} 
\end{align*}

$\approx$ is transitive because 
if $f: a \morph b$, $f': a' \morph b'$ and $f'': a'' \morph b''$ in  \catcw and if $f \approx f'$ and $f' \approx f''$ then
\begin{align*}
f \circ i_{b,b''} &=  f \circ i_{b,b'} \circ i_{b',b''}  && \mbox{by condition(ii) of definition of object congruence,} \\
                  &= i_{a,a'} \circ f' \circ i_{b',b''}  && \mbox{since $f \approx f'$}, \\
									&= i_{a,a'} \circ i_{a',a''} \circ f'' && \mbox{since $f' \approx f''$}, \\
									&= i_{a,a''} \circ f''                 && \mbox{by condition(ii) of definition of object congruence}
\end{align*}
and so we have shown that $f \approx f''$, as required.

Define composition of morphisms in $Q_C$ as follows.  If
 $f:a \morph b$ and $g: b' \morph c$ in \catcw, then define $[f] \circ [g]$ in $Q_C$ to be $[f \circ i_{b,b'} \circ g]$.

We need show that composition is well defined.  Assume $f:a \morph b$, $g: b' \morph c$, $f':a' \morph b''$ and $g': b''' \morph c'$ in \catcw and that
$f \approx f'$ and $g \approx g'$ then 
$[f] \circ [g]$ we have defined to be $[f \circ i_{b,b'} \circ g]$  and $[f']  \circ [g']$ we have defined to be $[f' \circ i_{b'',b'''} \circ g']$
and to show that composition in $Q_C$ is well defined we need to show that these are the same i.e. that $f \circ i_{b,b'} \circ g \approx f' \circ i_{b'',b'''} \circ g'$. This identity
is expressed by the commutivity of the outer square in the diagram below and follows from the commutivity of the inner squares which follow respectively from the assumption that $f \approx f'$,
from the condition (ii) of definition of an object congruence and from the assumption that $g \approx g'$.

\vspace{3mm}
\begin{center}
\begin{displaymath}
\begin{array}{cp{.9cm}cp{.9cm}cp{.9cm}c}
\Rnode{Top1}{a} & & \Rnode{Top2}{b}  & & \Rnode{Top3}{b'} && \Rnode{Top4}{c}\\ [1.2cm]
\Rnode{Bottom1}{a'} & & \Rnode{Bottom2}{b''}  & & \Rnode{Bottom3}{b'''} && \Rnode{Bottom4}{c'}
\end{array}
\end{displaymath}
\ncarr{Top1}{Top2}
\alabel{f}
\ncarr{Top2}{Top3}
\alabel{i_{b,b'} }
\ncarr{Top3}{Top4}
\alabel{g}
\ncarr{Top1}{Bottom1}
\blabel{i_{a,a'}}
\ncarr{Top2}{Bottom2}
\blabel{i_{b,b''} }
\ncarr{Top3}{Bottom3}
\blabel{i_{b',b'''} }
\ncarr{Top4}{Bottom4}
\alabel{i_{c,c'}}
\ncarr{Bottom1}{Bottom2}
\blabel{f'}
\ncarr{Bottom2}{Bottom3}
\blabel{i_{b'',b'''} }
\ncarr{Bottom3}{Bottom4}
\blabel{g'}
\end{center}


The identity morphism on object $[a]$ is defined to be $[id_a]$
and composition  is defined,  for
 $f:a \morph b$ and $g: b' \morph c$ in \catcw, by $[f] \circ [g]=[f \circ i_{b,b'} \circ g]$.

If $a$ is an object of $\catcw$ then $id_{[a]}$ is a left identity since if  $a \sim a'$ and $f:a' \morph b$ then 
\begin{align*}
id_{[a]} \circ [f] & = [id_a] \circ f                                             \\
                 &= [i_{a,a'} \circ f]                                            \\
                 &= [f]                & &\mbox {by definition of $\approx$. }
\end{align*}
$id_{[a]}$ is a right identity since if $f:a \morph b$ and $b \sim b'$  then

\begin{align*}
[f] \circ id_{[b']} \circ  & = [f]  \circ [id_{b'}]                                     \\
                 &=  [f \circ i_{b,b'} \circ id_{b'} ]                                  \\
                 &=  [f \circ i_{b,b'} ]                                                \\
                 &=  [f]                & &\mbox {by definition of $\approx$. }
\end{align*}


Composition is associative because if $f:a \morph b$, $g: b' \morph c$  and $h: c' \morph d$ in \catcw then
\begin{align*}
[f] \circ ([g] \circ [h]) &= [f \circ [g \circ i_{c,c'} \circ h]               \\
                          &= [f \circ i_{b,b'} \circ g \circ i_{c,c'} \circ h] \\
													&= [f \circ i_{b,b'} \circ g] \circ [h]              \\
													&= ([f] \circ [g]) \circ [h].
\end{align*}
This completes the defintion of the category $Q_C$.
Note that there is a functor $F: \catc \morph Q_C$ defined by
\begin{align*}
       a & \mapsto [a] \\
			 f & \mapsto [f]
\end{align*}
The functor $F$ is faithful because if $f,g : a \morph b$ in \catcw then $[f]=[g]$ because $f \circ i_{b,b}=i_{a,a} \circ g$ by condition (i) of the definition of object congruence.

\section{Categories with n-ary Products} 
We concern ourselves with categories with a specified n-ary product structure and 
 with addition properties that might in some cases hold of this specified structure.  
Because we are concerned with categories corresponding to type theories we assume that the specified n-ary products are associative.
\begin{definition}
By a \term{category with n-ary products} I shall mean a category \catcw with additional structure as follows:
\begin{itemize}
\item for each $n \geq 1$, an n-ary operation $\productn$ on objects of \catcw so that if $\An$ is a sequence of $n$ objects of $\catcw$ then $\productn(\An)$ is an object of \catc,
\item for each $n \geq 1$, \foreachi, a morphism $p_{n,i}(\An):\productn(\An) \morph A_i$ in \catc, which when it is unambiguous we abbreviate as $p_i: \productn(\An) \morph A_i$
 such that

\begin{center}
\begin{displaymath}
\begin{array}{cp{.9cm}cp{.9cm}c}
\Rnode{A1}{A_1} & &   & &              \\ [0.3cm]
\Rnode{A2}{A_2} & &   & &              \\ [-0.1cm]
 \raisebox{-0.3cm}{\vdots} & & \Rnode{PROD}{\productn}(\An)  & &  \\ [0.2cm]
\Rnode{An}{A_n} & &   & & 
\end{array}
\end{displaymath}
\end{center}
\ncarr{PROD}{A1}
\blabel{p_1}[0.55][0.5]
{
\setlength{\arroffsetA}{2pt}
\ncarr{PROD}{A2}
\setlength{\arroffsetA}{0pt}
}
\blabel{p_2}[0.55][0.5]
{
\setlength{\arroffsetA}{2pt}
\setlength{\arroffsetA}{0pt}
}
\ncarr{PROD}{An}
\alabel{p_n}[0.55][0.5]
is a product diagram in $\catcw$ i.e for all objects $X$ of \catcw, for all morphisms $\fn$ of \catcw such that \foreachi, $f_i:X \morph A_i$ there is a unique
morphism $f$, $f: X \morph \productn(\An)$ such that \foreachi, $f \circ p_i = f_i$. In situations where it is not ambiguous, the unique such $f$ corresponding to $\fn$ we write as
$\tuple{\fn}$,
\item
for every object $A$ of \catc, $\product{1}(A)=A$ and $p_{1,1}(A) = id_A$,

\item suppose $n \geq 1$ and that \foreachi, that $\alpha_i$ is a sequence of objects of objects of \catcw of length $m_i$, for some $m_i$,
so that \foreachi, for each $j$, $1 \leq j \leq m_i$, $\alpha_{i,j}$ is an object of \catc,  denote by $\alpha$ the concatenation of the sequences
$\alpha_1,...\alpha_n$ and suppose that the sequence $\alpha$ is of length $m$ i.e. suppose  
$$m=\sum_{1 \leq i \leq n}m_i,$$ 
then
$$
\productn (\product{m_1}(\alpha_1),...\product{m_n}(\alpha_n))= \product{m}(\alpha)
$$
and the projection morphisms cohere in the sense that for \foreachi, for each $j$, $1 \leq j \leq m_i$, 
the projection $p_i \circ p_j:\productn (\product{m_1}(\alpha_1),...\product{m_n}(\alpha_n)) \morph \alpha_i$
is equal to the corresponding \footnote{
By which I mean the projection function $p_k$ where  $$k = j + \sum_{1 \leq i' < i}m_i$$.}
projection function $p_{k} : \product{m}(\alpha) \morph \alpha_i$.  
\end{itemize}
\end{definition}

From the definition of $\tuple{\fn}$ we can easily show
\begin{lemma}
\llabel{xxxx}
If $f: X \morph Y$ in a category with n-ary products \catcw and if \foreachi, $g_i:Y \morph A_i$
in \catcw then $f \circ \tuple{\gn}=\tuple{f \circ g_1,...f \circ g_n}$.
\end{lemma}

\subsection{Unique Factorisation}
\begin{definition}
In a category with n-ary products \catcw define an object $A$ of \catcw to be \term{prime} iff there does not exist $n > 1$ and a sequence of objects $\An$ 
such that $A=\productn(\An)$
\end{definition}
I am going to make a simplifying assumption and restrict attention to categories with n-ary products having the following property.
\begin{definition}
A category with n-ary products has the \term{unique factorisation property} iff for all objects $X$ of $\catc$
there is an $n \geq 1$ and a sequence of prime objects $\An$ such that $X=\productn(\An)$ and the multiset $\set{\An}$
is unique i.e. if for some other sequence $\Bm$, $X=\product{m}(\Bm)$ then $n=m$ and there is a permutation $\sigma:\set{\n} \morph \set{\n}$ such that \foreachi,
$A_i=B_{\sigma(i)}$.
\end{definition}

\subsection{Sequences, Multisets and Permutations}

We are going to be working with finite sequences of objects of categories. In this subsection we 
consider notation for finite sequences in general by assuming a set $U$ and considering a sequence to be exactly a function $\alpha: \set{\n} \morph U$.

For any finite sequence $\alpha$, any element $\alpha_i$ occuring in $\alpha$ may occur a number of times at 
different positions in the sequence. The number of copies is called the \textit{copy number}. If we number each of these copies from $1$ upwards then we call this numbering the \textit{copy instance number} and we shall denote
the numbering function  $c_\alpha$ so that $c_\alpha: \set{\n} \morph N$. If we write
$|S|$ for the cardinality of set $S$ then, 
formally,
the function is defined by
$$
c_\alpha(i) = |\setsuchthat{j}{1 \leq j \leq i \mbox{ and }\alpha_j=\alpha_i}|
$$

If we have two sequences $\alpha$ and $\beta$ then as multisets they may be equal 
which is to say that there may be a permutation $\sigma: \set{\n} \morph \set{\n}$ such that 
\foreachi, $\alpha_i = \beta_{\sigma(i)}$
i.e. such that the diagram

\begin{center}
\begin{equation}
\label{permutingcontexts}
\begin{array}{cp{.5cm}c}
\Rnode{alphan}{\set{\n}}&&                  \\ [0.5cm]
                        &&   \Rnode{U}{U}   \\ [0.5cm]
\Rnode{betan}{\set{\n}} &&                           
\end{array}
\end{equation}
\ncarr{alphan}{U}
\alabel{\alpha}
\ncarr{betan}{U}
\blabel{\beta}
\ncarr{alphan}{betan}
\blabel{\sigma}
\end{center}
commutes. It is easy to see that if there is such a permutation then there is a cannonical such
permutation, we denote it $\sigma_{\alpha,\beta}$, which preserves copy instance number i.e. such that the diagram
\begin{center}
\begin{equation}
\label{preservingcopynumber}
\begin{array}{cp{.5cm}c}
\Rnode{alphan}{\set{\n}}  &&              \\ [0.5cm]
												  && \Rnode{N}{N} \\ [0.5cm]
\Rnode{betan}{\set{\n}}   &&            
\end{array}
\end{equation}
\ncarr{alphan}{N}
\alabel{c_\alpha}
\ncarr{betan}{N}
\blabel{c_\beta}
\ncarr{alphan}{betan}
\blabel{\sigma_{\alpha,\beta}}
\end{center}				
commutes.


\begin{observation}
\llabel{cannonicalpermutation}
If two sequences $\alpha$ and $\beta$ are equal as multisets then there exists a unique permutation $\sigma_{\alpha,\beta}$ of $\alpha$ to $\beta$ 
that preserves copy instance number which is to say that there exists a unique
 $\sigma_{\alpha,\beta}: \set{\n} \morph \set{\n}$ 
such that \foreachi, $\alpha_i = \beta_{\sigma_{\alpha,\beta}(i)}$ 
and $c_\alpha(i) = c_\beta(\sigma_{\alpha,\beta}(i))$ i.e. such that
diagrams (\ref{permutingcontexts}) and (\ref{preservingcopynumber}), above, commute.
\end{observation}

\begin{observation}
\llabel{idcannonical}
If $\alpha$ is any sequence then $\alpha$ as a multiset $\alpha$ is equal  to itself and
the cannonical permutation 
$\sigma_{\alpha,\alpha}$ is the identity permutation.
\end{observation}

Cannonical permutations compose to give cannonical permutations:
\begin{lemma}
\llabel{compositionofcannonicals}
If  $\alpha$, $\beta$ and $\gamma$ are sequences then if $\alpha$ and $\beta$ are equal as multisets and if $\beta$ and $\gamma$ are equal as multisets then
$\alpha$ and $\gamma$ are equal as multisets, and
$\sigma_{\alpha,\gamma}=\sigma_{\alpha,\beta} \circ \sigma_{\beta,\gamma}$.
\end{lemma}
\begin{proof}
It suffices to show that the permutation $\sigma_{\alpha,\beta} \circ \sigma_{\beta,\gamma}$
preserves copy instance number. This can be seen as the commutivity of the outer diagram
follows from the commutivity of the inner diagrams here:
\begin{center}
\begin{displaymath}
\begin{array}{cp{.5cm}cp{.7cm}c}
                         && \Rnode{alphan}{\set{\n}}   &&              \\ [1.2cm]
\Rnode{betan}{\set{\n}} &&                           && \Rnode{N}{N} \\ [1.2cm]
                         && \Rnode{gamman}{\set{\n}}   &&             
\end{array}
\end{displaymath}
\ncarr{alphan}{N}
\alabel{c_\alpha}
\ncarr{betan}{N}
\alabel{c_\beta}
\ncarr{gamman}{N}
\alabel{c_\gamma}
\ncarr{alphan}{betan}
\blabel{\sigma_{\alpha,\beta}}
\ncarr{betan}{gamman}
\blabel{\sigma_{\beta,\gamma}}
\end{center}				
\end{proof}

\subsection{The symmetry object congruence}

If $\catcw$ is a category with finite products having the unique factorisation property then define an object congruence on \catcw as follows.
If $A$ and $B$ are objects of $\catcw$ that are uniquely factorised as $\productn(\An)$ and $\product{m}(\Bm)$, respectively, then define
$A \sim B$ iff the multisets $\set{\An}$ and $\set{\Bm}$ are equal. 
For $A$ and $B$ objects of \catcw such that $A\sim B$ define $i_{A,B}=\tuple{p_{\sigma^{-1}(1)},...p_{\sigma^{-1}(n)}}$ where $\sigma$ is the unique permutation of the set $\set{\n}$ described in observation \lref{cannonicalpermutation}
such that \foreachi, $A_i=B_{\sigma(i)} \mbox{ and }  c_A(i) = c_B(\sigma(i))$.  

\begin{lemma}
$\sim$ and $i$, so defined, constitute an object congruence on the category $\catc$.
\end{lemma}
\begin{proof}
It follows directly from its definition that $\sim$ is an equivalence relation.
That $i$ satsifies condition (i) follows because if object $A$ is factored as $\productn(\An)$
then the cannonical permutation $\sigma_A$ is the identity permutation and therefore 
$i_{A,A}=\tuple{\pn}=id_A$.

To show that $i$ meets condition (ii) assume $A$ factorises as $\productn(\An)$,
$B$ as  
$\productn(\Bn)$, 
and $C$ as $\productn(\Cn)$. 
We have
\begin{align*}
i_{A,B} \circ i_{B,C} 
   & = i_{A,B}
				     \circ 
            \tuple {p_{\sigma_{B,C}^{-1}(1)},...p_{\sigma_{B,C}^{-1}(n)}}
						        && \mbox{expanding the definition of $i_{B,C}$ }\\
	 & = \tuple{i_{A,B} \circ p_{\sigma_{B,C}^{-1}(1)},...i_{A,B} \circ p_{\sigma_{B,C}^{-1}(n)}}                    && \mbox{by lemma \ref{xxxx}},\\
	 & = \tuple {p_{\sigma_{A,B}^{-1}(\sigma_{B,C}^{-1}(1))},...
					                                       p_{\sigma_{A,B}^{-1}(\sigma_{B,C}^{-1}(n))}}
										&& \mbox{\raisebox{-10pt}{\parbox{6cm}{since, from defintion of $i_{A,A}$, \foreachi, $i_{A,B} \circ p_i = p_{\sigma_{A,B}^{-1}(i)}$}}}, \\
   & = \tuple {p_{\sigma_{A,C}^{-1}(1)},...p_{\sigma_{A,C}^{-1}(1)}}
                  && \mbox{since $\sigma_{A,B} \circ \sigma_{B,C}  = \sigma_{A,C}$, by lemma \ref{compositionofcannonicals}, } \\
	 & = i_{A,C}      && \mbox{by definition of $i_{A,C}$}.	
\end{align*}                     
\end{proof}

\section{Example of Data Model which is non-cancellative}
This could be used in preparation for a mathematical theory of data.
\daynote{Tues 28th Oct 2018.}
\subsection{Construction of a category with symmetric products}

\subsection{Characterising Diagrams}
Definition in general setting\daynote{Thurs 19 July 2018}

\bibliography{../SharedBibliography/temp/bibliography}

\end{document}
