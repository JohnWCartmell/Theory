\documentclass[10pt,a4paper]{article}
% 08/02/2019 Maintenance -- use of \obj macro changed to use of \Ob.
\usepackage[margin=3cm]{geometry}
\usepackage{pstricks}
\usepackage{pst-node}
\usepackage{pst-tree}
\usepackage{stmaryrd}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{verbatim}
\usepackage{enumerate}
\usepackage{calc}
\input{../SharedMacros/ccategories.macros}
\input{../SharedMacros/gats.macros}
\input{../SharedMacros/metagat.macros}
\setcounter{equation}{0}
\bibliographystyle{plain} % was hplain

\title{Meta-Theory of Generalised Algebraic Theories}
\author{John Cartmell}
\begin{document}
\maketitle

\section{The Meta-Theory of Generalised Algebraic Theories}
There are several ways of expressing the generalised algebraic 
theory of generalised algebraic theories.  This document introduces one such  
which we call $MetaGAT$ in view of the fact that it can said to be a meta theory of generalised algebraic theories. We describe and discuss the relationship of the theory $MetaGAT$ to the theory of contextual categories.  

\section{Background}
As described in \cite{Cartmell86}, Contextual Categories provide algebraic representations of Generalised Algebraic Theories  in the sense that to every Generalised Algebraic Theory $U$ there is a contextual category $\mathbb{C}(U)$ such that algebras of the theory $U$ are exactly structure preserving functors (contextual functors)  from $\mathbb{C}(U)$ into the contextual category $Fam$ of sets, families of sets and so on. We summarise this by saying that Contextual Categories provide the algebraic semantics of Generalised Algebraic Theories. 

However, contextual categories contain structure that is in some sense redundant; this is in the same way that a Lawvere algebraic theory contains redundant structure compared to the otherwise equivalent notion, from universal algebra, of a clone. In both cases the redundancy is introduced in order to achieve a definition in which the algebraic structures 
 are enrichments (informally speaking) of categories. Remove the redundant structure and there is no longer a category having surface visibility in the definitions. 

The redundancy in the structure of a contextual category is exploited by Vladimir Voevodsky in \cite{Voevodsky14C} to give a Generalised Algebraic Theory of Contextual Categories. The significant point is that Voevodsky does this without introducing additional types whereas I had noted in my thesis \cite{Cartmell78} that contextual categories could be described by a generalised algebraic theory with the introduction of additional equationally defined types to represent identity of morphisms. Voevodsky instead introduces an  `s' operator on morphisms which in fact maps a morphism to a normal form representing that morphism as a section. By a section of type $B$, $Sec_{\mathbb{C}}(B)$, in a contextual category $\mathbb{C}$, I mean a morphism $f:A\rightarrow B$ in $\mathbb{C}$, where 
$A \base B$ and such that $f \comp p(A) = id_A$\footnote{In my thesis the notation $Arr_{\mathbb{C}}(B)$ was used for what here we refer to as the sections and denote $Sec_{\mathbb{C}}(B)$}.

Compared to the theory of contextual categories, the theory $MetaGAT$ does not introduce redundant structure; it axiomatises the types and the terms of the theory directly and these correspond to the objects and the sections of a corresponding contextual category. The theory of contextual categories, on the other hand, axiomatises n-tuples of terms for any n; it is  these that are represented by the morphisms of a contextual category.  

\section{Conclusion}

\begin{enumerate}[(i)]
\item There is an isomorphism between the theory of contextual categories and the theory $MetaGAT$ in the category of existentially and identity enriched generalised algebraic theories. 
\item There is no such isomorphism in the category of generalised algebraic theories.
\item The category of $MetaGAT$ algebras and the category of contextual categories are isomorphic. 
\end{enumerate}

\noindent (iii) follows from (i) only because the contextual category $Fam$ of sets, families of sets has existential quantification and identity types. \\

\noindent $MetaGAT$ algebras may have interpretations (and, therefore, applications) where Contextual Categories do not.

\section{The $MetaGAT$ Theory}

\subsection*{Sorts}
The theory $MetaGat$ has two families of sort symbols representing, respectively,  types and terms of a GAT. \\

\noindent Types of a GAT are represented by a family of sort symbols $\typ_{i)_{i\geq 1}}$ introduced by rules as follows: 
\begin{align*}
&\isT{\typ_1} \\
&\ofT{x_1}{\typ_1} \tstyle \isT{\typ_2(x_1)} \\
& \vdots \\
&\context{x}{\typ}{i} \tstyle \isT{\typ_{i+1}(x_1, ..x_{i})} \\
\end{align*}
\noindent We can drop the subscripts from $\typ$ and omit the inessential variables so that we express as:

\begin{equation}
\ofT{x_1}{\typ},.. \ofT{x_{n}}{\typ(x_{n-1})} \tstyle \isT{\typ(x_{n})} \\
\end{equation}
\vspace{0cm}

\noindent Terms of a GAT are represented in $MetaGat$ by a family of 
sort symbols $\trm_{i)_{i\geq 1}}$. 
When x is a type at level i, $\trm_i(x)$ represents the terms of type $x$. 
As before, the subscripts and the inessential variables can be omitted and so, formally, each operator $\trm$ is introduced by:

\begin{equation}
\label{sortintroterm}
\typeseq{x}{n}, \ofT{x}{\typ(x_{n})} 
\tstyle \isT{\trm(x)}
 \\
\end{equation}
\vspace{0cm}

\noindent We see, therefore, that a $MetaGAT$ algebra has a tree of types and for each type a set of terms.
If, in some context, $f$ is a term of type $\trm(x)$ then we picture it in the tree of types as an arrow leading to $x$ from its predecessor node which, in some cases, may be the root of the tree.
For example, in the context given in equation (\ref{sortintroterm}), if f is a term of type $\trm(x)$ then this is pictured so:
\newcommand{\dottree}
{ \pstree
  {\Tr[edge=\dottededge]{}}
	{
	  \Tr[edge=\dottededge]{}
		\Tr[edge=\dottededge]{}
		%\Tr[edge=\dedge]{}
	}
}

\newcommand{\flabbytree}[3]
{
\pstree[levelsep=*1.2cm]
		{\Tr{#1_1}}
		{ \Tr[edge=\dottededge]{}
		  \Tr[edge=\dottededge]{}
		  \pstree[levelsep=*1.2cm]
				{\Tr{#1_2}}
				{\Tr[edge=\dottededge]{}
         \pstree[levelsep=*0.6cm]
				    {\Tr[edge=\dottededge]{#1_{#2}}}
					  {#3}
			  }
		}
}

\begin{displaymath}
\pstree[treemode=R,levelsep=*1.2cm,treesep=0.5cm, nodesep=0.1cm]
{\Tr{\circ}}
{
\dottree
\dottree
  \flabbytree{x}{n}
    {
		  \Tr{x} \member{f}
		}
}
\end{displaymath}

\subsection*{Operators}
There are three families of operators in $MetaGAT$. In short they represent substitution  denoted by $\sub$, weakening denoted by $\cross$ and tautology (x in the context of x) which we call the diagonal and denote $\delta$. We now describe the
types of these operators in detail and a set of axioms that then complete the definition of $MetaGAT$. 

\subsection*{Substitution - The $\sub$ operators}

\noindent A family of operators is introduced for substitution of terms into terms and types. Without ambiguity we can dispense with subscripts and use the symbol $\sub$ throughout so that $f \sub t$ is denotes the substitution of term f into some term or type expression. To be more precise, if f is a term of type x, for some x, and if y is a type within a context which includes x, and if g is a term of type y, then $f\sub g$ is a term of type $f \sub y$. \\

\noindent Formally, this is expressed by a collection of rules. In the simplest cases we have:
\begin{equation}
\label{simpleintrosubintotype}
\ofT{x}{\typ}, \ofT{f}{\trm(x)}, \ofT{y}{\typ(x)}
\tstyle
\ofT{f \sub y}{\typ}
\end{equation}
\vspace{0cm}

\noindent and
\begin{equation}
\label{simpleintrosubintoterm}
\ofT{x}{\typ}, \ofT{f}{\trm(x)}, \ofT{y}{\typ(x)}, \ofT{g}{\trm(y)}
\tstyle
\ofT{f \sub g}{\trm(f \sub y)}
\end{equation}
\vspace{0cm}

\noindent Rules (\ref{simpleintrosubintotype}) and (\ref{simpleintrosubintoterm}) can be pictured like this:
\vspace{0.3cm}
\begin{displaymath}
\pstree[treemode=R,levelsep=*0.65cm,treesep=1cm,nodesep=0.05]
 {
    \Tr{\circ}
 }
 {
   \pstree [levelsep=*0.85cm]
	    {
			  \Tr{x} \uppermember {f}
			}
			{
			  \Tr{y} \uppermember {g}
			}
	 \Tr{f \sub y} \member {f \sub g}
 }
\end{displaymath}
\vspace{0.2cm}

\noindent More generally the rules for substitution are for $n \ge 0$ and $m \ge 0$:
\begin{multline}
\label{introsubintotype}
\typeseq{x}{n}, \ofT{x}{\typ(x_n)}, \ofT{f}{\trm(x)},
\typeseqcont{y}{x}{m}, 
 \ofT{y}{\typ(y_m)} \\
\tstyle
\ofT{f \sub y} {\typ(f \sub y_{m})}
\end{multline}


\noindent and
\begin{multline}
\label{introsubintoterm}
\typeseq{x}{n}, \ofT{x}{\typ(x_n)}, \ofT{f}{\trm(x)},
\typeseqcont{y}{x}{m}, \ofT{y}{\typ(y_m)},\\
\ofT{g}{\trm(y)} 
\tstyle
\ofT{f \sub g}{\trm(f \sub y)} 
\end{multline}

\newcommand{\contextof}[1]{
((\ref{#1}))
}

\noindent In rule \ref{introsubintoterm} all the context of rule \ref{introsubintotype}
is given and then some (variable $g$ is introduced). This is going to be a familiar pattern so we abbreviate by using double parentheses to reference an earlier context to be included. This enables us to represent rule   
\ref{introsubintoterm} as follows:

\begin{equation}
\contextof{introsubintotype}, \ofT{g}{\trm(y)} 
\tstyle
\ofT{f \sub g}{\trm(f \sub y)} 
\end{equation}

\vspace{0.5cm}
\noindent Rules (\ref{introsubintotype}) and (\ref{introsubintoterm}) can be pictured like this:

\begin{displaymath}
\vspace{0.5cm}
\pstree[treemode=R,levelsep=*0.5cm,treesep=1cm,nodesep=0.05]
 {
    \Tr{\circ}
 }
 {\flexbranch{Lxn}{1cm}{1cm}{x}{n}{}
    {\pstree
		   {\Tr{x}\uppermember{f}}
			 {
			 \flexbranchplusarc{Ly}{1cm}{1cm}{y}{m}{}{g}
			 }
		 \flexbranchplusarc{Lfy}{1cm}{1.3cm}{f \sub y}{m}{} {f \sub g}
		}
}
\end{displaymath}

\vspace{0.5cm}
\noindent Substitution is subject to the rule that when both sides are defined 
$(f \sub g)\sub(f \sub z) = f \sub (g \sub z)$. 

\noindent The axioms, stated generally, are that, for $n \geq 0$,
\begin{multline}
\label{doublesubtype}
\typeseq{x}{n},\ofT{x}{\typ{x_n}},\ofT{f}{\typ(x)}, \typeseqcont{y}{x_n}{m} , \ofT{y}{\typ{y_m}},\ofT{g}{\typ(y)},\\
\typeseqcont{z}{y_m}{l},\ofT{z}{\typ{z_l}}
\tstyle
(f \sub g) \sub (f \sub z) = f \sub (g \sub z)
\end{multline}

\noindent and
\begin{equation}
\label{doublesubterm}
\contextof{doublesubtype},\ofT{h}{\trm{z}}
\tstyle
(f \sub g) \sub (f \sub h) = f \sub (g \sub h)
\end{equation}
\vspace{0.1cm} 

\noindent The combination of axioms (\ref{doublesubtype}) and (\ref{doublesubterm})  can be pictured like this:

\begin{displaymath}
\vspace{0.5cm}
\pstree[treemode=R,levelsep=*0.75cm,treesep=1.5cm,nodesep=0.05]
 {
    \Tr{\circ}
 }
 { \flexbranch{Lxn}{1cm}{0.9cm}{x}{n}{}
    {\pstree[treesep=1.2cm, thislevelsep=1.0cm]
		   {\Tr{x}\uppermember{f}}
       {
         \flexbranch{Lym}{1cm}{1cm}{y}{m}{}
         {\pstree[thislevelsep=0.7cm]
		       {\Tr{y}\uppermember{g}}
			     {
			     \flexbranchplusarc{Lz}{1cm}{1cm}{z}{l} {} {h}
			     }
	  	     \flexbranchplusarc{Lgz}{1cm}{1cm}{g \sub z}{l}{} {g \sub h}
		     }
	    }
			\flexbranch{Lfy}{0.5cm}{1.5cm}{f \sub y} {m}{}
			{
			      \flexbranchplusarc{Lfgfz}{1cm}{2.3cm}{(f \sub g) \sub (f \sub z}{l}{)} 
						  {(f \sub g)\sub(f \sub h)}\nbput[labelsep=0.4cm]{\Rnode{LAB2}{}} 
		        \flexbranchplusarc{Lfgz}{1cm}{2.3cm}{f \sub (g \sub z}{l}{)} 
						  {(f \sub (g \sub h)}\ncput{\Rnode{LAB1}{}}
			}
			\equality{Lfgfz1}{Lfgz1}
			\equality{Lfgfz2}{Lfgz2}
			\equality{Lfgfz3}{Lfgz3}
			\equality{LAB1}{LAB2}
    }
}
\end{displaymath}

\vspace{0.5cm}

\subsection*{Weakening - The $\cross$ operators}
\noindent Introduction of context into a type or a term is represented by a family of operator symbols. In a completely formal presentation a second subscript is required but without ambiguity we can work with a notation with a family $\cross_{i_{)i \geq 0}}$. In the simplest case:

\begin{equation}
\ofT{x}{\typ}, \ofT{y}{\typ} 
\tstyle 
\ofT{x \cross_0 y}{\typ(x)}
 \\
\end{equation}
\vspace{0.3cm}
\noindent which we can picture like this:
\begin{displaymath}
\pstree[treemode=R,levelsep=*0.65cm,treesep=1cm,nodesep=0.1cm]
 {
    \Tr{\circ}
 }
 {
   \pstree[nodesep=0.1cm]
	    {
			  \Tr{x}
			}
			{
			  \Tr{x \cross_0 y}
			}
	\Tr{y}
 }
\end{displaymath}

\noindent and

\begin{equation}
\ofT{x}{\typ}, \ofT{y}{\typ}, \ofT{g}{\trm}
\tstyle 
\ofT{x \cross_0 g}{\trm(x \cross_0 y)}
 \\
\end{equation}
\noindent which we can picture like this:
\begin{displaymath}
\pstree[treemode=R,levelsep=*0.65cm,treesep=1cm]
 {
    \Tr{\circ}
 }
 {
   \pstree
	    {
			  \Tr{x}
			}
			{
			  \Tr{x \cross_0 y} \member{x \cross_0 g}
			}
	\Tr{y} \member{g}
 }
\end{displaymath}

\vspace {0.3cm}
 
\noindent The general rules for the introduction of the $\cross_i$ family of operators are as follows. For $n \geq 0$ and $m \geq 0$, type weakening is introduced by:
\begin{equation}
\label{introcrosstype}
\typeseq{x}{n}, \ofT{x}{\typ(x_n)}, \typeseqcont{y}{x}{m}, 
\ofT{y}{\typ(y_m)}
\tstyle 
\ofT{x \cross_n y_}{\typ(x \cross_n y_m)}
 \\
\end{equation}
\vspace{0.3cm}
\noindent which can be pictured so:

\begin{displaymath}
\pstree[treemode=R,levelsep=*0.5cm,treesep=1cm,nodesep=0.05]
 {
    \Tr{\circ}
 }
 {\flexbranch{Lxn}{1cm}{1cm}{x}{n}{}
    {\flexbranchplusleaf{Ly}{1cm}{0.9cm}{y}{m} {} 
		\pstree[levelsep=*0.5cm,nodesep=0.05]
		    {\Tr{x}}
		    {
	       \flexbranchplusleaf{Lxy}{1cm}{1.6cm}{x \cross_n y}{m}{}
	      }
		}
 }
\end{displaymath}

\vspace{0.3cm}
\noindent The weakening of a term, in general, is introduced by:

\begin{equation}
\contextof{introcrosstype},\ofT{g}{\trm(y)}
\tstyle 
\ofT{x \cross_n g}{\trm(x \cross_n y_{m})}
 \\
\end{equation}

\noindent which we picture like this:

\begin{displaymath}
\pstree[treemode=R,levelsep=*0.5cm,treesep=1cm,nodesep=0.05]
 {
   \Tr{\circ}
 }
 {\flexbranch{Lx}{0.9cm}{0.5cm}{x}{n}{}
   {
	  \flexbranchplusarc{Lym}{1cm}{1cm}{y}{m}{}{g}
	  \pstree[levelsep=*0.5cm,nodesep=0.05]
		{\Tr{x}}
		{
		  \flexbranchplusarc{Lxym}{1cm}{1.6cm}{x \cross_n y}{m}{}{x \cross_n g}
		}
	 }
 }
\end{displaymath}

\vspace{1cm}

\noindent In what follows, we will drop all indices to the $\cross$ symbol when there is no risk of ambiguity. Note that ambiguities can arise when the indices are omitted; we discuss these in a later section once were have completed this presentation of the theory. \\


\noindent Weakening is subject to the following axioms when applied to weakened types,
for $n \geq 0$, $m \geq 0$,:
\begin{multline}
\label{crossdistributiontyperule}
\typeseq{x}{n},\ofT{x}{\typ(x_n)},\typeseqcont{y}{x_n}{m},\ofT{y}{\typ(y_m)},\typeseqcont{z}{y_m}{l},\\
\ofT{z}{\typ(z_l)} 
\tstyle  (x \cross y) \cross (x \cross z) = x \cross (y \cross z)
\end{multline}

\noindent and the following when applied to weakened terms, for $n \geq 0$, $m \geq 0$,:

\begin{equation}
\label{crossdistributiontermrule}
\contextof{crossdistributiontyperule},\ofT{g}{\typ(z_l)}
\tstyle  (x \cross y) \cross (x \cross g) = x \cross (y \cross g)
\end{equation}
\vspace{0.2cm}

\noindent The combination of axioms (\ref{crossdistributiontyperule}) and 
(\ref{crossdistributiontermrule}) can be pictured like this:

\begin{displaymath}
\pstree[treemode=R,levelsep=*0.3cm,treesep=1cm,nodesep=0.05]
 {
    \Tr{\circ}
 }
 {
  \flexbranch{Lx}{0.9cm}{0.4cm}{x}{n}{}
    {
		 \flexbranch{Ly}{1.2cm}{1.3cm}{y}{m}{}
		   {
         \flexbranch{Lz}{1.0cm}{1cm}{z}{l}{}{\Tr{z}\member{g}}
				 \pstree[levelsep=*0.5cm]
				  {
					 \Tr{y}
				  }
					{
					 \flexbranch{Lyz}{1.0cm}{1.4cm}{y \cross z}{l}{}
					            {\Tr{y \cross z}\member{y \cross g}}
					}
			 }
		\pstree[levelsep=*0.75cm,nodesep=0.05]
		    {\Tr{x}}
		    {
	        \flexbranch{Lxy}{0.5cm}{1.0cm}{x \cross y}{m}{}
					{
					  \flexbranch{Lxz}{0.8cm}{1.4cm}{x \cross z}{l}{}
						      {\Tr{x \cross z}\member{x \cross g}}
					  \pstree[treesep=1.3cm,thislevelsep=1.2cm]
						{
						   \Tr{x \cross y}
						}
						{
						   \flexbranch{B}{1.0cm}{3.0cm}
							        {(x \cross y) \cross (x \cross z}{l}{)}
											{\Rnode{RHS}{\Tr{(x \cross y) \cross (x \cross z)}}
											\member{(x \cross y) \cross (x \cross g)}} 
											\nbput[labelsep=0.4cm]{\Rnode{LAB2}{}} 
						   \flexbranch{A}{1.0cm}{3.0cm}
							        {x \cross (y \cross z}{l}{)}
											{\Tr{\Rnode{LHS}{x \cross (y \cross z)}}
											\member{x \cross(y\cross g)}} 
											\ncput{\Rnode{LAB1}{}}	
							\equality{LAB1}{LAB2}
							\equality{RHS}{LHS}
							\equality{A1}{B1}
							\equality{A2}{B2}
						}
					}
	      }
		}
 }
\end{displaymath}
\vspace{0.3cm}

\subsection*{Axioms of Substitution and Weakening}

\noindent Two families of axioms govern behaviour of substitution into weakened types and terms. 

\noindent Firstly, for $n \geq 0, m\geq 0$,

\begin {multline}
\label{subintoweakenedtype}
\typeseq{x}{n},\ofT{x}{\typ{x_n}},\ofT{f}{\trm(x)}, \typeseqcont{y}{x_n}{m},\ofT{y}{\typ{y_m}} \\
\tstyle
f \sub (x \cross y) = y
\end {multline}

\noindent and \\

\begin{equation}
\label{subintoweakenedterm}
\contextof{subintoweakenedtype}, \ofT{g}{\trm(y)}
\tstyle
f \sub (x \cross g) = g
\end{equation}
\vspace{0.2cm}

\noindent The combination of axioms (\ref{subintoweakenedtype}) and 
(\ref{subintoweakenedterm}) can be pictured like this:

\begin{displaymath}
\pstree[treemode=R,levelsep=*0.5cm,treesep=1.3cm,nodesep=0.05]
 {
    \Tr{\circ}
 }
 {\flexbranch{Lxn}{1cm}{1cm}{x}{n}{}
    {
		\flexbranchplusarc{A}{1.5cm}{2.0cm}
	              {f \sub (x \cross y}{m}{)}
								{f \sub (x \cross g)} 
								\nbput[labelsep=0.4cm]{\Rnode{LAB1}{}}
		\flexbranchplusarc{B}{1.5cm}{2.0cm}{y}{m}{}{g} \ncput{\Rnode{LAB2}{}}
		\equality{A1}{B1}
		\equality{A2}{B2}
		\equality{A3}{B3}
		\equality{LAB1}{LAB2}
		\pstree[levelsep=*0.5cm,nodesep=0.05]
		   {\Tr{x}\member{f}} 
		   {
		   	 \flexbranchplusarc{C}{1.3cm}{1.85cm}{x \cross y}{m}{}{x \cross g}
		   }
		}
 }
\end{displaymath}
\vspace{0.3cm}

\noindent Secondly, $n \geq 0, m\geq 0, l \geq 0$:

\begin{multline}
\label{subintoweakenedtypetwo}
\typeseq{x}{n},\ofT{x}{\typ(x_n)},\ofT{f}{\trm(x)}, 
\typeseqcont{y}{x}{m} , \ofT{y}{\typ(y_m)}\\
\typeseqcont{z}{y_m}{l},\ofT{z}{\typ(z_l)}
\tstyle
f \sub y \cross f \sub z = f \sub (y \cross z)
\end{multline}

\noindent and

\begin{equation}
\label{subintoweakenedtermtwo}
\contextof{subintoweakenedtypetwo}, \ofT{g}{\trm(z)}
\tstyle
f \sub y \cross f \sub g = f \sub (y \cross g)
\end{equation}
\vspace{0.2cm}

\noindent The combination of axioms (\ref{subintoweakenedtypetwo}) and (\ref{subintoweakenedtermtwo}) can be pictured like this:

\begin{displaymath}
\pstree[treemode=R,levelsep=*0.3cm,treesep=1cm,nodesep=0.05]
 {
    \Tr{\circ}
 }
 {
  \flexbranch{Lx}{0.9cm}{0.6cm}{x}{n}{}
    {
		\pstree[levelsep=*0.5cm,nodesep=0.05]
		  {\Tr{x}\member{f}}
		  {
	 	   \flexbranch{Ly}{1.2cm}{1.1cm}{y}{m}{}
		   {
        \flexbranch{Lz}{0.5cm}{1cm}{z}{l}{}{\Tr{z}\member{g}}
  	    \pstree[thislevelsep=1.0cm]
		    {	
					\Tr{y}
			  }
				{
			    \flexbranch{Lyz}{0.9cm}{1.5cm}{y \cross z}{l}{}
					          {\Tr{y \cross z}\member{y \cross g}}
			  }
			 }
			}
	    \flexbranch{Lxy}{1.0cm}{1.0cm}{f \sub y}{m}{}
			{
				\flexbranch{Lfz}{0.8cm}{1.4cm}{f \sub z}{l}{}
						      {\Tr{f \sub z}\member{f \sub g}}
					  \pstree[treesep=1.3cm]
						{
						   \Tr{f \sub y}
						}
						{
						   \flexbranch{B}{1.0cm}{3.0cm}
							        {f \sub (y \cross z}{l}{)}
											{\Rnode{RHS}{\Tr{f \sub (y \cross z)}}
											\member{f \sub (y \cross g)}} 
											\nbput[labelsep=0.4cm]{\Rnode{LAB2}{}} 
						   \flexbranch{A}{1.0cm}{3.0cm}
							        {f \sub y \cross f \sub z}{l}{}
											{\Tr{\Rnode{LHS}{f \sub y \cross f \sub z}}
											\member{f \sub y \cross f \sub g}} 
											\ncput{\Rnode{LAB1}{}}	
							\equality{LAB1}{LAB2}
							\equality{RHS}{LHS}
							\equality{A1}{B1}
							\equality{A2}{B2}
						}
					}
		}
 }
\end{displaymath}
\vspace{0.5cm}

\noindent In addition there are axioms governing the substitution of weakened terms into weakened terms. 

\noindent For $n \geq 0, m\geq 0, l \geq 0$:
\begin{multline}
\label{subwideintype}
\typeseq{x}{n},\ofT{x}{\typ(x_n)},\typeseqcont{y}{x_n}{m} , \ofT{y}{\typ(y_m)},\ofT{g}{\trm(y)}\\
\typeseqcont{z}{y}{l}, \ofT{z}{\typ{z_l}}
\tstyle
(x\cross g) \sub (x \cross z) = x \cross (g \sub z)
\end{multline}

\noindent and \\
\begin{equation}
\label{subwideinterm}
\contextof{subwideintype},\ofT{h}{\typ(z)}
\tstyle
(x \cross g) \sub (x \cross h) = x \cross (g \sub h)
\end{equation}
\vspace{0.2cm}

\noindent Axioms (\ref{subwideintype}) and (\ref{subwideinterm}) 
can be  pictured like this: 

\begin{displaymath}
\pstree[treemode=R,levelsep=*0.3cm,treesep=1cm,nodesep=0.05]
 {
    \Tr{\circ}
 }
 {
  \flexbranch{Lx}{0.9cm}{0.4cm}{x}{n}{}
    {
		 \flexbranch{Ly}{1.2cm}{1.3cm}{y}{m}{}
		   {     
				 \pstree[levelsep=*0.5cm]
				  {
					 \Tr{y} \member{g}
				  }
					{
					 \flexbranch{Lz}{1.0cm}{1cm}{z}{l}{}{\Tr{z}\member{h}}
					}
					\flexbranch{Lgz}{1.0cm}{1.4cm}{g \sub z}{l}{}{\Tr{g \sub z}\member{g \sub h}}
			 }
		\pstree[levelsep=*0.5cm,nodesep=0.05]
		    {\Tr{x}}
		    {
	        \flexbranch{Lxy}{1.5cm}{2.0cm}{x \cross y}{m}{}
					{
					  \pstree[treesep=1.4cm,thislevelsep=1.5cm]
						{
						   \Tr{x \cross y} \uppermember{x \cross g}
						}
						{
						   \flexbranch{Lxz}{0.8cm}{1.4cm}{x \cross z}{l}{}
						           {\Tr{x \cross z}\member{x \cross h}}
						}
						\flexbranch{B}{1.0cm}{3.0cm}
							        {x \cross g \sub z}{l}{}
											{\Rnode{RHS}{\Tr{x \cross g \sub z}}
											\member{(x \cross g) \sub h}} 
											\nbput[labelsep=0.4cm]{\Rnode{LAB2}{}} 
						\flexbranch{A}{1.0cm}{3.0cm}
							        {(x \cross g) \sub (x \cross z}{l}{)}
											{\Tr{\Rnode{LHS}{(x \cross g) \sub  (x \cross z)}}
											\member{(x \cross g) \sub (x \cross h)}} 
											\ncput{\Rnode{LAB1}{}}	
							\equality{LAB1}{LAB2}
							\equality{RHS}{LHS}
							\equality{A1}{B1}
							\equality{A2}{B2}
					}
	      }
		}
 }
\end{displaymath}
\vspace{0.5cm}

\subsection*{Diagonal - The $\diag$ Operators}
\noindent The diagonal (x, in the context of x) is in the simplest case introduced by this rule:
\begin{equation}
\ofT{x}{\typ}
\tstyle
\ofT{\diag(x)}{x \cross x}
\end{equation}

\noindent which is pictured like this:
\vspace{0.1cm}
\begin{displaymath}
\pstree[treemode=R,levelsep=*0.65cm,treesep=1cm]
 {
    \Tr{\circ}
 }
 {
   \pstree [thislevelsep=1.2cm]
	    {
			  \Tr{x}
			}
			{
			  \Tr{x \cross x} \member{\diag{x}}
			}
 }
\end{displaymath}

\vspace{0.3cm}

\noindent More generally, for $n \geq 1$ :

\begin{equation}
\typeseq{x}{n}
\tstyle
\ofT{\diag(x_n)}{x_n \cross x_n}
\end{equation}

\noindent which is pictured like this:

\begin{displaymath}
\pstree[treemode=R,levelsep=*0.5cm,treesep=1cm,nodesep=0.05]
 {
    \Tr{\circ}
 }
 {\flexbranch{Lxn}{1.3cm}{1.5cm}{x}{n}{}
   {
	   \Tr{x_n \cross x_n} \member{\diag{x_n}}
	}
 }
\end{displaymath}
\vspace{0.3cm}

\noindent The diagonal $\diag$ is subject to four axiom schemes. \\

\noindent Firstly, axioms for substituting the diagonal into weakenings, for $n \geq 0$:

\begin{equation}
\label{diagsubweakeningtype}
\typeseq{x}{n},\ofT{x}{\typ(x_n)},\typeseqcont{y}{x}{m},\ofT{y}{\typ(y_m)}
\tstyle
\diag(x) * (x \cross y) = y
\end{equation}

\noindent and 

\begin{multline}
\label{diagsubweakeningterm}
\contextof{diagsubweakeningtype}, \ofT{g}{\typ(y)} \\
\tstyle
\diag(x) * (x \cross g) = g
\end{multline}

\noindent Axioms (\ref{diagsubweakeningtype}) and (\ref{diagsubweakeningterm}) 
can be pictured like this:

\begin{displaymath}
\pstree[treemode=R,levelsep=*0.5cm,treesep=1cm,nodesep=0.05]
 {
    \Tr{\circ}
 }
 {\flexbranch{Lxn}{1cm}{1cm}{x}{n}{}
   {		  
		\pstree[thislevelsep=2.0cm,nodesep=0.05]
		{\Tr{x}}
		{  
		   \flexbranchplusarc{Ly}{1cm}{2.0cm}{y}{m} {}{g}
			                      \nbput[labelsep=0.4cm]{\Rnode{LAB2}{}} 
		   \flexbranchplusarc{Ldeltaxy}{1cm}{2.0cm}
			           {\diag_x \sub (x \cross y}{m}{)}{\diag_x \sub (x \cross g)}
								            \ncput{\Rnode{LAB1}{}}
		   \pstree[thislevelsep=1.5cm,nodesep=0.05]
		   {\Tr{x \cross x}\member{\diag_x}}
		   {
	       \flexbranchplusarc{Lxy}{1.2cm}{1.8cm}{x \cross y}{m}{}{x \cross g}
	     }
			 \equality{Ly1}{Ldeltaxy1}
			 \equality{Ly2}{Ldeltaxy2}
			 \equality{Ly3}{Ldeltaxy3}
			 \equality{LAB1}{LAB2}
		}
	}
 }
\end{displaymath}
\vspace{0.5cm}


\noindent Secondly axioms for substituting into a diagonal

\begin{equation}
\label{fsubdelta}
\typeseq{x}{n}, \ofT{x}{\typ(x_n)},\ofT{f}{\trm(x)} 
\tstyle
f \sub \diag(x) = f
\end{equation}
\noindent which is pictured like this:\\
\begin{displaymath}
\pstree[treemode=R,levelsep=*0.5cm,treesep=1.5cm,nodesep=0.05]
 {
    \Tr{\circ}
 }
 {\flexbranch{Lxn}{1.3cm}{1.5cm}{x}{n}{}
  {
	  \pstree[thislevelsep=1.5cm,nodesep=0.05]
		{ 
		  \Tr{\Rnode{Lx}{x}}\member{f} 
			           \ncput{\Rnode{Lf}{}}
	  }
		{
	    \Tr{x \cross x} \member{\diag{x}}
		}
		\Tr{\Rnode{Lfxx}{f \sub (x \cross x)}} \member{f \sub \diag_x} 
		              \ncput[npos=0.6]{\Rnode{Lfd}{}}
	}
	\equality{Lx}{Lfxx}
	\equalityarc{Lfd}{Lf}
 }
\end{displaymath}
\vspace{0.3cm}
\noindent and 

\begin{multline}
\label{deltasubf}
\typeseq{x}{n}, \ofT{x}{\typ(x_n)},\ofT{f}{\trm(x)},\typeseqcont{y}{x}{m}, 
\ofT{y}{\typ(y_m)} \\
\tstyle
f \sub \diag(y) = \diag(f \sub y)
\end{multline}
\noindent Axiom \ref{deltasubf} 
can be pictured like this:

\begin{displaymath}
\pstree[treemode=R,levelsep=*0.5cm,treesep=1.5cm,nodesep=0.05]
 {
    \Tr{\circ}
 }
 {\flexbranch{Lxn}{1cm}{1cm}{x}{n}{}
   {		  
		\pstree[thislevelsep=1.0cm,nodesep=0.05]
		{\Tr{x}\member{f}}
		{  
		   \flexbranch{Ly}{1cm}{1.4cm}{y}{m} {}
       {
			   \pstree[thislevelsep=1.5cm,nodesep=0.05]
		     {\Tr{y}}
				 {
						\Tr{y \cross y}\member{\diag_{y}}
				 }
			 }
		}
		\flexbranch{Lfy}{1.2cm}{2.2cm}{f \sub y}{m}{}
	 	{  
		   \Rnode{L1}{\Tr{f \sub y \cross f \sub y} \member{\diag_{f\sub y}}}
			                  \ncput[npos=0.33]{\Rnode{M1}{}}
		   \Tr{\Rnode{xxx}{y \cross y}} \member{f \sub \diag_{y}}
			                  \ncput[npos=0.5]{\Rnode{M2}{}}
		}
		\equality{L1}{xxx}
		\equalityarc{M2}{M1}
	}
 }
\end{displaymath}

\vspace{0.3cm}
\noindent This completes the definition of the generalised algebraic theory $MetaGAT$.

\section{The Theory of Contextual Categories}

\subsection*{Sorts}
The generalised algebraic theory of contextual categories has two families of sort symbols representing, respectively,  objects and morphisms. \\

\noindent The family of sort symbols representing 
objects $\Ob_{i)_{i\geq 1}}$ 


introduced by 
rules as follows: 
\begin{align*}
&\isT{\Ob_1} \\
&\ofT{x_1}{\Ob_1} \tstyle \isT{\Ob_2(x_1)} \\
& \vdots \\
&\context{x}{\Ob}{i} \tstyle \isT{\Ob_{i+1}(x_1, ..x_{i})} \\
\end{align*}
\noindent We can drop the subscripts from $\Ob$ and omit the inessential variables so that we express as:

\begin{equation}
\ofT{x_1}{\Ob},.. \ofT{x_{n}}{\Ob(x_{n-1})} \tstyle \isT{\Ob(x_{n})} \\
\end{equation}
\vspace{0cm}

\noindent The family of sorts representing morphisms
$\Hom_{i,j)_{i\geq 1,j\geq1}}$. 
When x is an object at level i, and y is an object at level j then $\Hom_{i,j}(x,y)$ represents morphisms from $x$ to $y$. 
formally, each sort symbol $\Hom_{i,j}$ is introduced by:

\begin{equation}
\label{sortintroterm}
\objseq{x}{n}, \objseq{y}{m},
\tstyle \isT{\Hom_{n,m}(x_n,y_m)}
 \\
\end{equation}
\noindent Composition of morphisms is represented by a family of operators $\circ_{i,j,l}$ introduced by:

\begin{multline}
\label{compositionintro}
\objseq{x}{{n_1}}, \objseq{y}{{n_2}},\objseq{z}{{n_3}}, \\
\ofT{f}{\Hom_{{n_1},{n_2}}(x_{n_1},y_{n_2})}, \ofT{g}{\Hom_{{n_2},{n_3}}(y_{n_2},z_{n_3})}
\tstyle \ofT{f \circ_{{n_1},{n_2},{n_3}} g} {\Hom_{{n_1},{n_3}}(x_{n_1},z_{n_3})}
\end{multline}

\noindent Identity axioms:
\begin{multline}
\label{leftidentity}
\objseq{x}{{n_1}}, \objseq{y}{{n_2}}, \\
\ofT{f}{\Hom_{{n_1},{n_2}}(x_{n_1},y_{n_2})}
\tstyle \ofT{id_{n_1}(x_{n_1}) \circ_{{n_1},{n_1},{n_2}} f 
                = f 
								}
                {\Hom_{{n_1},{n_2}}(x_{n_1},y_{n_2})}
\end{multline}
\noindent and
\begin{multline}
\label{rightidentity}
\objseq{x}{{n_1}}, \objseq{y}{{n_2}}, \\
\ofT{f}{\Hom_{{n_1},{n_2}}(x_{n_1},y_{n_2})}
\tstyle \ofT{f \circ_{{n_1},{n_2},{n_2}} id_{n_2}(y_{n_2}) 
                = f 
								}
                {\Hom_{{n_1},{n_2}}(x_{n_1},y_{n_2})}
\end{multline}

\noindent Associativity is given by:
\begin{multline}
\label{associativity}
\objseq{w}{{n_1}},\objseq{x}{{n_2}}, \\
\objseq{y}{{n_3}},\objseq{z}{{n_4}}, \\
\ofT{f}{\Hom_{{n_1},{n_2}}(w_{n_1},x_{n_2})}, 
\ofT{g}{\Hom_{{n_2},{n_3}}(x_{n_2},y_{n_3})}, 
\ofT{h}{\Hom_{{n_3},{n_4}}(y_{n_3},z_{n_4})} \\
\tstyle \ofT{(f \circ_{{n_1},{n_2},{n_3}} g) \circ_{n_1,n_3,n_4} h 
                 = f \circ_{{n_1},{n_2},{n_4}} ( g \circ_{n_2,n_3,n_4} h )
								} {\Hom_{{n_1},{n_4}}(w_{n_1},z_{n_4})}
\end{multline}

\noindent p introductory rule
\noindent 
\begin{equation}
\objseq{x}{n}, \ofT{x_{n+1}}{Ob_{n+1}(x_n)} 
\tstyle \ofT{p_{n+1}(x_{n+1})}{Hom_{n+1,n}(x_{n+1},x_n)}
\end{equation}

\noindent Pullback of objects:
\begin{multline}
\objseq{x}{{n_1}}, \objseq{y}{{n_2}}, \\
\ofT{f}{\Hom_{{n_1},{n_2}}(x_{n_1},y_{n_2})},
\ofT{y_{{n_2}+1}}{Ob_{{n_2}+1}(y_{n_2})} 
\tstyle \ofT{f*y_{{n_2}+1}}{Ob_{n_1+1}(x_{n_1})}
\end{multline}

\section{Relating Contextual Categories and $MetaGAT$ algebras}
\subsection{Constructing a Contextual Category from a $MetaGAT$ algebra}
\label{concatconstruction}
\noindent From a $MetaGAT$ algebra $\mathcal{A}$ we can construct a corresponding contextual category whose sections are the terms of the $MetaGAT$ algebra. The tree of objects of the contextual category is the tree of types of the $MetaGAT$ algebra\footnote{A root to the tree is required and therefore formally appended as this is not explicit as a type in $MetaGAT$.}. 
The morphisms $Hom(A,B)$ where $1 \base A_1 ... A_n \base A$ and $1 \base B1... \base B_m \base B$ are m-tuples $f_1,...f_m, f$ of terms of $\mathcal{A}$ which are typed as shown in the following diagram:
\vspace{0.2cm}
\begin{displaymath}
\pstree[treemode=U,levelsep=*1cm,treesep=6cm,nodesep=0.05]
 {
    \Tr{\circ}
 }
 {\flexbranch{Lxn}{1cm}{1cm}{x}{n}{}
     { \pstree[treemode=U,levelsep=*2cm,treesep=1.5cm,nodesep=0.05,edge=\thinedge]
		   {\Tr{x}}
			 {
			   \flexbranchinitialarc{Lxym}{1.7cm}{1cm}{x \cross y}{m}{}{\Tr{x \cross y}}{1}{\upperaccutemember{f_1}}
			 	 \flexbranchinitialarc{Lxym}{1.3cm}{1cm}{f_1 \sub (x \cross y}{m}{)}{\Tr{f_1 \sub (x \cross y)}}{2}
				                                       {\upperaccutemember{f_2}}
				 %\flexbranchinitialarc{Lxym}{0.9cm}{1cm}{f_2 \sub f_1 \sub (x \cross y}{m}{)}{\Tr{f_2 \sub f_1 \sub (x \cross y)}}{3}
				 %                                      {\upperaccutemember{f_3}}
				 \Tr[edge=\noedge]{\hdots}
				 \pstree[treemode=U,levelsep=*1cm,treesep=1.5cm,nodesep=0.05]
				         {\Tr{x \cross y_m}\loweraccutemember{f_m}}{\Tr{f_{m-1} \sub ...  f_2 \sub f_1 \sub (x \cross y)}}				 
				 \Tr{f_{m} \sub ...  f_2 \sub f_1 \sub (x \cross y)}
			 }
		 }		  
	\flexbranch{Lym}{1cm}{1cm}{y}{m}{}{\Tr{y}}	
 }
\end{displaymath}


\subsection {Interpreting the Theory of Contextual Categories in $MetaGat$}
\noindent Vladimir Voevodsky in this C-systems paper shows how the theory of contextual categories can be expressed as a generalised algebraic theory.
\noindent The construction outlined in section \ref{concatconstruction} can be expressed as an interpretation of the generalised algebraic theory of contextual categories into the $MetaGAT$ theory enriched by existential types and the absolute. Absolute is required for the interpretation of the terminal object of the contextual category. Existential types over terms are required so that the morphism sort (Hom) of the contextual category can be interpreted as follows.
In the context:
\begin{equation}
\ofT{x_1}{Ob_1},...\ofT{x_n}{Ob_n(x_{n-1})},\ofT{x}{Ob_{n+1}(x_n)},\ofT{y_1}{Ob_1},...\ofT{y_m}{Ob_{m}(y_{m-1})},\ofT{y}{Ob_{m+1}(y_m)}
\end{equation}

\noindent the type $Hom(x,y)$ is interpreted by:

\begin{equation}
\sum_{\ofT{f_1}{\trm(x \cross y_1)}}
\sum_{\ofT{f_2}{\trm(f_1 \sub (x \cross y_2))}}
%\sum_{\ofT{f_3}{\trm(f_2 \sub ( f_1 \sub ( x \cross y_3)))}}
\hdots
\sum_{\ofT{f_m}{\trm(f_{m-1} \sub (f_{m-2}\sub...(f_1 \sub (x \cross y_m))...))}}
\trm(f_{m} \sub (f_{m-1} \sub ...(f_1 \sub (x \cross y))...))
\end{equation}

\subsection {Interpreting $MetaGat$ in the Theory of Contextual Categories}
\noindent If the theory of contextual categories is enriched by identity and existential types over the $Hom$ types then the construction of a $MetaGAT$ algebra from the sections of the contextual category can expressed as an interpretation of the theory $MetaGAT$ in the enriched theory of contextual categories. The key to the interpretation is that terms of $MetaGAT$ are interpreted as sections of the contextual category and this
can be expressed as a type in the enriched theory as follows.
\noindent In the context
\begin{displaymath}
\ofT{x_1}{Ob_1},...\ofT{x_n}{Ob_n(x_{n-1})},\ofT{x}{Ob_{n+1}(x_n)}
\end{displaymath}

\noindent $Sections(x)$ is the type
\begin{displaymath}
\sum_{\ofT{f}{Hom(x_n,x)}}Id(f \comp p(x),id_{x_n})
\end{displaymath}

\bibliography{../SharedBibliography/temp/bibliography}

\end{document}
