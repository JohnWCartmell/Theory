


\section{Restriction Categories (\cite{COCKETT2002})}

For the theory of data, 
the notion of \textit{range category} that we are interested in 
is defined in terms of the slightly simpler notion of a 
\textit{restriction category}. These were introduced by 
Cockett \& Lack (\cite{COCKETT2002}) and 
constitute an algebra that nicely represents a system of partially defined terms or maps. Applied to the theory of data, they are relevant because data fields often only optionally have values and can be considered therefore to be partial, rather than total, functional relationships. 

Cockett \& Lack define restriction categories along the following lines:
\begin{definition}
A \textit{restriction category} is a category \catcw with an additional operator on morphisms (the restriction operator $\bar{\ }$), so that from a morphism
$f: a \morph b$ in \catcw there is a 
$$\bar{f}: a \morph a$$,
satisfying

R.1 For $f:a \morph b$ in \catcw $$\bar{f} \circ f =f$$.

R.2. If \fgsourcediag in \catcw then
$$\bar{g} \circ \bar{f}=\bar{f} \circ \bar{g}.$$

R.3. If \fgsourcediag in \catcw then
$$\overline{\bar{f} \circ g} = \bar{f} \circ \bar{g}$$.

R.4. If $\sequentialdiag{a}{b}{c}{f}{g}$ in \catcw then
$$f \circ \bar{g} = \overline{f \circ g} \circ f$$.
\end{definition}

Some properties of the restriction operator that follow from this definition are as follows:
\begin{lemma}
\llabel{restrictioncatlemma}
In any restriction category \catc
\begin{enumerate} [(i)]
\item For $f:a \morph b$ in \catcw,
$$\bar{\bar{f}}=\bar{f}$$
\item If $\sequentialdiag{a}{b}{c}{f}{g}$ in \catcw 
 then
$$\overline{f \circ g} = \overline{f \circ \bar{g}}.$$
\item If $\sequentialdiag{a}{b}{c}{k}{j}$ in \catcw 
and $k$ is total i.e. $\bar{k}=id_a$
and if $k \circ \bar{j}$ is total i.e. $\overline{k \circ \bar{j}}=id_a$
then
$$k \circ \bar{j} = k.$$

\end{enumerate}
\end{lemma}
\begin{proof}
\begin{enumerate} [(i)]
\item Use R3 with $g$ being $id_b$.
\item 
\begin{align*}
\overline{f \circ \bar{g}}
&= \overline{\overline{f \circ g} \circ f}
    && \text{by (R4),} \\
&= \overline{f \circ g} \circ \bar{f}
    && \text{by (R3),} \\
&= \bar{f} \circ \overline{f \circ g}
    && \text{by (R2),} \\
  &= \overline{\bar{f} \circ f \circ g}
    && \text{by (R3),} \\  
&= \overline{f \circ g}
    && \text{by (R1).}
\end{align*}
\item 
\begin{align*}
k \circ \bar{j} &= k \circ \bar{\bar{j}}              && \mbox{from (i),}\\
                &= \overline{k \circ \bar{j}} \circ k && \mbox{by R.4,}   \\
                &= k                                  && \mbox{from assumption $k \circ \bar{j}$ is total.}
\end{align*}

\end{enumerate}
\end{proof}

{ %begin RHomFunctorSubLemma
\newcommand{\EqOnelhs}{k \circ \overline{j_1 \circ j_2}}
\newcommand{\EqOnerhs}{k}
\newcommand{\EqOne}{\EqOnelhs=\EqOnerhs}
\newcommand{\EqTwoBlhs}{k \circ \overline{j_1}}
\newcommand{\EqTwoBrhs}{k}
\newcommand{\EqTwoB}{\EqTwoAlhs = \EqTwoArhs}
\newcommand{\EqTwoAlhs}{k \circ j_1 \circ \overline{j_2}}
\newcommand{\EqTwoArhs}{k \circ j_1}
\newcommand{\EqTwoA}{\EqTwoBlhs= \EqTwoBrhs}
\begin{lemma}
\llabel{RHomFunctorSubLemma}
If $\triplesequentialdiag{a}{x_1}{x_2}{x_3}{k}{j_1}{j_2}$ 
in \catcw  then $\EqOne$ 
            iff $\EqTwoA$ and $\EqTwoB$.
\end{lemma}
\begin{proof}

First make the initial assumption that $\EqOne$, we can show the first identity, $\EqTwoA$, as follows
\begin{align*}
\EqTwoAlhs & = k \circ \overline{j_1 \circ \bar{j_2}} \circ j_1
                                         &&\mbox{ by R.4,} \\
           & = k \circ \overline{j_1 \circ j_2} \circ j_1 &&\mbox{ by lemma \ref{restrictioncatlemma} (ii),} \\
           & = \EqTwoArhs &&\mbox{ from the initial assumption.}       
\end{align*}
and we can show the second identity, $\EqTwoB$, as follows
\begin{align*}
\EqTwoBlhs & = \overline{k \circ j_1} \circ k &&\mbox{ by R.4,} \\
           & = \overline{k \circ j_1 \circ \overline{j_2}} \circ k
                       &&\mbox{ by using the first identity} \\
           & = k \circ \overline{j_1 \circ \overline{j_2}} 
                       &&\mbox{ by R.4} \\
           & = k \circ \overline{j_1 \circ j_2} 
                       &&\mbox{ by lemma \ref{restrictioncatlemma} (ii),} \\
           & = \EqTwoBrhs 
                        &&\mbox{ from the initial assumption. }    
\end{align*}

Now assume the two identities  $\EqTwoA$ and $\EqTwoB$, 
we can show that then $\EqOne$, as follows   
 \begin{align*}
\EqOnelhs & = \overline{k \circ j_1 \circ j_2}  
                   &&\mbox{ by R.3,} \\
           & = \overline{k \circ j_1 \circ \bar{j_2}} 
                       &&\mbox{ by lemma \ref{restrictioncatlemma} (ii), } \\
           & =  \overline{k \circ j_1}
                       &&\mbox{ by use of the second identity,} \\
           & = \EqOnerhs 
                        &&\mbox{ by use of the first identity. }    
\end{align*}
\end{proof}

} %end RHomFunctorSubLemma




\subsection{Partial Ordering of $Hom(A,B)$}

In a restriction category we can define a partial ordering on each hom set
Hom(a,b) by defining :
$$f \leq g \mbox{ iff } f = \bar{g} \circ f.$$

We can think of $f \leq g$ as meaning that if $f$ is defined then $g$ is defined and the two are equal.

\begin{lemma}
\llabel{leqlemma}
If 
$
\paralleldiag{a}{b}{f}{f'}
$
and
$
\paralleldiag{b}{c}{g}{g'}
$
in \catcw and if $f' \leq f$ and $g' \leq g$ 
then $f' \circ g' \leq f \circ g$.
\end{lemma}

\begin{lemma}
\llabel{pointwiseleqlemma}
If 
$
\paralleldiag{a}{b}{f}{f'}
$
and
$
\paralleldiag{b}{c}{g}{g'}
$
and $h: a \morph c$ in \catcw 
and if $f' \leq f$ and $g' \leq g$ 
and if $h \leq f \circ g'$ and $h \leq f' \circ g$ 
then $h \leq f' \circ g'$.
\end{lemma}
\begin{proof}
Proof is handwritten on tablet.
\end{proof}


\section{Range Categories \cite{COCKETT2012}}

Cockett et al. (\cite{COCKETT2012}) define range categories from restriction categories along the following lines.

\begin{definition} 
A \term{range category} is a restriction category with an additional operator on morphisms (the range operator $\hat{\ }$), as follows
if $f: a \morph b$ in  \catcw then
$$\hat{f}: b \morph b$$
satisfying

RR.1 For $f:a \morph b$ in \catcw $$\bar{\hat{f}} = \hat{f}.$$

RR.2 For $f:a \morph b$ in \catcw $$f \circ \hat{f} = f.$$

RR.3. If $\sequentialdiag{a}{b}{c}{f}{g}$ in \catcw then
$$\reallywidehat{f \circ \bar{g}} = \hat{f} \circ \bar{g}.$$

RR.4. If $\sequentialdiag{a}{b}{c}{f}{g}$ in \catcw then
$$\reallywidehat{(\widehat{f} \circ g)} = \widehat{f \circ g}.$$
\end{definition}

In this note we explore range categories that satisfy an  additional condition defined by Cockett et al. as RR.5. We will use the folowing terminology:

\begin{definition}
An \textit{RR.5 range category} is a range category that additionally satisfies:

RR.5 if $\equaliser{a}{f}{\paralleldiag{b}{c}{g}{h}}$ then
 $$f \circ g = f \circ h \Rightarrow  \hat{f} \circ g = \hat{f} \circ h.$$
 \end{definition}

Let the category \FinPar be the range category of finite sets and partial functions.

\begin{lemma}
\llabel{unirangelemma}
If $f:a \morph a$ in a range category \catcw then for any morphism 
$f: a \morph b$
\begin{enumerate}[(i)] 
\item $\hat{\hat{f}}=\hat{f}$,
\item $\hat{f} \comp \hat{f} = \hat{f}$,
\item $\hat{\bar{f}}=\bar{f}$.
\end{enumerate}
\end{lemma}
\begin{proof}
Straightforward.
\end{proof}

\begin{lemma}
\llabel{fglemma}
 \begin{enumerate}[(i)]
 \item 
 If \fgsinkdiag in \catcw then
 $\hat{f}\circ \hat{g} = \hat{g} \circ \hat{f},$
 \item
w.R4.\footnote{This condition described as a weaken verison of R.4 and referred to as wR.4 in Cockett et al.} If $\sequentialdiag{a}{b}{c}{f}{g}$ in \catcw  then
$\hat{g} \circ \reallywidehat{f \circ g}=  \reallywidehat{f \circ g}.$
 \item \commentary{wrong diagram }
If \fgsinkdiag in \catcw  then
$\reallywidehat{f \circ \widehat{g}}=\widehat{f} \circ \widehat{g}.$


\end{enumerate}
\end{lemma}
\begin{proof}
\begin{enumerate}[(i)]
\item Follows from RR.1 and R.2.
\item 
\begin{align*}
\hat{g} \circ \widehat{f \circ g}&=\widehat{f \circ g} \circ \hat{g}&&\mbox{by (i)} \\
&=\widehat{f \circ g} \circ \bar{\hat{g}}&&\mbox{by lemma \ref{unirangelemma} (iii),} \\
&= \reallywidehat{f \circ g \circ \bar{\hat{g}}}&&\mbox{by RR.3,} \\
&= \widehat{f \circ g} &&\mbox{by lemma \ref{unirangelemma} (iii), then RR.2.}
\end{align*}
\item %(iii)
\begin{align*}
\widehat{f \circ \widehat{g}} 
                                &=\widehat{f \circ \overline {\widehat{g}}} &\mbox{by RR.1}\\
                                &=\widehat{f} \circ \overline {\widehat{g}} &\mbox{by RR.3}\\
                                &=\widehat{f} \circ \widehat{g}             & \mbox{by RR.1}\\
\end{align*}
\end{enumerate}
\end{proof}

\subsection {What isnt true}
\commentary{Document this because I would like it to be true but it isnt.}
If \catcw is a range category and if
 \fgsourcediag in any range category in \catcw then we can probably prove that
 $$\overline{g} \circ f \leq f \circ \reallywidehat{\overline{g} \circ f}.$$

It is not the case however, we cannot  prove that 
$$\overline{g} \circ f = f \circ \reallywidehat{\overline{g} \circ f}$$
for in the range category of partial sets and functions suppose
$a$ is a doubleton set ${x_1,x_2}$ 
and that $f$ is defined at both $x_1$ and $x_2$ and that $f(x_1) = f(x_2)=y$.
Suppose $g$ is defined at $x_1$ but not at $x2$. Then
\begin{align*}
x_1 &\xmapsto{f} y \\
x_2 &\mapsto y \\
             \\
x_1 &\xmapsto{\overline{g}\kern0.05cm} x_1 \\
x_2 &\xmapsto{\kern0.2cm} \bot \\
                \\
x_1 &\xmapsto{\overline{g} \circ f} y \\
x_2 &\xmapsto{\kern0.4cm} \bot
\end{align*}

so that $\reallywidehat{\overline{g} \circ f}=\set{y}$  
and

\begin{align*}
x_1 &\xmapsto{f \circ \reallywidehat{\overline{g} \circ f}} y \\
x_2 &\xmapsto {\kern.75cm}y
\end{align*}



and we see that $$\overline{g} \circ f \neq f \circ \reallywidehat{\overline{g} \circ f}.$$




