 \documentclass[10pt,a4paper]{article}
%\input{thepreamble.tex}
\newcommand{\sharedmacros}{../../SharedMacros}
\input{\sharedmacros/ccategories.macros}
\input{\sharedmacros/ermacros}
\input{\sharedmacros/erdiagram}
\input{\sharedmacros/theorems.macros}
\input{\sharedmacros/general.macros}
\input{\sharedmacros/diagram.macros}
\usepackage{mathptmx}  % This changes font to roman
\usepackage{anyfontsize}
\usepackage{mathtools}  % why have we got this?
\usepackage{alltt}    
\usepackage{mnsymbol} %used for rightpitchfork
\usepackage{cmll}
%\usepackage{yhmath}  % used for better version of \widehat
\usepackage{ulem}
\renewcommand{\ttdefault}{txtt}
\usepackage[left=1.5cm, right=4cm, marginparwidth=3cm, top=2cm, bottom=2.0cm]{geometry}
\usepackage{framed}
\usepackage[font=small]{caption}
\setlength{\captionmargin}{2cm}


\theoremstyle{remark}
\newtheorem*{lemma*}{Lemma}


\renewcommand{\term}[1]{\textit{#1}}  %SIMPLE UNINDEXED VERSION

%ENDCOPY

\begin{document}
\title{Range Categories and the Theory of Data}

% abstract here for ams

\author{John Cartmell}

\date{}

\maketitle

\begin{center}
DRAFTING December 2023
\end{center}

\newcommand{\fgsourcediag}{$\binarysourcediag{a}{b}{c}{f}{g}$}

\input{rangeCategories}

\section{MToD Definitions}

\begin{definition}
If $\catc$ is a category and $\reqtc$ is a set of instances and if \fgsourcediag
in $\catc$ then there is a  \term{functional dependency} of $g$ on $f$ with respect to $\reqtc$ iff
there is a family of functions $H_D)_{D \in \reqtc}$ such that 
in each instance $D$, $H_D$ is a unique function $H_D: D(b) \morph D(c)$, such that $D(f) \circ H_D = D(g)$ and $\overline{H_D}=\widehat{D(f)}$.
If there is such a functional dependency then we say that $\fundep{H}{f}{g}$ in $\catc$ with respect to $\reqtc$.
\end{definition}

\begin{lemma}
\label{fdrangesublemma}
If $\fundep{H}{f}{g}$ is a functional dependency then
$$\widehat{H_D}=\widehat{D(g)}.$$
\end{lemma}
\begin{proof}
\begin{align*}
\widehat{D(g)} &= \widehat{D(f) \circ H_D} \\
               &= \widehat{hat({D{f})} \circ H_D} &&\mbox{by RR.4}\\               
               &= \widehat{\overline{H_D} \circ H_D} &&\mbox{by defn of functional dependency}\\
               &= \widehat{ H_D} &&\mbox{by R.1}\\
\end{align*}
\end{proof}

\begin{definition}
\commentary{
I considered adding to this definition  the requirement that $\bar{h}=\hat{f}$.
Then it will follow that in each instance $D(h)=H_D$. 
This isn't a matter of substance -- either way will be equivalent. What turns it for me is that the $h$ as I have it may well be closer to the sketch i.e. what is stored in the data.
}
If $\catc$ is a range category and $\reqtc$ is a set of instances, if
\fgsourcediag
in $\catc$ 
and if there is a functional dependency $\fundep{H}{f}{g}$ then say that 
the functional dependency $H$ is \term{represented} in $\catc$ 
iff there exists a morphism $h:b \morph c$ in $\catc$ such that 
\oldt{for each instance $D \in \reqtc$, $D(h)=H_D$}
$f \circ h = g$. Note that we can deduce that if $h$ is such a representation then
in each instance $D$, $\widehat{D(f)} \circ D(h) = H_D$.
\end{definition}

\input{fd_representation_lemma}

\bibliographystyle{alpha} 
\bibliography{../SharedBibliography/temp/bibliography}
\end{document}
