

\begin{frame}{Data Specification and Instance}
A \textit{data specification} is a sketch $S$ for a \datacat \catc.
\\
\medskip
An \textit{instance} of a data specification $S$ is a functor $D: \catc(S) \morph \Par$,
where $\catc(S)$ is the \datacat generated by $S$.
\end{frame}

\begin{frame}{The Requirement}
A \textit{requirement} for a data specification $S$ 
is a set of instances of the sketch $S$ or, equivalently, is a set $R_C$ of functors where for each
$D \in R_C$, $D: \catc(S) \morph \Par$, where $\catc(S)$ is the \datacat generated by the sketch $S$.
\end{frame}

\begin{frame}{Fundamental Principles of Data Specification}
\IfSforCwithRCwordsvariant 
\begin{itemize}
\item 
\textbf {Principle 1 :} No redundancy. The sketch $S$ ought to be a minimum sketch for structured category \catcw i.e. there should be no subsketch of $S$ which generates  \catc.
\item
\textbf {Principle 2:} \catcw ought to be \textit{maximally constrained} to $\reqtc$.
\end{itemize}
\end{frame}



\begin{frame}{Key definition: \catcw \textit{maximally constrained} to $\reqtc$}
\begin{itemize}


\item  question -- is there a $\catcp$ that extends \catcw and that will do a better job. 

\item Is there a $\catcp$ and an $I: \catc \morph \catcp$  such that 
all instances in the requirement $\reqtc$ uniquely factor though $I$
$$
\begin{array} {c p{2cm} c}
\Rnode{Cp}{C'} && \\ [0.25cm]
             && \Rnode{finset}{\Fin} \\ [0.15cm]
\Rnode{C}{C}  
\end{array}
\begin{arrows}
\ncarr {C}{finset}
\alabel{D}
\ncarr{C}{Cp}
\alabel{I}
\ncarr{Cp}{finset}
\alabel{D'} 
\end{arrows}
$$
\pause  and at least one other instance $F$ of \catcw does not factor through $I$.
\ncarr[-20]{C}{finset}
\blabel{F} 
\end{itemize}
\pause If there is no such $I: \catc \morph \catcp$ then we shall say that 
\catcw is \textit{maximally constrained} with respect to $\reqtc$.\\
\medskip
 ...meaning  that structured category \catcw  is the tightest possible fit to facts i.e. to the requirement $R_{\catc}$.
\end{frame}

\begin{frame}{Representational Completeness}
Alternative way of approaching tightest fit:
\begin{itemize}
\item That which is in the data and can be represented in the theory should be represented in the theory.
\item To make precise we can give definitions
 of \textit{representational completeness} wrt $\reqtc$ 
\begin{center}
\begin{tabular}{>{\bfseries}l l} 
2A. & equationally complete   \\
2B. & functionally complete   \\
2C. & referentially complete  \\
2D. & mono complete           \\
2E. & epi complete            \\
2F. & product complete        \\
\end{tabular}
\end{center}
\pause \item In these defintions that \catcw is $x$ complete wrt $\reqtc$ will mean exactly that the set of instances $\reqtc$ are jointly reflective of $x$.
\end{itemize}
\end{frame}


\begin{frame}{BCNF in the abstract (based on Zaniolo 1982 Definition 2)}
If $S$ is a sketch for a \rangeplus category $C$ with designated mono-sources with inverses   and designated finite restriction products
and $S$ is considered as a data specification with requirement $\reqtc$, then it ought to be the case
that if 
\scalebox{0.9}{\multisourcenplusonediagram{n}{a}{b}{x}{c}{y}}
are edges of $S$
and if \msfd{x_1,...x_n}{y}  is a non-trivial functional dependency  between these edges
then \onslide<1>{...}
\onslide<2>{\scalebox{0.8}{\multisourcediagram{n}{a}{b}{x}} is a designated mono-source.}
\end{frame}



\begin{frame}{Equational Completeness and Goodness Criteria 2A}
\pause \begin{definition}
If $\catc$ is a  structured category and $\reqtc$ is a set of instances,
 then say that  $\catc$ is \textit{equationally complete} with respect 
to the requirement $\reqtc$ iff all path equivalences with respect to $R_C$ are represented in \catcw 
i.e. iff for all diagrams \fgparalleldiagram in $\catc$,  
if in all instances $D \in \reqtc$, $D(f)=D(g)$,  then $f=g$.
\end{definition}
\medskip
\pause In other words:
the set of functors $\reqtc$ is jointly faithful. \\
\medskip
\pause \goodnesscriteria{2A} \IfSforCwithRCwords then \catcw ought to be equationally complete
with respect to $R_C$.
\end{frame}

\begin{frame}{Equational completeness cont. }
Does equational completeness follow from maximal constrainedness?
Scein's theorem for range categories implied that it does.
\begin{lemma}[Path Equivalence Representation Lemma]
If $\catc$ is a locally finite category and $\reqtc$ is a set of instances, if $\catc$ 
 is
\textit{maximally constrained} to the requirement $\reqtc$ then it is equationally
complete with respect to $\reqtc$.
\end{lemma}
\begin{proof}
Suppose \fgparalleldiagram  in $\catc$ and that in all instances $D \in \reqtc$, $D(f)=D(g)$. 
Define $\catcp$ to be \catc plus $f=g$. Consider the functor given by Schein's theorem.
This is an instance of $\catc$ which therefore extends to an instance $H$ of $\catcp$.  Then
$Hom_{\catc}(a,f)=H(I(f))=H(I(g))=Hom(a,g)$ and applying to $id_a$ we have that $f=g$.
????????????????????????
\end{proof}
\end{frame}


\begin{frame}{Functional Dependencies}
To describe Goodness Criteria 2B I first need to
\begin{itemize}
\item Define what we mean by \textit{functional dependency}
-- abstracted and simplified from definition given by Codd 1971.
\item Define what we mean by a functional dependency being \textit{represented}
-- inspired by language found in Zaniolo 1982.
\item State as the criteria that all functional dependencies ought to be represented -- 
the spirit of Zaniolo's paper. 
\end{itemize}
\end{frame}

\begin{frame}{Definition of Functional Dependency}
\begin{definition}
If $\catc$ is a range category and $\reqtc$ is a set of instances and if \fgsourcediag
in $\catc$ then there is a  \textit{functional dependency} of $g$ on $f$ with respect to $\reqtc$ iff
there is a family of functions $H_D)_{D \in \reqtc}$ such that 
in each instance $D$, $H_D$ is a unique function $H_D: D(b) \morph D(c)$, such that $D(f) \circ H_D = D(g)$ and $\overline{H_D}=\widehat{D(f)}$.
\end{definition}
\pause If $H$ is such a functional dependency then we say that $\fundep{H}{f}{g}$ in $\catc$ with respect to $\reqtc$.
\end{frame}

\begin{frame}{Definition of Functional Dependency (2)}
\begin{definition}
If $\catc$ is a range category with finite products and if $\reqtc$ is a set of instances 
of \catcw then if 
\scalebox{0.9}{\multisourcenplusonediagram{n}{a}{b}{f}{c}{g}}
in \catcw then say that $g$ is functionally dependent of $f_1,...f_n$
iff $g$ is functionally dependent on $\fntuple$.
\end{definition}
\pause If $H$ is such a functional dependency then we say that $\fundep{H}{f}{g}$ in $\catc$ with respect to $\reqtc$. 

This notation is adapted  from relational database theory. It doesn't imply a 2-category structure.
\end{frame}


\begin{frame}{Definition of Representation of Functional Dependency}
\begin{definition}
If $\catc$ is a range category and $\reqtc$ is a set of instances, if
\fgsourcediag
in $\catc$ 
and if there is a functional dependency $\fundep{H}{f}{g}$ then say that 
the functional dependency $H$ is \textit{represented} in $\catc$ 
iff there exists a morphism $h:b \morph c$ in $\catc$ such that 
\oldt{for each instance $D \in \reqtc$, $D(h)=H_D$}
$f \circ h = g$. Note that we can deduce that if $h$ is such a representation then
in each instance $D$, $\widehat{D(f)} \circ D(h) = H_D$.
\end{definition}
\medskip
\pause If \catcw is a requirement and $\reqtc$ a set of instances then \catcw is said to be 
\textit{functionally complete} with respect to $\reqtc$ iff every functional dependency
present in $\reqtc$ is represented in \catc.\\
\medskip
\pause \goodnesscriteria{2B}\IfSforCwithRCwords then \catcw ought to be functionally complete with respect to $\reqtc$.
\end{frame}


\begin{frame}{Representation Lemma for Functional Dependencies}
\begin{lemma}
If $\catc$ is a \datacat category and $\reqtc$ is a set of instances, if $\catc$ is 
\textit{maximally constrained} to the requirement $\reqtc$ then 
\catcw is functionally complete with respect to $\reqtc$.
\end{lemma}
\begin{proof}
Suppose$\fundep{H}{f}{g}$  is a functional dependency with respect to $\reqtc$.
Hence in all instances $D \in \reqtc$, $D(f)$ is surjective.

Extend \catcw to $\catcp$ by formally adding a morphism $\qq{h}$ such that $f \circ \qq{h}=g$. Extend each $D$ to a $D'$ by defining $D(h)=H_D$. 

Define a functor from \catcw to $\Fin$ as  a certain quotient of the coproduct of functor $HomP_{\catc}(a,-)$ with itself. 
Extend to $\catcp$ and demonstrate that there exists $k:b \morph c$ in \catcw such that $f \circ k=g$. 
which shows that $\fundep{H}{f}{g}$ is represented in $\catc$.
\end{proof}
\end{frame}



\newcommand{\incdsetup}{$
\begin{array}{c p{0.5cm} c p{0.5cm} c}
             &&\Rnode{bi}{b_i} &&              \\[0.5cm]
\Rnode{a}{a} &&                && \Rnode{c}{c}
\end{array}
\begin{arrows}
\ncarr{a}{bi}\alabel{f_i}
\ncarr{c}{bi}\blabel{q_i}
\end{arrows}
$}

\newcommand{\incdresolution}{$
\begin{array}{c p{0.5cm} c p{0.5cm} c}
             &&\Rnode{bi}{D(b_i)} &&              \\[0.5cm]
\Rnode{a}{D(a)} &&                && \Rnode{c}{D(c)}
\end{array}
\begin{arrows}
\ncarr{a}{bi}\alabel{D(f_i)}
\ncarr{c}{bi}\blabel{D(q_i)}
\ncarr{a}{c}\blabel{J_D}
\end{arrows}
$}



\begin{frame}{Definition of Inclusion Dependencies}
If $\catc$ is a category and $\reqtc$ is a set of instances 
and if
\incdsetup
in $\catc$, for $i$, $1 \leq i \leq n$, then an \textit{inclusion dependency} $J$, written $a[f_1,...f_n] \overset{J}{\subseteq} c[q_1,..q_n]$, is a family of functions $J_D)_{D \in \reqtc}$
such that each instance $D \in \reqtc$, $J_D$ is a function 
 such that
 \incdresolution commutes, for $i$, $1 \leq i \leq n$. \\

\medskip
\begin{itemize}
\item If each $J_D$ is the unique such function then the inclusion dependency is said to be referential. 
\end{itemize}
\end{frame}

\begin{frame}{Definition of Referentially Complete}
\begin{definition}
If $\catc$ is a category and $\reqtc$ is a set of instances and if
\fnsourceqnsource
in $\catc$ and if $a[f_1,...f_n] \overset{J}{\subseteq} c[q_1,..q_n]$ is a referential inclusion dependency
with respect  to $\reqtc$ then say that the inclusion dependency $J$ is \textit{represented} in $\catc$
iff there exists a morphism $j:a \morph c$ in $\catc$ such that in each instance $D \in \reqtc$, $D(j) = J_D$. 
\end{definition}
If \catcw is a category and $\reqtc$ a set of instances then 
\catcw is \textit{referentially complete} with respect to $\reqtc$ 
iff all referential inclusion dependencies present in $\reqtc$ are represented in \catc.
\end{frame}

\begin{frame}{Goodness Criteria 2C}
\goodnesscriteria{2C} \IfSforCwithRCwords 
then \catcw ought to be referentially complete with respect to $\reqtc$.
\end{frame}

\begin{frame}{Representation Lemma for Referential Inclusion Dependencies}
If \catcw is a locally finite category and $\reqtc$ is a set of instances, if \catcw is 
\textit{maximally constrained} to the requirement $\reqtc$ then
every referential inclusion dependency with respect to $\reqtc$ is represented in $\catc$.
\end{frame}

\begin{frame}{Proof}
Suppose $a[f_1,...f_n] \overset{J}{\subseteq} c[q_1,..q_n]$ is a referential inclusion dependency
where for each $i$, $1 \leq i \leq n$,
\scalebox{0.9}{\incdsetup} in \catc.

Extend category \catcw to a category \catcpw such that in \catcpw there is
a morphism $\qq{r}: a \morph c$ such that for each $i$, $1 \leq i \leq n$, 
$\qq{r} \circ q_i = f_i$.
Every $D \in \reqtc$ extends uniquely to functor $D: \catcp \morph \Fin$. Therefore, since \catcw is maximally constrained then every functor $F: \catc \morph \Fin$ can be extended to $F':\catcp \morph \Fin$. \\
\pause Let $H: \catcp \morph \Fin$ be the extension of the hom functor $Hom(a,-): \catc \morph \Fin$ to 
\catcp. \\
\pause For each $i$, we have $H(\qq{r}) \circ H(q_i) = H(f_i)$, \\
\pause \hspace {3cm} i.e. $H(\qq{r}) \circ Hom(a,q_i) = Hom(a,f_i)$. \\
\pause Therefore in particular $H(\qq{r})(id_a) \circ q_i =  f_i$. \\
\pause Hence $H(\qq{r})(id_a):a \morph c$ in \catcw represents the inclusion dependency $J$.

\highlight{Why? Do we know that $H(c)=Hom(a,c)$?} How do we know this?
I guess in the category case because $I \circ H = Hom$? \highlight{Does this still go through?}
\end{frame}

\begin{frame}{Three Goodness Criteria}{for Categories as Data Specifications}
Definition of Goodness Criteria 2A, 2B and 2C:
\begin{itemize}
\item If \catcw is a category and $\reqtc$ is a set of instances of \catcw then
\medskip
\begin{tabular}{>{\bfseries}l l} 
2A: & \catcw ought to be equationally complete wrt $\reqtc$  \\
2B: & \catcw ought to be  functionally complete wrt $\reqtc$  \\
2C: & \catcw ought to be referentially complete wrt $\reqtc$ \\
\end{tabular}
\pause \item We have shown that if \catcw is locally finite and meets Criteria 2 that it is maximally constrained then it also meets Criteria 2A, 2B and 2C.

\pause \item We will move on to consider categories with designated monomorphisms and epimorphisms
\item First though we will describe a possible improvement to this situation described above.
\end{itemize}
\end{frame}

