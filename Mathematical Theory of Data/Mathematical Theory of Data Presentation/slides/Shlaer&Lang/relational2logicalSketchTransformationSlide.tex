
\renewcommand{\studentDepartmentAttribute}[1]             {\onslide<1-5>{#1}}
\newcommand{\popupInitialInclusionDependencies}[1]        {\only<1-4>{#1}}
\renewcommand{\studentDepartmentAttributeStrikeout}[1]    {\onslide<5>{#1}}
\newcommand{\popupMarkedUpInitialInclusionDependencies}[1]{\only<5>{#1}}
\newcommand{\popupAbstractionOfd}[1]                      {\only   <2-5>{#1}} %was 6
\newcommand{\popupAbstractionOfdDetail}[1]                {\onslide<3-5>{#1}} %was 6
\newcommand{\studentDepartmentRelationship}[1]            {\onslide<4->{#1}}
\newcommand{\popupFirstRewrittenInclusionDependencies}    {\only   <6-9>}

\renewcommand{\professorDepartmentAttribute}[1]           {\onslide<1-10>{#1}}
\newcommand{\reprofessorDepartmentAttributeStrikeout}[1]  {\onslide<10>{#1}}
\newcommand{\popupMarkedUpFirstRewrittenInclusionDependencies}[1]
                                                        {\only   <10>{#1}}
\newcommand{\popupAbstractionOfdPrime}[1]               {\only   <7-10>{#1}}
\newcommand{\popupAbstractionOfdPrimeDetail}[1]         {\onslide<8-11>{#1}}
\newcommand{\professorDepartmentRelationship}[1]        {\onslide<9->{#1}}
\newcommand{\professorDepartmentRelationshipBar}[1]     {\onslide<11->{#1}}

\newcommand{\popupSecondRewrittenInclusionDependencies} {\only  <11-16>}
\newcommand{\restudentProfessorAttribute}[1]            {\onslide<1-15>{#1}}
\newcommand{\restudentProfessorAttributeStrikeout}[1]   {\onslide<15>{#1}}
\newcommand{\popupAbstractionOfs}[1]                    {\only   <12-16>{#1}}
\newcommand{\popupAbstractionOfsDetail}[1]              {\onslide<13-16>{#1}}
\newcommand{\studentProfessorRelationship}[1]           {\onslide<14->{#1}}

\newcommand{\popupThirdRewrittenInclusionDependencies}  {\only  <17-20>}
\renewcommand{\departmentProfessorAttribute}[1]         {\onslide<1-20>{#1}}
\renewcommand{\departmentProfessorAttributeStrikeout}[1]{\onslide<20>{#1}}
\newcommand{\popupAbstractionOfhd}[1]                   {\only   <18-20>{#1}}
\newcommand{\popupAbstractionOfhdDetail}[1]             {\onslide<19-20>{#1}}
\newcommand{\departmentProfessorRelationship}[1]        {\onslide<19-20>{#1}}


\newcommand{\abstractionOfd}
{
Remove $sDept$ and replace by an edge $d: student \morph department$.
Rewrite appearances of $sDept$ in the sketch by $d \circ dName$.
}

\newcommand{\abstractionOfdPrime}
{
Remove $pDept$ and replace ny an edge $d': professor \morph department$.
%$\composeSevenShaped[0.85cm]{professor}{department}{v}{d'}{name}{dept}$ commutes. 
Rewrite appearances of $pDept$ in the sketch by $d' \comp dName$.
}

\newcommand{\abstractionOfs}
{
Remove $sSv$ and replace by an edge  $s: student \morph professor$.
Rewrite appearances of $sSv$ in the sketch by $s \comp pNo$.
Add commutative diagram
$\composeSevenShaped[0.85cm]{student}{professor}{v} {s}{d' \circ dName}{d \circ dName}$ 
 simplify to
$\composeSevenShaped[0.85cm]{student}{professor}{department}{s}{d'}{d }$
Keep $\composeSevenShaped[0.85cm]{student}{professor}{v}{s}{no}{svr}$ commute
pending rethink.
}

\newcommand{\abstractionOfhd}
{
Replace $dHd$ by an edge  $h: department \morph professor$,
add commutivity of
$\composeSevenShaped[0.85cm]{department}{professor}{v}{h}{d' \circ dName}{dName}$
 simplfy to
$\composeSevenShaped[0.85cm]{department}{professor}{department}{h}{d'}{id}$
.
Keep $\composeSevenShaped[0.85cm]{department}{professor}{v}{h}{no}{h}$.
}

\newcommand{\circledStudentSupervisorInclusionDependency}
{
{student[\psovalbox[linecolor=red, boxsep=false]{sDept},sSv] \subseteq professor[pDept,pNo]}
}

\newcommand{\rewrittenStudentSupervisorInclusionDependency}
{
{student[d \circ dName,sSv] \subseteq professor[pDept,pNo]}
}

\newcommand{\circledRewrittenStudentSupervisorInclusionDependency}
{
{student[d \circ dName,sSv] 
   \subseteq professor[\psovalbox[linecolor=red, boxsep=false]{pDept},pNo]}
}
\newcommand{\circledHeadOfDeptIncD}
{department[dName,dHd]  
   \subseteq professor[\psovalbox[linecolor=red, boxsep=false]{pDept},pNo]}

\newcommand{\secondRewrittenStudentSupervisorInclusionDependency}
{
{student[d \circ dName,sSv] 
   \subseteq professor[d \circ dName,pNo]}
}
\newcommand{\secondRewrittenHeadOfDeptIncD}
{department[dName,dHd]  
   \subseteq professor[d' \circ dName,pNo]}


\newcommand{\initialInclusionDependencies}
{
\begin{itemize}
\item $\studentDeptInclusionDependency$
\item $\professorDeptInclusionDependency$
\item $\studentSupervisorInclusionDependency$
\item $\headOfDeptInclusionDependency$
\end{itemize}
}

\newcommand{\strikeout}[1]{\colorbox{red}{\sout{#1}}}
\newcommand{\initialMarkedUpInclusionDependencies}
{
\begin{itemize}
\item \st{$\studentDeptInclusionDependency$}
\item $\professorDeptInclusionDependency$
\item $\circledStudentSupervisorInclusionDependency$
\item $\headOfDeptInclusionDependency$
\end{itemize}
}
             
\newcommand{\firstRewrittenInclusionDependencies}
{
\begin{itemize}
\item $\professorDeptInclusionDependency$
\item $\rewrittenStudentSupervisorInclusionDependency$
\item $\headOfDeptInclusionDependency$
\end{itemize}
}

\newcommand{\markedUpFirstRewrittenInclusionDependencies}
{
\begin{itemize}
\item \st{$\professorDeptInclusionDependency$}
\item $\circledRewrittenStudentSupervisorInclusionDependency$
\item $\circledHeadOfDeptIncD$
\end{itemize}
}
\newcommand{\secondRewrittenInclusionDependencies}
{
\begin{itemize}
\item $\secondRewrittenStudentSupervisorInclusionDependency$
\item $\secondRewrittenHeadOfDeptIncD$
\end{itemize}
}

\newcommand{\thirdRewrittenInclusionDependencies}
{
\begin{itemize}
\item $\secondRewrittenHeadOfDeptIncD$ % sic
\end{itemize}
}


\newcommand{\abstractionToSketch}
{
\popupInitialInclusionDependencies{\initialInclusionDependencies}
\popupMarkedUpInitialInclusionDependencies{\initialMarkedUpInclusionDependencies}
\popupFirstRewrittenInclusionDependencies{\firstRewrittenInclusionDependencies}
\popupMarkedUpFirstRewrittenInclusionDependencies
                                    {\markedUpFirstRewrittenInclusionDependencies}
\popupSecondRewrittenInclusionDependencies{\secondRewrittenInclusionDependencies}
\popupThirdRewrittenInclusionDependencies{\thirdRewrittenInclusionDependencies}

\popupAbstractionOfd{                    
\begin{block}{Step 1. Eliminate $\studentDeptInclusionDependency$}
\popupAbstractionOfdDetail{\abstractionOfd}
\end{block}
}

\popupAbstractionOfdPrime{
\begin{block}{Step 2. Eliminate $\professorDeptInclusionDependency$}
\popupAbstractionOfdPrimeDetail{\abstractionOfdPrime}
\end{block}
}
\popupAbstractionOfs{
\begin{block}{Step 3. Eliminate $\secondRewrittenStudentSupervisorInclusionDependency$}
\popupAbstractionOfsDetail{\abstractionOfs}
\end{block}
}
\popupAbstractionOfhd{
\begin{block}{Step 4. Eliminate this final inclusion dependency.}
\popupAbstractionOfhdDetail{\abstractionOfhd}
\end{block}
}
}


\begin{frame}{Transform Relational Sketch to Logical Sketch}
\vspace{0.9cm}
\professorStudentDepartmentRelationalSchematic
$\begin{arrows}
\studentDepartmentRelationship{
  \ncarr[20]{student}{department}
  \alabel{d}[0.4]
}
\studentProfessorRelationship{
  \ncarr[5]{student}{professor}
  \alabel{s}[0.4]
}
\professorDepartmentRelationship{
  \ncarr[5]{professor}{department}
  \alabel{d'}[0.4]
  \professorDepartmentRelationshipBar{\addedgebar}
}
\departmentProfessorRelationship{
  \ncarr[5]{department}{professor}
  \alabel{h}[0.4]
}\end{arrows}
$

\begin{overlayarea}{11cm}{7cm}

\abstractionToSketch
\onslide<20>{END}%need to force slide 20 to appear without hd attribute ??
\end{overlayarea}

\end{frame}

