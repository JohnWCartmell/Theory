\documentclass[xcolor=pst,dvips]{beamer}   %, handout

\usepackage{mathptmx}
\usepackage{amsfonts}
\usepackage{wasysym}
\usepackage{url}
\usepackage{hyperref}

%\input{../SharedMacros/theorems.macros}
\newtheorem{proposition}[theorem]{Proposition}

\input{../SharedMacros/ccategories.macros}
\input{../SharedMacros/gats.macros}
\input{../SharedMacros/metagat.macros}
\input{../SharedMacros/ermacros}
\input{../SharedMacros/erdiagram}    %beamer aware version
\input{../SharedMacros/indexedsets.macros}
\renewcommand{\erpictureFolder}[0]{../SharedPictures}

\usetheme{Szeged}
\usecolortheme{dolphin}

%\setbeamertemplate{navigation symbols}{}

\setcounter{equation}{0}


\title[Types in practice and in theory]{Data Specifications, Categories, Theories\\ -- Types in practice and in theory}
%% Which is to say types as they are used in practice in software development and as represented in theory in categories and in syntactic type theories.
%% There is also a subplot concerning representation of context which certain types depend on -- again represented in practice and in theory. 
\author{John Cartmell}
\institute{Otium}
\date{Jan 25, 2019}
\bibliographystyle{plainnat}
\begin{document}

\newcommand{\attr}[1]{#1}
\renewcommand{\attr}[1]{\psframebox[linecolor=red,framearc=.1]{#1}}
\newcommand{\attrtype}[1]{#1}
\renewcommand{\attrtype}[1]{\psframebox[linecolor=blue,framearc=.1]{#1}}
\newcommand{\etype}[1]{#1}
\renewcommand{\etype}[1]{\psframebox[linecolor=red,framearc=.1]{#1}}

\newcommand{\CEsymboltype}[0]{varchar(2)}
\newcommand{\CEatomicnumbertype}{number(1,1000)}
\newcommand{\CEfloattype}{float}
\newcommand{\CEnametype}{varchar(64)}
\newcommand{\CEvalencynumbertype}{number(-7,7)}

\begin{frame}{Definitions - Johnstone et al.}
\begin{definition}{Johnstone et al}
An \textit{EA sketch} is a sketch $\tuple{G,D,L,C}$ where $G$ is a directed graph, $D$ a set of diagrams in $G$, $L$ a set of finite cones and
$C$ a set of finite discrete cocones.
\end{definition}


If $S$ is an EA-sketch then the theory of $S$ is the lextensive category generated by $S$.

If $S$ is an EA sketch then a model of $S$ is a functor to the category of finite sets preserving finite limits and coproducts.
The category of models is denoted $Mod(S,\cat{FinSet})$.
\end{frame}

\begin{frame}{Data Specification of the Chemical Elements as a Directed Graph}
\scalebox{0.65}{
\input{chemicalElementGraph}
} 
\end{frame}

\begin{frame}{Relational Database Theory}
\begin{itemize}
\item classic relational database normal form definitions ({\scriptsize 3NF, EKNF, BCNF, 4NF,5NF, INC-NF}) can be transfered into the more general framework
of ER modelling and formalised within the definitional framework of EA sketches

\item such normal forms  examine the fit of a sketch/theory (database schema) to an intended usage

\item we can assume that the intended usage is represented by a full-subcategory of the category $Mod(S,\cat{FinSet})$

\item in such a situation the classic normal forms address the question can the sketch/theory $S$ be improved by addition or removal of morphisms and/or commutative diagrams and/or limit cones.
\item normalisation has dual goal of obtaining as complete a theory as possible and of eliminating redundancy from the sketch.  
\end{itemize}
\end{frame}

\begin{frame}{Normal Forms}
\begin{itemize}
\item IN-NF -- Ling and Goh -- there are no redundant attributes except if absolutely necessary in order to specify a mono source
\end{itemize}
\end{frame}

\begin{frame}{Defining Candidate Keys and/or Identifying Relationships in an EA sketch.  }
\begin{itemize}
\item concept of \textit{candidate keys} used in relational database normal form definitions {\scriptsize (3NF, EKNF, BCNF)}
\item in ER model talk about \textit{identifying} families of relationships
\item in category theory such a key or a family of relationships is a mono source i.e. a to jointly monic family of morphisms
\item mono sources and hence candidate keys can be defined as limit cones
\item more than 99.99 percent of entity modelling uses just mono sources and no other limits
\end{itemize}
\end{frame}


\begin{frame}{Mono Source Definition}
\begin{definition}
In a category \cat{C}, a family of morphisms with common domain: \\
\begin{center}
\scalebox{0.65}{
\input{monoSource}
} 
\end{center}
is said to be a \textit{mono source} iff for all $g,h:X \morph A$ in \cat{C} if $g \circ f_i = h \circ f_i$, for each $i, 1 \leq i \leq n$, then $g=h$.
\end{definition}
\end{frame}

\begin{frame}{Mono Source Limit Cone}
Lemma: In a category \cat{C}
\scalebox{0.65}{
\input{monoSource}
} is a mono source iff \\
\begin{center}
\scalebox{0.65}{
\input{monoSourceLimitCone}
} 
is a limit cone.
\end{center}
\end{frame}


\begin{frame}{Each entity type has at least on mono source defined}
\begin{tabular}{l}
\scalebox{0.60}{
\input{chemicalElementElementSymbolMonoSource}
} \\ [0.6cm]
\scalebox{0.65}{
\input{chemicalElementElementAtomicNumberMonoSource}
} \\ [0.6cm]
\scalebox{0.65}{
\input{chemicalElementAllotropeMonoSource}
} \\ [0.6cm]
\scalebox{0.65}{
\input{chemicalElementIsotopeMonoSource}
} \\ [1.1cm]
\scalebox{0.65}{
\input{chemicalElementValencyMonoSource}
} 
\end{tabular}
\end{frame}

\begin{frame}{Composing mono sources}
\begin{itemize}
\item{
In the category there are two further \textit{derived}  mono sources: \\
\vspace{0.5cm}
\begin{tabular}{l}
\scalebox{0.65}{
\input{chemicalElementIsotopeKey}
} \\ [1.0cm]
\scalebox{0.65}{
\input{chemicalElementValencyKey}
} 
\end{tabular}
}
\end{itemize}
\end{frame}

\begin{frame}{Therefore every entity type has at least one candidate key}
\begin{tabular}{l}
\scalebox{0.60}{
\input{chemicalElementElementSymbolMonoSource}
} \\ [0.7cm]
\scalebox{0.65}{
\input{chemicalElementElementAtomicNumberMonoSource}
} \\ [0.7cm]
\scalebox{0.65}{
\input{chemicalElementAllotropeMonoSource}
} \\ [0.7cm]
\scalebox{0.65}{
\input{chemicalElementIsotopeKey}
} \\ [1.1cm]
\scalebox{0.65}{
\input{chemicalElementValencyKey}
} 
\end{tabular}
\end{frame}

\begin{frame}{Normalisation}
\begin{definition}
{ \footnotesize
If $T$ is a theory and $W \subset |Mod(T,FinSet)|$ is an intended usage then an interpretation (theory morphism) $I: T \morph T'$ is an improvement of $T$ wrt $W$ iff 
$Mod(I,Finset): Mod(U',Finset) \morph Mod(U,Finset)$ is injective but not surjective
and $W \subseteq img(Mod(I,Finset))$.
i.e. for all models $U \in W$ there exists $U' \in Mod(T,Finset)$ such that $I \circ U'=U$
$
\begin{array} {c p{2cm} c}
\Rnode{T}{T} && \\ [0.25cm]
             && \Rnode{finset}{Finset} \\ [0.25cm]
\Rnode{Tp}{T'}  
\end{array}
$
\ncarr {T}{finset}
\alabel{U}
\ncarr{T}{Tp}
\blabel{I}
\ncarr{Tp}{finset}
\blabel{U'} 
}
\end{definition}

\begin{definition}
If a theory $T$ has no improvement wrt to an intended usage $W$ then $T$ is said to be \textit{optimally formulated} wrt $W$.
\end{definition}
\end{frame}

\begin{frame}
\begin{proposition}
If a relational schema $R$ can be normalised to $R'$ then the associated theory $T$ of $R$ can be improved to the associated thery $T'$ of $R'$.
\end{proposition}
\begin{proposition}
If a relational database schema is in normal form then its associated theory is optimally formulated.
\end{proposition}
\end{frame} 

\end{document}