

\section{Entity Models}

\mynote The word `entity' as it is used in this book is used in its most general sense,  the sense in which it just means `thing'. The entities that are being modelled in entity modelling can be just about any 'things' at all --- and so we could just as well speak of `modelling things' as `entity modelling' but that the term entity modelling
has come to mean a particular way of modelling things in which things are described by describing their types just in terms of the binary relationships that things of the type may participate in.

\mynote There is a proviso to this. 
Things that are known from the beginning and unchanging from one context to another, things that can be said to be `universal' are excluded from being subjects of our modelling. We do not model, therefore, whole numbers, nor real numbers, nor truth values (the things known to programmers as booleans) but take these as universal givens and, generally, we do not model language characters and language character sequences (the things known to computer programmers as strings) with the richness that this would require -- we take these too to be universal and given. 

\mynote In philosophy the non-universal things that are our entities are referred to as particulars and so we can say that the entity types within an entity model represent types of particular things i.e. those types whose every instance is a particular.  

\mynote Now I am able to explain that, in entity modelling, the term attribute is adopted as a specific term meaning a relationship between a particular on the one hand and a universal on the other. Likewise, the term relationship 
in its primary use, in entity modelling, is reserved specifically for relationships between particulars i.e. between entities. 

\mynote Having explained this much we can now say that an entity model posits a collection of entity types, relationships and attributes. These are the E, the R, and the A of entity modelling.
Each entity model can be thought of as a structured document having definitions of such  types, relationships and attributes just as a dictionary or glossary has entries giving definitions of (certain) nouns, verbs, adjectives as well as other parts of speech. Like an architect's design, or an electrician's circuit, much of an entity model can be usefully represented on one or more diagrams. The diagrams are often known as entity-relationship (ER) diagrams or sometimes as  entity-relationship-attribute (ERA) diagrams. 
These diagrams in one or other of the available styles are the visible and recognisable face of entity modelling. They originate with the diagrams of Chen from his 1976 paper which, most significantly, has the title 
"The Entity-Relationship Model---Toward a Unified View of Data". His style of diagrams are recognisable by their use of diamond shaped boxes to represent relationships. In this book our diagrams are more structured. They use Barker-Ellis style diagrams and, as we come to shortly, these are recognisable by their use of optionally half dashed lines to represent relationships and their optional use of crowsfeet on the ends of these lines to represent multiplicity. 

\mynote Though entity modelling may be about just about any thing it is never about modelling everything.
An entity model serves to describe a domain of discourse. In the general case it describes the entities in this domain in relation not just to each other but to other given types which are types which  represent that which is universal. 

\mynote
Now a very  important point ---
\textit{any entity model describes the structure of a single composite thing which all the individual things that it describes are part of}. Now it is not usual to speak of entity models in this way which is why I draw attention to this and if you are already familiar with entity modelling you may find this controversial. Bear with me.
\mynote
Like other things this composite thing is described by defining the type of thing that it is. This composite is usually in the background in entity modelling but in our entity models and in our diagrams we bring it to the foreground and represent it as special type on the diagram representing the whole of everything. As we come to later and for good reason we like to call this whole of everything \textit{the absolute}. \commentary{fine tune this discussion}  This composite thing  is the subject of an entity model and it can be a small thing such as a single molecular structure so that the whole of everything consists of atoms and covalent bonds or the state of a game of chess so that the whole of everything is the positions of pieces on the board. It could be the parse tree of a single grammatical sentence so that the individual entities are parts of speech and their relationships with each other. It could be a company such as a manufacturing company and all its suppliers, customers, employees, departments, projects and premises. 
It could be an online business and all of its products, customers and sales or
a science company and all of its laboratories, equipment, samples, analytic instruments, assignations, data records and  scientific reports. 
\mynote
Describing a composite thing we are led to its parts. Often we find that these parts are composites and themselves have parts. The result is a hierarchy of things. Many of the structured entity models described in this book describe such hierarchies. 

\section{Relationships}
\mynote
A defining feature of entity modelling is the description
 (the modelling) of the relationships that can possible  exist between things according as to the types of things that they are. 
\mynote 
We need to say something about this term `relationship' as it is used in
entity modelling.
As a starting point consider these two definitions that I found online. 

\begin{erquote}
a relationship between two things is the way in which they are connected
\end{erquote}
and 
\begin{erquote}
a relationship is a connection, association, or involvement between two things.
\end{erquote}

At first reading these two dictionary entries seem to be in accord and indeed 
they both describe what would more specifically be called \textit{binary relationships} involving as they do exactly two things in relationship with each other.
A more careful reading reveals a significant difference between the two because \textit{friendship} as an abstraction satisfies the first definition but not the second whereas a particular friendship such as that between \textit{Don Quixote} and \textit{Sancho Panza} satisfies the second  but not the first. 
To distinguish the two meanings some authors use the term \textit{relationship type} for the first sense and reserve the term \textit{relationship} itself for the second. Here we will stick with the single word relationship, which, for us, can therefore have two distinct meanings. If we need to emphasise the second meaning we may speak of instances of relationships. When speaking in this way we might say that their is a relationship called `friendship' between people and that there is an instance of this relationship between \textit{Don Quixote} and \textit{Sancho Panza}.

\mynote
Just for the record, in another dictionary we find 
\begin{erquote}
In logic and mathematics relationship is another name for relation.
\end{erquote}
and in yet another there is a definition of mathematical relation as a subset of the cartesian product of two sets 
(evidently, therefore, a definition of a binary relation)\footnote{Chambers definition here}\footnote{Need to say more here because this latter definition is a relation in a model of logic not in logic itself}. 

\mynote
Friendship,  marriage, adjacency, ownership and succession are all examples of binary relationships. There are binary relationships too  between parent and child, between teacher and student and between a planet and the star that it orbits.   
The following are also binary relationships:
being employed by, in the sense that a person might be employed by a particular employee,
managing, in the sense that an employee might manage a project. 
There are binary relationships between a sales order and the customer making the order and between a debit card and  the bank that issues the card. As a final example, a banking transaction has binary relationships both with the account debited and with the account credited. 

\mynote The most important feature of relationships as the term is used  in this book is that the existence of a relationship instance between any two particular entities should be a matter of black and white. For example between any particular Jack and any particular Jill we must take it that there either is or is not a friendship between them. There can be no equivocation or matter of degree --- either the relationship is or is not. This is a point of difference, by the way, between our terminology and that of Chen --- Chen's relationships may have attributes (properties) assigned to them, our relationships may not which is why they are, mathematically, binary relations. We will see that such (black and white) binary relationships are all we need for modelling and that many-many relationships are not needed either. 

\mynote 
Every binary relationship can be described from two different points of view. 
For the planet-star relationship the two points of view are
\begin{itemize}
\item every planet orbits a star,
\item every star may be orbited by planets.
\end{itemize}

In these descriptions the language is slightly ambiguous and questions arise.
Does every planet orbit exactly one star or may it orbit multiple stars? Do any stars have no planets orbiting them?

In an entity model ambiguities such as these are removed. 
The planet-star relationship would be expressed in more detail as
\begin{itemize}
\item every planet must be orbiting exactly one star,\footnote{You may disagree with this if your cosmology is more nuanced than mine.}
\item every star may be orbited by one or more planets.
\end{itemize}

Note that these two prescriptions describe the very same relationship from opposite ends. That they are complementary points of view I can express like this:

\begin{itemize}
\item a planet is orbiting a star if and only if the star is orbited by the planet.
\end{itemize}

\mynote
In his introduction to entity relationship diagramming, Chen gives an example of an entity relationship diagram describing the types of entities relevant to the organisation of an imaginary manufacturing company.
In it he gives the example of a relationship between an employee and the department in which they work. 

\noindent In his diamond notation Chen draws the relationship like this:
\begin{center}
\input{\ImagesFolder/department-employee.tex}
\end{center}

\noindent In the Chen notation, the numeric $1$ labelling the left hand line in this diagram indicates that every employee is in exactly one department and the corresponding annotation N on the right side indicates the fact that there are many employees within each department. \\

\noindent This relationship can be described from  two complementary points of view as
\begin{align}
\label{employing}&\mbox{every department may be employing one or more employees,} \\
\label{employedby}&\mbox{every employee must be employed by exactly one department.}
\end{align}

\noindent In the notation used in this book, which is based on the Barker-Ellis notation,  this diamond and its two connectors are replaced by a single line. The fact that there
are multiple employees within a department is represented on the diagram by drawing a crows foot at the employee end of the line and the relationship is drawn like so:
\definecolor{lightyellow}{cmyk}{0,0,0,0}

\begin{gather}
\label{employsRelationship}
\raisebox{-1cm}{\input{\ImagesFolder/departmentEmployee.tex}}
\end{gather}

\noindent In this form the relationship can be read directionally
 --- left to right it
reads as  (\ref{employing}), above,  right to left it reads as (\ref{employedby}). 
We can think of there being two directional relationships here inseparably
connected (meta-related, in fact) as the poles of a magnet.

\noindent The right to left reading expresses a many-one directional relationship and this is otherwise known as a functional relationship. In mathematical notation this would indicate a function and be 
represented by an arrow: 
\begin{equation}
employed\,by : employee \longrightarrow department
\end{equation}
\noindent
To be clear, every binary relationship can be thought of as consisting of a pair of directional relationships each one of which is one view of it. 

\mynote Mathematically speaking, every function has an inverse which generally is many-valued and which therefore is represented as a separate function whose target is a power set i.e. a set of subsets. In our case here the inverse to the function \textit{employed by} will in some mathematical circles by represented by a function
\begin{equation}
employing : department \longrightarrow \mathcal{P}(employee).\footnote{Where $\mathcal{P}$ represents power set so that $\mathcal{P}(x)$ is the set of subsets of set $x$.}
\end{equation}

\noindent Let me recap this illustration. The function signatures (3) and (4) express the same information as the words do in (1) and (2).
Diagram (\ref{employsRelationship}) encapsulates the same information and also expresses  the fact that (1) and (2) are complementary i.e. that
an employee works for a particular department if an only if that particular department employs the employee.
Finally, this complementarity may be expressed in the mathematical language of
sets and functions by asserting  function (4) to be the inverse to function (3).   

\subsubsection*{Many-many Binary Relationships}
In Chen's paper the relationship between employees and projects (whose meaning is that
an employee is assigned to work on a project) is depicted like this.
\begin{gather}
\label{projectWorkerChenStyle}
\raisebox{-1cm}{
\input{\ImagesFolder/project-worker.tex}
}
\end{gather}
On this diagram there is an annotation $N$ which documents that an employee may work on many projects (we are to understand that $N >= 0$). There is also an annotation $M$ to document that
a project has many employees assigned to it, $M$ in fact, for some $M >= 0$. \\
\noindent Such a relationship is called a many-many relationship.  \\
\noindent In Barker-Ellis notation which is the basis for the notation used in this book the diamond and its two connectors are replaced by a single line. The fact that the relationship is many-many is represented in the diagram by having a crows foot at each end of the line like so:

\begin{gather}
\label{projectWorkerOurStyle}
\raisebox{-1cm}{
\input{\ImagesFolder/employeeProjectWorker.tex}
}
\end{gather}

\noindent Also notice that the relationship is labelled at both ends. Each text label gives the name of the relationship from the point of view of the type of entity at that end of the line.
\noindent In fact, many-many relationships are infrequently used in entity models and never used at all when modelling data.
Consider that we can make a thing out of the fact of the assignment of an employee to a project. This means that we can entify the many-many relationship and model the relationship like this:

\begin{gather}
\label{projectWorkerOurStyleMediated}
\raisebox{-1cm}{
\input{\ImagesFolder/employeeProjectWorkerMediated.tex}
}
\end{gather}

The original many-many relationship is now mediated by the entity type PROJECT WORKER ASSIGNMENT and two functional relationships. Because we can 'entify' many-relationships and mediate them by other entity types and relationships they can be eliminated from entity modelling. Because functional relationships have direct representations, in data however represented, then it is usual to eliminate many-many relationships from entity models. Since the remaining relationships are functional, in one direction or the other, so it is that in most entity models types are related solely by functional relationships and their inverses. Entity modelling in this form models the world in functional relationships.

\mynote For the sake of completeness I should mention that in such cases the mediating entity or indeed its type is often referred to as an \textit{intersection entity}. 

\mynote Strictly speaking, directional relationships are not, as their name suggests, types of relationships, but are ways of looking at or considering binary relationships. Each directional relationship is a binary relationship viewed at or considered from one end or the other. Each binary relationship can be considered as a directional relationship in two different ways.
This is how binary relationships are described in the entity modelling meta-model given later.
\mynote Functional relationships in mathematics that are total are usually depicted by the arrow symbol $\longrightarrow$.

The partial arrow symbol $\rightharpoonup$ may be used if not know to be total. 

\mynote We have already seen above examples of Barker-Ellis style depictions of relationships in which functional relationships of A to B
are shown like this:
\begin{center}
A\,\barkerEllisA\,B
\end{center}
If however a functional relationship is known to be total then the left half line is drawn as a solid line instead of a dashed line like so

\begin{center}
A\,\barkerEllisB\,B
\end{center}
In either case if the map is known to be surjective then the right hand half line is solidified and looks as this
\begin{center}
A\,\barkerEllisC\,B
\end{center}
or this
\begin{center}
A\,\barkerEllisD\,B
\end{center}

If in any of these four cases it is known in addition that that the map is injective then the crowsfoot is omitted and so it is depicted is one of
\begin{center}
A\,\barkerEllisE\,B \\
A\,\barkerEllisF\,B \\
A\,\barkerEllisG\,B \\
A\,\barkerEllisH\,B 
\end{center}

Note that in this final case the relationship in question establishes a 1-1 correspondence between types A and B.

\section{Attributes}

\mynote I have said earlier that in entity modelling, the term attribute is adopted as a specific term meaning a relationship between a particular on the one hand and a universal on the other. Actually it would be more accurate to say that the term attribute is used for a \textit{functional} relationship between a type of particulars and a type of universals i.e. a type all of whose instances are universals. When this functional relationship is evaluated at a particular entity then the result is said to be the value of the attribute. For this reason the types which I describe as types all of whose instances are universals are called value types by Chen in his  1976 paper.

\mynote
In Chen's 1984 paper he presents as an example the diagram shown in figure 
\ref{AttributesExampleFromChen1984} which shows a graphical representation of attributes associated with the PROJECT-WORKER relationship (\ref{projectWorkerChenStyle}) that was an example in his 1976 paper.
\begin{figure}
\input{\ImagesFolder/project-worker_with_attributes.tex}
\caption{From Chen 1984. In this diagram NUMBER, NAME, NUMBER-OF-YEARS, DATE and DOLLAR-AMOUNT must all be understood as types all of whose instances are universals. Chen uses the term `value type' for such types. For him our universal things are values. We  say that names, numbers, dates etc are values.}
\label{AttributesExampleFromChen1984}
\end{figure}

\begin{figure}
\input{\ImagesFolder/employeeProjectWorkerMediatedAttributed.tex}
\caption{The example from Chen 1984 recast in the Barker-Ellis style. In this style the value types of attributes are not shown on the diagram but are expected to be 
separately documented. }
\label{projectWorkerAttributesOurStyle}
\end{figure}

\mynote
In standard entity modelling terminology an attribute relates entity to a value but whilst they relate things they are not considered to be relationships. If you ask why not then the answer is that it is just so.
 
\mynote Note that we do not set out to model types of universals and the relationships between them in an entity model. 

\mynote Since relationships of this second kind are called attributes, the term relationship is reserved, in entity modelling terminology and subsequently in these pages, for relationships of the first kind.  The principle components of an entity model are its entity types and their attributes and relationships.

\mynote 
We don't have a simple name for the relationship between a planet and the star it orbits. Instead we have  relative terms `orbits' and `orbited by' which describe each of the parties in the relationship from the point of view of the other. This dual naming of binary relationships is the way that relationships are named in an entity model. 
This is where a diagram comes in handy.
 
\subsubsection*{Ternary Relationships}
For the sake of completeness I should mention that Chen also represents ternary relationships and gives an 
example of a ternary relationship between a project, a supplier and a part which he shows like this:
\begin{center}
\input{\ImagesFolder/supp-proj-part.tex}
\end{center}

In the Barker-Ellis style there are no ternary relationships nor are any needed since ternary relationships can be represented as a combination of binary relationships and entity types. The fact that all relationships are binary and are represented by lines only rather than diamonds  is of practical importance in that more details can be fitted onto diagrams.

\section{An example entity relationship diagram}
In figure \ref{ChenManufacturingExample} we reproduce an example entity relationship diagram  given in Chen's 1976 paper. This example documents principle types of entity in the organisation of an imaginary manufacturing company. The intended meaning of some of the relationships shown in Chen's diagram is not all clear from the diagram nor from the surrounding text. I wanted to redraw
this diagram in the Barker-Ellis style because that is the style used in this book, but to do this I needed to make some guesses about the meaning of some of Chen's relationships because the Barker-Ellis style has required me to descriptively label the relationships. Having made these guesses I drew the diagram shown
 in figure \ref{ChenManufacturingBarkerEllisStyle}. 

\begin{figure} [H]
\begin{center}
\input{\ImagesFolder/manufacturing.tex}
\end{center}
\caption{
In effect this is the first ever entity relationship diagram. It is an entity relationship diagram in the Chen style from his seminal paper of 1976 and it is there described as being an analysis of information in a manufacturing firm. In this diagram
diamonds represent what we describe here as relationships and boxes represent types of entities.  
For completeness we should mention that in Chen's 1976 terminology the boxes were said to be entity sets and the diamonds were said to be relationship sets but by 1983 in a paper published in that year Chen is instead using the terms `entity type' and `relationship type'. While sympathising with this terminology we think it correct to to use the term `relationship' rather than 'relationship type' because this brings us closer to the terminology of formal logic.
}
\label{ChenManufacturingExample}
\end{figure}

\begin{figure} [H]
\begin{center}
\input{\ImagesFolder/chenManufacturingCo..diagram.tex}
\end{center}
\caption{
Chen's 1976 entity relationship diagram (shown in figure \ref{ChenManufacturingExample}) redrawn as a structured entity model using the Barker-Ellis notation. 
I have to guess some of the meaning of Chen's relationships in order to label them meaning fully in this diagram. The rail at the top of the diagram represents the whole of the model which in this case is the manufacturing company in question.
}
\label{ChenManufacturingBarkerEllisStyle}
\end{figure}

\subsection{Background Wikipedia entry for `Part number'}
Has this para headed ``the part design versus instantiations of it''
As a part number is an identifier of a part design (independent of its instantiations), a serial number is a unique identifier of a particular instantiation of that part design. In other words, a part number identifies any particular (physical) part as being made to that one unique design; a serial number, when used, identifies a particular (physical) part (one physical instance), as differentiated from the next unit that was stamped, machined, or extruded right after it. This distinction is not always clear, as natural language blurs it by typically referring to both part designs, and particular instantiations of those designs, by the same word, "part(s)". Thus if you buy a muffler of P/N 12345 today, and another muffler of P/N 12345 next Tuesday, you have bought "two copies of the same part", or "two parts", depending on the sense implied.

\section{Goodness Criteria}
 Goodness criteria in entity modelling  can only be regarded as a long standing collective blind spot for  
there are two specific goodness criteria that can be  applied to an entity model but these  usually remain unspoken but 
nonetheless  adhered to by most practitioners most of the time. This is one aspect of entity modelling and, more specifically, data modelling that most presentations of the subject fail to articulate.  
All experienced practitioners and programmers have the gut instinct for these 
 goodness criteria but rarely if ever pause to articulate them.  
 I am saying nothing new here in this section except that the saying of it is new. 

\subsection{On what relationships and attributes are included in an entity model?}
\mynote We might model that a bicycle is related to its front wheel and that a bicycle is related to its back wheel but we will not then need to model,  and therefore ought not to model, that the front wheel of a bicycle is related to its back wheel because though there is such a relationship it is implied by or mediated by the other two. 

Move Godness of an Entity Model section HERE from tutorial. 

\section{Scope}
The scope of a binary relationship the degree to which its instances span (reach across) different contexts i.e. it descibes how different the context of related entitites might be. If a relationship has a narrow scope that is to say that entitites related by the relationship have similar contexts. 

