 
\subsubsection{Representation of Joint Functional Dependencies}
\begin{lemma}
\llabel{jointfunctionaldependencyrepresentationlemma}
If $\catc$ is a locally finite category and $\reqtc$ is a set of instances, if $\catc$ is 
\term{maximally constrained} to the requirement $\reqtc$ then
all joint functional dependencies $\fundep{H}{f_i)_{1 \le i \leq n}}{g_i)_{1 \le i \leq n}}$  with respect to $\reqtc$ are represented in $\catc$.

Suppose that $b$ and $c$ are objects of \catcw and that for some $n$,$n \geq 1$ that for each $i$,$1\leq i \leq n$ there are morphisms$f_i: a_i \morph b$ and 
$g_i: a_i \morph c$, for some object $a_i$.

\end{lemma}
\begin{proof}
Suppose such a category  $\catc$  that  is 
\term{maximally constrained} to a requirement $\reqtc$ and suppose
$
\begin{array}{c p{0.5cm} c  }
             &&   \Rnode{b}{b} \\[0.01cm]
\Rnode{a}{a} &&                \\[0.01cm] 
             &&   \Rnode{c}{c}         
\end{array} 
$
\ncarr{a}{b}
\alabel{f}
\ncarr{a}{c}
\blabel{g}
in $\catc$ 
and that there is a functional dependency $\fundep{H}{f}{g}$ with respect to $\reqtc$.

From sketch $S$ of $C$ we can construct a sketch $S'$ by formally adding a morphism $\qq{h}: b \morph c$
and path equivalence $f \circ \qq{h} = g$. Let $\catcp$ be the category generated by $S'$ and
let $I: C \morph C'$ be the inclusion functor generated by the inclusion of $S$ in $S'$. 


Now we show that $I$ is consistent with $\reqtc$. We need to show that any $D \in \reqtc$
extends unqiuely to $D' :\catcp \morph \Fin$. Assume such a $D$. 
$D$  extends to $C'$ iff there is a  function that we can choose as the value of  for $D'(\qq{h})$  such that $D'(f) \circ D'(\qq(h) = D'(g)$ i.e such that
$D(f) \circ D'(\qq(h) = D(g)$ and so we  extend $D$ to $D'$ 
 by defining $D'(\qq{h})=D_H$.
This extension to $D'$ is unique because from the definition of functional depdendency
$D_H$ is the unique function that satisfies $D(f) \circ D_H = D(g)$.


Let the functor $F: \catc \morph \Fin$ be the coproduct $Hom_{\catc}(a,-) + Hom_{\catc}(a,-)$
in the functor category $Fin^{\catc}$ and label the injections $L$ and $R$, respectively so that
for each object $x$ of $\catc$ the diagram
\begin{center}
$
\begin{array}{c p{0.5cm} c p{0.5cm} c  }
\Rnode{h1}{Hom_{\catc}(a,x)}  &&\Rnode{Fx}{F(x)}  &&   \Rnode{h2}{Hom_{\catc}(a,x)}       
\end{array} 
$
\ncarr{h1}{Fx}
\alabel{L_x}
\ncarr{h2}{Fx}
\blabel{R_x}
\end{center}
is a coproduct in $\Fin$.

Now for each object $x$ of $\catc$, we define an equivalence relation $\sim_x$ on $F(x)$ by defining,
for $k_1,k_2:a \morph x$ in $\catc$,
\begin{align*}
L_x(k_1) \sim_x R_x(k_2) & \mbox{ iff there exists $k:b \morph x$ in $\catc$ such that $k_1 = f \circ k = k_2$,}\\
L_x(k_1) \sim_x L_x(k_2) & \mbox{ iff $k_1 = k_2$,} \\
R_x(k_1) \sim_x R_x(k_2) & \mbox{ iff $k_1 = k_2$.} \\
\end{align*}
If $j: x_1 \morph x_2$ in $\catc$ and if $y_1,y_2 \in F(x_1)$ such that $y_1 \sim_{x_1} y_2$
then it follows easily by cases and from the definition of $\sim$ that $F(j)(y_1) \sim_{x_2} F(j)(y_2)$.
Therefore we can define a functor 
 $G: \catc \morph \Fin$  so that for any object $x$ of $\catc$
the set $G(x)$ is the quotient $F(x)/{\sim_x}$ and such that 
if $j: x_1 \morph x_2$ in $\catc$ and if $y \in F(x_1)$ then $G(j)([y])=[F(j)(y)]$.
With $G$ so defined then if $k: a \morph x_1$ and $j:x_1 \morph x_2$ in $\catc$
then  $G(j)([L_{x_1}(k)])=[L_{x_2}(k \circ j)]$ and $G(j)([R_{x_1}(k)])=[R_{x_2}(k \circ j)]$. 

Now that we have described the functors  $G: \catc \morph \Fin$ and $I:\catc \morph \catcp$ that is consistent with $\reqtc$
we can use the fact that $\catc$ is maximally constrained to tell us that $G$ extends to a functor 
$G' : \catcp \morph \Fin$. Since $f \circ \qq{h} = g$ in $\catcp$ then we have
 $G'(f) \circ G'(\qq{h}) = G'(g): G(a) \morph G(c)$ in $\Fin$.
Now we have
\begin{align*}
[L_c(g)]&= G'(g)([L_a(id_a)])              & & \mbox{by definition of $G'(g)=G(g)$}           \\
        &= G'(\qq{h}) (G'(f)([L_a(id_a)])) & & \mbox{since $G'(f) \circ G'(\qq{h}) = G'(g)$}  \\
				&= G'(\qq{h}) (G'([L_b(f)]))       & & \mbox{by definition of $G'(f)=G(f)$}           \\
				&= G'(\qq{h}) (G'([R_b(f)]))       & & \mbox{since $L_b(f) \sim_b R_b(f)$, by definition of $\sim_b$} \\
				&= G'(\qq{h}) (G'(f)([R_a(id_a)])) & & \mbox{by definition of $G'(f)=G(f)$}           \\
		    &= G'(g)([R_a(id_a)])              & & \mbox{since $G'(f) \circ G'(\qq{h}) = G'(g)$}  \\
				&= [R_c(g)]                        & & \mbox{by definition of $G'(g)=G(g)$}           \\
\end{align*} 
Since $[L_c(g)]=[R_c(g)]$ then it follows from the definition of $\sim_c$ that there exists $k:b \morph c$ in 
$\catc$ such that $f \circ k = g$ and we have shown as required that the function dependency
$\fundep{H}{f}{g}$ is represented in $\catc$.

\end{proof}

