We now show that if we assume local finiteness of the category \catcw generated by a sketch $S$   having a data specification requirement represented by a set of
instances $R_C$ then  if principle 2 (maximal constrainedness) is met then
\newt{goodness criteria} 2A, 2B and 2C are met also. 


Phrasing this differently: for a data specification to be maximally constrained to a
requirement then  all commutivity constraints,  functional dependencies and referential inclusion dependencies arising from the requirement must be represented in the data specification.

\subsubsection{Representation of Path Equivalences}

\begin{lemma}
\llabel{pathequivalencerepresentationlemma}
If $\catc$ is a locally finite category and $\reqtc$ is a set of instances, if $\catc$ is 
\term{maximally constrained} to the requirement $\reqtc$ then all path equivalences with respect
to $R_C$ are represented in \catcw
i.e. for all diagrams
$
\rule[-0.3cm]{0pt}{0.9cm} %to add vertical space of diagram -- based on lowering diagram 0.3cm and heght 0.9cm
                            % change thickness from 0pt to 1 pt to debug
\begin{array}{c p{0.5cm} c  }
 \Rnode{a}{a}            &&   \Rnode{b}{b}
\end{array} 
$
\ncarc[nodesep=2pt,arcangle=10,offset=2pt]{->}{a}{b}
\alabel{f}
\ncarc[nodesep=2pt,arcangle=-10,offset=-2pt]{->}{a}{b}
\blabel{g}
in $\catc$,  if in all instances $D \in \reqtc$, $D(f)=D(g)$, 
then $f=g$ in $\catc$.
\end{lemma}
\begin{proof}
Suppose such a category  $\catcw$  that  is 
\term{maximally constrained} to a requirement $\reqtc$
and suppose 
$
\rule[-0.3cm]{0pt}{0.8cm} %to add vertical space of diagram -- based on lowering diagram 0.3cm and heght 0.9cm
                            % change thickness from 0pt to 1 pt to debug
\begin{array}{c p{0.5cm} c  }
 \Rnode{a}{a}            &&   \Rnode{b}{b}
\end{array} 
$
\ncarc[nodesep=2pt,arcangle=10,offset=2pt]{->}{a}{b}
\alabel{f}
\ncarc[nodesep=2pt,arcangle=-10,offset=-2pt]{->}{a}{b}
\blabel{g}
in $\catc$. From sketch $S$ of $C$ we can construct a sketch $S'$ by formally adding a path equivalence $f=g$.
$S'$ generates a category $C'$ for which we have a functor $I: \catc \morph \catcp$. 
Because $D(f) = D(g)$ in every instance $D \in \reqtc$
it follows that $I$ is consistent with $\reqtc$. Because $\catc$ is maximally constrained to $\reqtc$
and because $I: \catc \morph \catcp$ is consistent with $\reqtc$ it follows that the functor $Hom_{\catc}(a,-): \catc \morph \Fin$ 
can be extended to a functor $F: \catcp \morph \Fin$. Since $I(f)=I(g)$ in $\catcp$ then $F(I(f))=F(I(g))$. But $I \circ F
= Hom_\catc(a,-)$ therefore we have that $Hom(a,f)=Hom(a,g)$ and, applying both sides to $id_a$, that $f=g$ in $C$ as required.
\end{proof}

In this lemma above we have assumed that \catcw is locally finite. Can we not prove this result for all categories? The following example shows not. 
\begin{example}
Suppose \catcw is the category generated by the sketch with directed graph
\input{completenesscounterexample}
subject to the identities
\begin{equation}
\label{fhidentity}
f \circ h = id_a
\end{equation}
\begin{equation}
\label{ghidentity}
g \circ h = id_a
\end{equation}
and 
\begin{equation}
\label{rhhpidentity}
r \circ h \circ h' = id_b
\end{equation}

We can show that for any functor $D:\catc \morph Fin$, $D(f)=D(g)$. For any requirement 
$R_C$, therefore, $f$ is equivalent to $g$ with respect to $R_C$ and as $f \neq g$ this equivalence of $f$ and $g$ 
is not represented in \catc. Lemma \lref{pathequivalencerepresentationlemma} cannot therefore be made applicable to all categories (or to all finitely presented categories) as we might wish.

To show that if $D:\catc \morph Fin$ then $D(f)=D(g)$ 
first note that we have that $D(r) \circ D(h \circ h')=id_{D(b)}$ because this follows from
identity (\ref {rhhpidentity}) and from the functoriality of $D$, Since 
the set $D(b)$ is finite it follows that $D(r): D(b) \morph D(b)$ is surjective and injective 
and that the function $D(h \circ h'):D(b) \morph D(b)$ is surjective and injective and from this later
that the function $D(h)$ is injective.
Because of identities (\ref{fhidentity}) and (\ref{ghidentity}) and from the 
functoriality of $D$ we have that $D(f) \circ D(h) =id_{D(a)}=D(g) \circ D(h)$. Because $D(h)$ is injective it follows 
that $D(f)=D(g)$, as required.
\end{example}

\subsubsection{Representation of Functional Dependencies}
\begin{lemma}
\llabel{functionaldependencyrepresentationlemma}
If $\catc$ is a locally finite category and $\reqtc$ is a set of instances, if $\catc$ is 
\term{maximally constrained} to the requirement $\reqtc$ then
all functional dependencies $\fundep{H}{f}{g}$  with respect to $\reqtc$ are represented in $\catc$.
\end{lemma}
\begin{proof}
Suppose such a category  $\catc$  that  is 
\term{maximally constrained} to a requirement $\reqtc$ and suppose
$
\begin{array}{c p{0.5cm} c  }
             &&   \Rnode{b}{b} \\[0.01cm]
\Rnode{a}{a} &&                \\[0.01cm] 
             &&   \Rnode{c}{c}         
\end{array} 
$
\ncarr{a}{b}
\alabel{f}
\ncarr{a}{c}
\blabel{g}
in $\catc$ 
and that there is a functional dependency $\fundep{H}{f}{g}$ with respect to $\reqtc$.

From sketch $S$ of $C$ we can construct a sketch $S'$ by formally adding a morphism $\qq{h}: b \morph c$
and path equivalence $f \circ \qq{h} = g$. Let $\catcp$ be the category generated by $S'$ and
let $I: C \morph C'$ be the inclusion functor generated by the inclusion of $S$ in $S'$. 

\begin{newtt}
Now we show that $I$ is consistent with $\reqtc$. 
We need to show that any $D \in \reqtc$
extends unqiuely to $D' :\catcp \morph \Fin$. Assume such a $D$. 
$D$  extends to $C'$ iff there is a  function that we can choose as the value of  for $D'(\qq{h})$  such that $D'(f) \circ D'(\qq(h) = D'(g)$ i.e such that
$D(f) \circ D'(\qq(h) = D(g)$ and so we  extend $D$ to $D'$ 
 by defining $D'(\qq{h})=D_H$.
This extension to $D'$ is unique because from the definition of functional depdendency
$D_H$ is the unique function that satisfies $D(f) \circ D_H = D(g)$.
\end{newtt}

\begin{newtt}
In the remainder of this proof 
we define a functor $G: \catc \morph \Fin$ such that
$G(a)$ has a pair of distinct elements, call them $left$ and $right$, say,  that are mapped by $G(f)$ to identical elements
of $G(b)$, i.e. such that $G(f)(left)= G(f)(right)$ 
and such that $G$ is initial with respect to such functors.  
We  argue that because of  maximal constrainedness that $G$ can be extended to a functor 
$G' : \catcp \morph \Fin$. 
Because $f \circ \qq{h} = g$ in \catcpw we can argue that $G'(g)$,
and thus $G(g)$,
maps $left$ and $right$ to identical elements of $G(c)$ 
i.e. is such that $G(g)(left)= G(g)(right)$. 
The initiality of $G$, the fact that  $G(g)(left)= G(g)(right)$ follows
from $G(f)(left)= G(f)(right)$, is then enough 
to ensure that there exists a morphism $h:b \morph c$ in \catc
such that $f \circ g = h$
 with the required properties to represent the functionality dependency $H$.
\end{newtt}

First define the functor $F: \catc \morph \Fin$ be the coproduct $Hom_{\catc}(a,-) + Hom_{\catc}(a,-)$
in the functor category $Fin^{\catc}$ and label the injections $L$ and $R$, respectively so that
for each object $x$ of $\catc$ the diagram
\begin{center}
$
\begin{array}{c p{0.5cm} c p{0.5cm} c  }
\Rnode{h1}{Hom_{\catc}(a,x)}  &&\Rnode{Fx}{F(x)}  &&   \Rnode{h2}{Hom_{\catc}(a,x)}       
\end{array} 
$
\ncarr{h1}{Fx}
\alabel{L_x}
\ncarr{h2}{Fx}
\blabel{R_x}
\end{center}
is a coproduct in $\Fin$. $F$ is a functor such that $F(a)$ has two elements
$L(id_a)$ and $R(id_a)$ and is initial among such functors.

Now for each object $x$ of $\catc$, we define an equivalence relation $\sim_x$ on $F(x)$ by defining,
for $k_1,k_2:a \morph x$ in $\catc$,
\begin{align*}
L_x(k_1) \sim_x R_x(k_2) & \mbox{ iff there exists $k:b \morph x$ in $\catc$ such that $k_1 = f \circ k = k_2$,}\\
L_x(k_1) \sim_x L_x(k_2) & \mbox{ iff $k_1 = k_2$,} \\
R_x(k_1) \sim_x R_x(k_2) & \mbox{ iff $k_1 = k_2$.} \\
\end{align*}
If $j: x_1 \morph x_2$ in $\catc$ and if $y_1,y_2 \in F(x_1)$ such that $y_1 \sim_{x_1} y_2$
then it follows easily by cases and from the definition of $\sim$ that $F(j)(y_1) \sim_{x_2} F(j)(y_2)$.
Therefore we can define a functor 
 $G: \catc \morph \Fin$  so that for any object $x$ of $\catc$
the set $G(x)$ is the quotient $F(x)/{\sim_x}$ and such that 
if $j: x_1 \morph x_2$ in $\catc$ and if $y \in F(x_1)$ then $G(j)([y])=[F(j)(y)]$.
With $G$ so defined then if $k: a \morph x_1$ and $j:x_1 \morph x_2$ in $\catc$
then  $G(j)([L_{x_1}(k)])=[L_{x_2}(k \circ j)]$ and $G(j)([R_{x_1}(k)])=[R_{x_2}(k \circ j)]$. 

Now that we have described the functors  $G: \catc \morph \Fin$ and $I:\catc \morph \catcp$ that is consistent with $\reqtc$
we can use the fact that $\catc$ is maximally constrained to tell us that $G$ extends to a functor 
$G' : \catcp \morph \Fin$. Since $f \circ \qq{h} = g$ in $\catcp$ then we have
 $G'(f) \circ G'(\qq{h}) = G'(g): G(a) \morph G(c)$ in $\Fin$.
Now we have
\begin{align*}
[L_c(g)]&= G'(g)([L_a(id_a)])              & & \mbox{by definition of $G'(g)=G(g)$}           \\
        &= G'(\qq{h}) (G'(f)([L_a(id_a)])) & & \mbox{since $G'(f) \circ G'(\qq{h}) = G'(g)$}  \\
	&= G'(\qq{h}) ([L_b(f)])       & & \mbox{by definition of $G'(f)=G(f)$}           \\
	&= G'(\qq{h}) ([R_b(f)])       & & \mbox{since $L_b(f) \sim_b R_b(f)$, by definition of $\sim_b$} \\
	&= G'(\qq{h}) (G'(f)([R_a(id_a)])) & & \mbox{by definition of $G'(f)=G(f)$}           \\
	&= G'(g)([R_a(id_a)])              & & \mbox{since $G'(f) \circ G'(\qq{h}) = G'(g)$}  \\
				&= [R_c(g)]                        & & \mbox{by definition of $G'(g)=G(g)$}           \\
\end{align*} 
Since $[L_c(g)]=[R_c(g)]$ then it follows from the definition of $\sim_c$ that there exists $k:b \morph c$ in 
$\catc$ such that $f \circ k = g$.  \newt{Need show uniqueness of such $k$.}  We have shown as required that the function dependency
$\fundep{H}{f}{g}$ is represented in $\catc$.

\end{proof}

In this lemma above we have assumed that \catcw is locally finite. Can we not prove this result for all categories? A development of the previous examples shows not.
\begin{example}
Suppose \catcw is the category generated by the directed graph
\input{fdrepresentationcounterexample}
subject to the identities
\begin{equation}
\label{fdcounterfhidentity}
f_1 \circ f_2 \circ h = id_a
\end{equation}
\begin{equation}
\label{fdcounterghidentity}
g \circ h = id_a
\end{equation}
and 
\begin{equation}
\label{fdcounterrhhpidentity}
r \circ h \circ h' = id_b
\end{equation}

As in the previous example, we can show that for any functor $D:\catc \morph Fin$, $D(f1 \circ f_2)=D(g)$. For any requirement 
$R_C$, therefore,  $g$ is functionally dependent on $f_1$ 
with respect to $R_C$. This functional dependency  
is not represented in \catc. \commentary{We also have to prove the claim that the functional dependency is not represented in \catc. }
Therefore Lemma \lref{functionaldependencyrepresentationlemma} cannot therefore be made applicable to all categories (or to all finitely presented categories).

\end{example}

\subsubsection{Representation of Referential Inclusion Dependencies}
\begin{lemma}
\label{catincdsrepresented}
If $\catc$ is a locally finite category and $\reqtc$ is a set of instances, if $\catc$ is 
\term{maximally constrained} to the requirement $\reqtc$ then
every referential inclusion dependency with respect to $\reqtc$ is represented in $\catc$.
\end{lemma}
\begin{proof}
Suppose such  a category $\catc$ and  requirement $\reqtc$ 
 and suppose there is a referential inclusion dependency
$a[f_1,...f_n] \overset{I}{\subseteq} b[q_1,..q_n]$ with respect to $\reqtc$,
where
$
\begin{array}{c p{0.25cm} c  p{0.25cm} c }
             &&   \Rnode{b1}{b_1} &&              \\[0.4cm]
\Rnode{a}{a} &&                   && \Rnode{b}{b} \\[0.4cm]
             &&   \Rnode{bn}{b_n} &&              
\end{array} 
$
\ncarr{a}{b1}
\alabel{f_1}
\ncarr{b}{b1}
\blabel{q_1} 
\ncarr{a}{bn}
\blabel{f_n}
\ncarr{b}{bn}
\alabel{q_n}
in $\catc$, 

From sketch $S$ of $C$ we can construct a sketch $S'$ by formally adding a morphism $\qq{f}: a \morph b$
and path equivalences, for each $i$, $1 \leq i \leq n$, $\qq{f} \circ q_i = f_i$. Let $\catcp$ be the category generated by $S'$ and
let $I: C \morph C'$ be the inclusion functor generated by the inclusion of $S$ in $S'$. $I$ is consistent with $\reqtc$ since
each instance $D \in  \reqtc$ can be \newt{uniquely} extended to a functor $D': \catcp \morph \Fin$ by defining $D'(\qq{f})=I_D$.

Since $\catc$ is locally finite then there is a functor $Hom_{\catc}(a,-): \catc \morph \Fin$ and since $\catc$ is maximally constrained and because $I$ is consistent with $\reqtc$ then there is a functor $F': C' \morph \Fin$
such that $I \circ F' = Hom_{\catc}(a,-)$. In particular we must have 
$F'(a)=Hom_{\catc}(a,a)$,
$F'(b)=Hom_{\catc}(a,b)$ and therefore $F'(\qq{f}):Hom_{\catc}(a,a) \morph Hom_{\catc}(a,b)$ which gives us
$F'(\qq{f})(id_a): a \morph b$ in $\catc$. 

\newt{Do we need show uniqueness of someat?}

We can show that $F'(\qq{f})(id_a)$ represents
the inclusion dependency $a[f_1,...f_n] \overset{I}{\subseteq} b[q_1,..q_n]$ by showing that for 
each $i$, $1 \leq i \leq n$, $F'(\qq{f})(id_a) \circ q_i = f_i$. This follows because we have defined
the sketch $S'$ so that in category $C'$ we have $\qq{f} \circ q_i = f_i$. From this it follows
that $F'(\qq{f}) \circ F'(q_i) = F'(f_i)$ i.e. $F'(\qq{f}) \circ Hom(a,q_i) = Hom(a,f_i)$. 
Applying left and right hand sides to $id_a$ we get $F'(\qq{f})(id_a) \circ q_i = f_i$, as required.
\end{proof}

