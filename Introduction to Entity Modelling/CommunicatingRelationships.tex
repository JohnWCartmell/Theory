\section{Referencing Entities}
\label{ReferencingEntities}

In this section we explore the significance of an entity type's identifying features
and the manner in which knowledge of these features, 
be they attributes or relationships, enables us to 
reference entities and, in turn, 
to convey, communicate and store instances of relationships. 
There is more to this than initially meets the eye and we explore the topic
by way of examples.   We learn that in some cases alongside of knowledge of the identifying features we need knowledge of and need take account of the equivalence or otherwise of certain paths of relationships.

\subsection{Entities that are Named}
\mynote \commentary{Possibly ditch this example and just use the 
dramatic arts example which could be moved here.}
In the simplest examples, entities of a type have names associated with them
 and these names are unique and can be  quoted to reference entities of the type. 
 In these cases an entity model will represent the entity type with a name attribute
and mark it as identifying. 
Examples of such types are ubiquitous and you will see plenty in these pages but to mention two, because we have already come across them, in a model that includes the 
entity types \textit{planet} and  \textit{moon}  these types will be represented as having 
a name attribute and these will be marked as identifying as in this fragment here:
\begin{equation}
\label{planetMoonModel}
\input{\ImagesFolder/planetMoon2.tex}
\end{equation}
This tells us that we can reference planets by name, as in 
\begin{equation}
\label{theplanetJupiter}
\mbox{\textit{the planet with name Jupiter}}
\end{equation}
and, likewise, moons, so that we can make reference to 
\begin{equation}
\label{themoonIo}
\mbox{\textit{the moon with name Io}}.
\end{equation}

Note that there is a standard phraseology for referencing
at play here in (\ref{theplanetJupiter}) and (\ref{themoonIo})  ---
it is employed to reference entities using the values of their singular identifying attributes. 
To illustrate various characteristics of this referencing, 
we will dash-underline the values of identifying attributes in example phrases 
and we will use different styles of dashes to distinguish different entities that are being referenced. We see this in this statement: 
\begin{equation}
\label{JupiterIoPernickity}
\mbox{\textit{The planet with name \rdash{Jupiter} 
\uwave{is orbited} by the moon with name \rdot{Io},}}
\end{equation}
in which I have wavy underlined the name of a (directional) relationship,
an example of a wider standard phraseology, one  for conveying relationship instances,
that builds on the standard phraseology for referencing entities
by asserting, as it does,  a relationship between two referenced entities.
There is a bit more to this than meets the eye, though, as we shall see.
\mynote
When the values of identifying attributes are used in referencing then we will speak of them as \textit{referentials}. 
Accordingly, we speak of the terms `Jupiter' and `Io' in statement (\ref{JupiterIoPernickity}) as referentials.

In the context of statement (\ref{JupiterIoPernickity}), Jupiter is the name of, and therefore  a reference to, a planet and  Io is the name of, and therefore a reference to, a moon (aka a natural satellite).
Note though that within the context of the solar system the name Io  doesn't uniquely identify this moon of Jupiter amongst all named solar system objects since it is also the name of an asteroid that orbits within the asteroid belt. This  illustrates that 
the names of moons are only unique as names of moons. This is very much the meaning of the underlining of the name attribute in fragment (\ref{JupiterIoPernickity}). 

\mynote
We are very much stating the obvious of course but there is a pattern here and it is repeated over and over when instances of relationships are communicated  and the same pattern occurs more formally  and uniformly when instances of relationships are communicated in software systems and/or stored in data.

We will come back to the phrasing of relationship instances in a monent but first we must look at the characteristics of referencing when some of the identifying features of an entity are relationships.

\subsection{Context and the Referencing of Entities}
\mynote
We examine how,  when some identifying features are relationships, the referencing 
--- the nature of the reference ---   
is impacted by the context within which the reference is being made. 
The reference is  a noun phrase quoting the values of identifying attributes
and with the number quoted depending on 
the context within which the reference is made.
What we see contributes to a later analysis --- the analysis of  how 
instances of a relationship can be conveyed, communicated or stored.
\subsubsection{Referencing Characters from Plays}
\mynote
 We use as an example the referencing of characters from  plays
 within the context of  the  dramatic arts
   as modelled earlier in figure \ref{dramaticArts1}.
We focus on these detail
\begin{equation*}
\input{\ImagesFolder/dramaticArtsCharacterFragment.tex}
\end{equation*}
as these are the ones relevant to the identification of entities 
of type character.

From this part of the model we see that playwrights are identified by name and that plays are identified by their titles within the context of the playwright they are written by. Therefore
\begin{itemize} 
\item without context, 
\begin{equation} 
\label{absolutePlayReferencing}
\text{\parbox{9cm}{a  play 
may be referenced by the \uline{title} of the play and the \uline{name} of the playwright it is \uwave{written by.}}}
\end{equation}
\end{itemize}
I have underlined  identifying attributes so as to draw attention to the number of them required.

\mynote
From inspecting the representation of the character type and in particular its identifying features then we see that:
\begin{itemize}
\item within the context of a specific play, 
\begin{equation} 
\label{absoluteCharacterReferencing}
\text{\parbox{9cm}{
a character may be referenced by their \uline{name}.}}
\end{equation}
Accordingly in the text of a play characters are referenced 
by name as for example in a stage direction such as this one:  
\begin{equation*}
\text{\textit{Enter \rdash{Sebastian}.}}
\end{equation*}
\item within the context of a specific playwright (but with no particular play in mind), 
\begin{equation} 
\label{playwrightRelativeCharacterReferencing}
\text{\parbox{9cm}{
 a character from within a play 
may be referenced by their \uline{name} along with the \uline{title} of the play they are \uwave{in}.}}
\end{equation}
So in a discussion of our favourite Shakespearen characters  we might 
make reference to
\begin{equation*}
\text{\textit{\rdash{Sebastian} from \rdash{Twelfth Night}.}}
\end{equation*}
\item
without any context at all, 
\begin{equation} 
\label{absoluteCharacterReferencing}
\text{\parbox{9cm}{a character from within a play 
may be referenced by their \uline{name} along with the \uline{title} of the play they are \uwave{in} and the \uline{name} of the playwright it is \uwave{written by}.}}
\end{equation}
Thus, without context, three referentials are required for the referencing of a character
as  when I reference the following character:
 \begin{equation*}
\label{TounchstoneReferenceFromAbsolute}
\text{\parbox{9cm}{\textit{\rdash{Touchstone} from \rdash{Shakespeare}'s \rdash{As You Like It}. }}}
\end{equation*}
\end{itemize}

\begin{notebox}
In this example there were two identifying relationships arranged end to end. It was by looking at the subject type (character) and the two entity types reached directly and indirectly through the identifying relationships
 that I gathered the identifying attributes whose values are required as referentials. 
I mention this because there is the beginnings of a simple algorithm here by which entity models can be transformed to definitions of tabular structure.
\end{notebox}

\subsubsection{Referencing Productions of Plays}
Now we move on to another area within the overall model of figure \ref{dramaticArts1}. From this detail 
\begin{equation*}
\input{\ImagesFolder/dramaticArtsProductionFragment.tex}
\end{equation*}
regarding the production entity type  we see that
\begin{itemize}
  \item
  without any context, 
  \begin{equation} 
\label{absoluteCharacterReferencing}
\text{\parbox{9cm}{a production can be referenced by referencing the play it is a production \uwave{of} 
  and by giving the \underline{name} of the venue  the production is \uwave{at} and the \underline{season} 
  over which it plays.}}
\end{equation}
We have already seen that to reference a play requires two referentials and so
we can count up the number of referentials required to reference a production
  as one for the venue, two for the play and one for the season so four referentials in all. 
As an example of this consider the following prescription
\begin{erquote}
\parbox{9cm}{a production of \mbox{\rdash{Shakespeare}'s} \rdash{As You Like It}
 performed \mbox{\rdash{April – May 1975},} at \rdash{Oxford Playhouse}.}\\
\end{erquote}
As is to be expected in this description there are four referentials present.\footnote{
I found the literal description online as ``a production of the play As You Like It (by William Shakespeare), April – May 1975, at Oxford Playhouse''.  
} 
\end{itemize}
For entity types character and production we have been able to inspect the entity model diagram for identifying  attributes and relationships and from the inspection posit required referentials  for the referencing of entitites of the type.
This doesn't always work out in the way that it does here though. 
To see this we are going to move on to another area within our model and look at how dramatic roles are identified and referenced.
 \subsubsection{Referencing Dramatic Roles}
\mynote
In figure \ref{dramaticArts1}, the entity type \textit{dramatic role} is
depicted as an intersection entity as it is shown having
two identifying relationships and no identifying attributes.
The relevant detail is  this
\begin{equation*}
\input{\ImagesFolder/dramaticArtsDramaticRoleFragment.tex}
\end{equation*}
We can interpret this detail as telling that
\begin{equation}
\label{DramaticRoleReferencing}
\text{\parbox{9cm}{to reference a dramatic role it is necessary  
to both reference a character from a play and to reference a production.}}
\end{equation}

Now, we have already discussed how characters from plays need be referenced using three referentials
and  how productions need be referenced using four referentials 
and so we can expect that, without context, a reference to
a dramatic role will require seven referentials
 --- three for the character and four for the production. 
So we will need seven, right?
 Well no, rather surprisingly, wrong! Only five referentials are required. 
 What happended to the other two? Can you examine the model in figure xxx and figure this out?

That only five referentials are needed can be seen from this reference to a dramatic role:
\begin{erquote}
\parbox{9.0cm}{the role of \rdash{Touchstone} in the production of \mbox{\rdash{Shakespeare}'s} \rdash{As You Like It} performed \mbox{\rdash{April – May 1975},} at \rdash{Oxford Playhouse}.
}
\end{erquote}

To see why this is we have to add to our declaration, (\ref{DramaticRoleReferencing}), and declare more specifically that
\begin{equation}
\label{DramaticRoleReferencingRevised}
\text{\parbox{9cm}{To reference a dramatic role it is necessary 
to both reference a character from a play and to reference a production \textbf{of that same play}.}}
\end{equation}
It is because both the character and the production will both be in relationships with the very same play
that in referencing a dranatic role, the referencing of the character and the referencing of
the production will not be independent
--- each of these two references --- the referencing of the play and the referencing of the production ---
 will include reference to the very same play. This is the situation for which Lang, seemingly, in Shlaer and Lang, coined the term collapsed referential. They very much had in mind relational database structure but we have got to the same point here in this section merely in a discussion of how referencing works in ordinary speech. 

 The conclusion I come to is that in an entity model it is pretty significant to specify more than we see in the diagram of relationships. We need to specify additional information such as in the declaration above
 is captured by qualifying as "in the same path". 

To see what form this additional information ought to take we have to focus on this fragment
and observe that the "in the same path" injunction is necessary and appropriate just because in this diagram the two comparable paths from entity type dramatic role and entity type play are equivalent.
This is what we need specify in our entity model but it is beyond what is shown on the diagram of figure \ref{} or any notation that I have so far introduced.
We will come back later to how such a specification might look after we have seen some other 
related examples.
For now we can imagine annotating the diagram in some way or else specifying in a separate document
or a separate diagram. However we specify it we should think of the specification of equivalent paths as 
an important supplement to the entity relationship diagram and that it is the totality of the diagram plus the statement of path equivalences that comprises the entity model.

There is a phenomenon at work here and it needs to be coralled.

We describe this phenomenon in a number of ways in the remainder of this section and in the next. 
I don't expect the reader to be a mathematician but, for those readers that are, there is a quick way of saying what is happening and I am going to print it in bold because I feel like shouting it  --- \textbf{there is a commutative diagram of functional relationships at play and, in cases such as this, this makes all the difference to how we reference entities because resultant referentials collapse.}.

\begin{noteforfuture}
I might be able to get to the equivalence of paths by examining
a noun phrase involvinf seven referentials.

dramatic role is referenced by reference to production reference to play
\end{noteforfuture}

\subsubsection{Algorithm for accumulating referentials}
\commentary{referential accumulation algorithm}

Describe the algorithm.
Accumulate into the referential attributes the identifying attributes of the subject entity type
with all the referential attributes of all entity types reached by travering an identifying relationship.

Next need to refine this algorithm to take account of commutative relationships. 

To do use define paths of identifying relationships.

\subsection{Communicating Relationships}
\commentary{feels to me like this should be a separate section}
\mynote 
Now on the surface of it it is very simple
to convey instances of relationships --- we reference two entitites and assert a relationship between them. 
To convey an instance of this relationship://
XXXX actor to dramatic role
we reference an actor entity, by name according to figure ref{drammaticArts1},
and we convey a dramatic role entity by means of five referentials as we have seen above.
In this way we get statements such as
\begin{erquote}

\parbox{9.0cm}{\linespread{1.5}\normalsize\rdash{Bob Hoskins} was \uwave{the player of} the role of \rdot{Touchstone} in the production of \mbox{\rdot{Shakespeare}'s} \rdot{As You Like It} performed \mbox{\rdot{April – May 1975},} at \rdot{Oxford Playhouse}.
}
\end{erquote}
which, by the way, is true  --- Bob Hoskins did play this role --- I was there.
In this example, referentials to reference the actor are dash underlined. The relationship is wavy underlined.
Referentials to reference the dramatic role are dotted underlined.

All this is strightforward. But things are not always so straightforward because sometimes referentials can overlap. 
Shlaer and Long explore this topic in the context of relational database structure and refer to them as \textit{collapsed referentials}. This is an important topic and the subject isn't complete if we dont 
consder these and so here is an example that contains such `collapsed referentials'.

As we have said above and according to the model we have assumed,
  characters from plays need be identified by three referentials
 --- the name of the character, the title of the play and the name of the playwright.

\mynote 
That there three referentials to reference a character naively implies that if we wish to communicate an instance of relationship between two different characters then we will be required to communicate six referentials
 -- three to identify one party in the relationship and three to identify the other party. 
 we will see shortly  --- this is the significant bit --- that this is not always the case and so not what we instinctively do, when we have \textit{a priori} knowledge of the relationship being communicated is limited in scope. 
 If we know the relationship is confined to individual playwrights or is internal to individual play 
 or script then clearly we do not 
  communicate the playwright and play title twice over. The number of referentials may in such a case collapse to four:
   name of playwright, title of play and name of character.
Shlaer-Lang in the context of data representation of entities and in a very much underrated paper, coined the term \textit{collapsed referentials} in
their description of this phenomena.  We shall use instead the term \textit{shared referential} for a referential that contributes to multiple references.

\mynote 
In the  the play Twelfth Night by William Shakespeare, Antonio loves Sebastian.

For the discussion that follows suppose love to be a many-many relationship between characters.

A naive approach would suggest that six referentials are required to convey an instance of love
between characters --- three referentials to reference the lover character and three to reference the loved.
If I follow the naive approach I would convey the relationship instance like this:
\begin{equation}
\text{\parbox{9cm}{\textit{The character named Antonio in Shakespeare's play Twelfth Night loves the character named Sebastian in Shakespeare play Twelfth Night.}}}
\end{equation} 
But there is a reason why the shorter
\begin{equation}
\text{\parbox{9cm}{\textit{The character named Antonio in Shakespeare's play Twelfth Night loves the character named Sebastian.}}}
\end{equation} 
is correct and it is  important we understand this reason.
What is at play here is another instance of the same basic phenomenon we saw before in the context of the referencing of entitites --- less referentials are required than we first expect from a naive reading.  

This reason in this case is because the relationship `loves' in this context 
is, \textit{a priori}, a relationship which is internal to the plot of a single individual play ---
it is an intra-play relationship rather than an inter-play relationship.
Because it is intra-play, when we covey an instance then the referentials that refer to the play are shared between lover and loved As shown in figure \ref{SebastianLovesAntonio}.


\begin{erboxedFigure}{H}{SebastianLovesAntonio}
{Referencing two different characters using just four referentials. This is an example of what Shlaer and Lang (?) called collapsed referentials. What we see is that referential `Shakespeare' contributes to two different references. Likewise does the referential `Twelfth Night'.
These are examples of shared referentals --- they contribute, as indicated, to both reference 1 and reference 2.}
\newcommand{\dashRefOne}{2pt 2pt}
\newcommand{\dashRelationship}{1pt 0pt}
\newcommand{\dashRefTwo}{1pt 1pt}
\begin{tabular}{l}
\Rnode{w1}{\rdash{Antonio}} in \Rnode{w2}{\rdot{\rdash{Shakepeare}}}'s \Rnode{w3}{\rdot{\rdash{Twelfth Night}}} \Rnode{w4}{\rline{loves}}  \Rnode{w5}{\rdot{Sebastian}} \\[1.4cm]
\kern1.2cm\Rnode{ref1}{\textit{reference 1}}
\kern0.75cm\Rnode{rel}{\textit{relationship}}
\kern0.6cm\Rnode{ref2}{\textit{reference 2}} \\[0.5cm]
\syntag{\dashRefOne}{ref1}{0.9}{w1}{0}
\syntag{\dashRefOne}{ref1}{0.9}{w2}{-0.2}
\syntag{\dashRefOne}{ref1}{0.9}{w3}{-0.2}
\syntag{\dashRelationship}{rel} {0.7} {w4}{0}
\syntag{\dashRefTwo}{ref2}{0.4}{w2}{0.2}
\syntag{\dashRefTwo}{ref2}{0.4}{w3}{0.3}
\syntag{\dashRefTwo}{ref2}{0.4}{w5}{0}
\end{tabular}
\end{erboxedFigure}

An instances of the `loves' relationship is conveyed by a total of four referentials
 not the six that might have been required
if the relationship were global in scope (as would have been the case if a
 character from one play could love  a character from an entirely different play).
 An example of a relationship between characters that is global in scope 
 is the relationship of one character being modelled on or resembling or being inspired 
 by another character from the dramatic arts.
 To convey an instance of this relationship, being as the relationship is gloabl in scope,  does indeed require
 six referentials --- three for the one party and three for the other --- as in this example:
\begin{erquote}
\parbox{9.0cm}{\linespread{1.3}\normalsize
\rdash{Romeo} from \rdash{Shakespeare}'s \rdash{Romeo and Juliet}
          \uwave{is modelled on} \rdot{Pyramus} from \rdot{Ovid}'s \rdot{Metamorphoses}.}
\end{erquote}
which, interpreted from the perspective of the dramatic arts that we have given above, does indeed contain six referentials. 
The first three, shown with dashed underlining, reference one character.
The verb of the sentence is the name of the relationship, and, 
the final three referentials, with dotted underlining, 
reference a second charater from a different play.\footnote{I am bending the facts a bit here 
in that Metamophoses isn't strictly a play - its a bunch of stories.} 
There are no shared referentials.


\subsection{Philosophy}
\mynote
Bearing in mind that I have said that entities, and relationship instances, are particulars
and that the values of attributes, referentials included, are universals then, arguably,
 what we have been examining in this section, 
 is the mechanics behind the following slogan:
\begin{erquote}
We think particulars, but we speak universals.
\end{erquote}
\begin{noteforfuture}
\mynote
A follow up slogan for the coming section on data is
\begin{erquote}
Universals are the stuff of data though its meaning is in the 
particulars --- entities and relationships --- that the universals describe. 
\end{erquote}
\end{noteforfuture}





 
