\section{Referencing Entities}
\label{ReferencingEntities}

In this section we explore the significance of an entity type's identifying features
and the manner in which knowledge of these features, 
be they attributes or relationships, enables us to 
reference entities and, in turn, 
to convey, communicate and store instances of relationships. 
There is more to this than initially meets the eye and we explore the topic
by way of examples.   We learn that in some cases alongside of knowledge of the identifying features we need knowledge of and need take account of the equivalence or otherwise of certain paths of relationships.

\subsection{Entities that are Named}
\mynote \commentary{Possibly ditch this example and just use the 
dramatic arts example which could be moved here.}
In the simplest examples, entities of a type have names associated with them
 and these names are unique and can be  quoted to reference entities of the type. 
 In these cases an entity model will represent the entity type with a name attribute
and mark it as identifying. 
Examples of such types are ubiquitous and you will see plenty in these pages but to mention two, because we have already come across them, in a model that includes the 
entity types \textit{planet} and  \textit{moon}  these types will be represented as having 
a name attribute and these will be marked as identifying as in this fragment here:
\begin{equation}
\label{planetMoonModel}
\input{\ImagesFolder/planetMoon2.tex}
\end{equation}
This tells us that we can reference planets by name, as in 
\begin{equation}
\label{theplanetJupiter}
\mbox{\textit{the planet with name Jupiter}}
\end{equation}
and, likewise, moons, so that we can make reference to 
\begin{equation}
\label{themoonIo}
\mbox{\textit{the moon with name Io}}.
\end{equation}

Note that there is a standard phraseology for referencing
at play here in (\ref{theplanetJupiter}) and (\ref{themoonIo})  ---
it is employed to reference entities using the values of their singular identifying attributes. 
To illustrate various characteristics of this referencing, 
we will dash-underline the values of identifying attributes in example phrases 
and we will use different styles of dashes to distinguish different entities that are being referenced. We see this in this statement: 
\begin{equation}
\label{JupiterIoPernickity}
\mbox{\textit{The planet with name \rdash{Jupiter} 
\uwave{is orbited} by the moon with name \rdot{Io},}}
\end{equation}
in which I have wavy underlined the name of a (directional) relationship,
an example of a wider standard phraseology, one  for conveying relationship instances,
that builds on the standard phraseology for referencing entities
by asserting, as it does,  a relationship between two referenced entities.
There is a bit more to this than meets the eye, though, as we shall see.
\mynote
When the values of identifying attributes are used in referencing then we will speak of them as \textit{referentials}. 
Accordingly, we speak of the terms `Jupiter' and `Io' in statement (\ref{JupiterIoPernickity}) as referentials.

In the context of statement (\ref{JupiterIoPernickity}), Jupiter is the name of, and therefore  a reference to, a planet and  Io is the name of, and therefore a reference to, a moon (aka a natural satellite).
Note though that within the context of the solar system the name Io  doesn't uniquely identify this moon of Jupiter amongst all named solar system objects since it is also the name of an asteroid that orbits within the asteroid belt. This  illustrates that 
the names of moons are only unique as names of moons. This is very much the meaning of the underlining of the name attribute in fragment (\ref{JupiterIoPernickity}). 

\mynote
We are very much stating the obvious of course but there is a pattern here and it is repeated over and over when instances of relationships are communicated  and the same pattern occurs more formally  and uniformly when instances of relationships are communicated in software systems and/or stored in data.

We will come back to the phrasing of relationship instances in the next section but first we look at the characteristics of referencing when some of the identifying features of an entity are relationships.

\subsection{Context and the Referencing of Entities}
\mynote
We examine how,  when some identifying features are relationships, the referencing 
--- the nature of the reference ---   
is impacted by the context within which the reference is being made. 
The reference is  a noun phrase quoting the values of identifying attributes
and with the number quoted depending on 
the context within which the reference is made.
What we see contributes to a later analysis --- the analysis of  how 
instances of a relationship can be conveyed, communicated or stored.
\subsubsection{Referencing Characters from Plays}
\mynote
 We use as an example the referencing of characters from  plays
 within the context of  the  dramatic arts
   as modelled earlier in figure \ref{dramaticArts1}.
We focus on these detail
\begin{equation*}
\input{\ImagesFolder/dramaticArtsCharacterFragment.tex}
\end{equation*}
as these are the ones relevant to the identification of entities 
of type character.

From this part of the model we see that playwrights are identified by name and that plays are identified by their titles within the context of the playwright they are written by. Therefore
\begin{itemize} 
\item without context, 
\begin{equation} 
\label{absolutePlayReferencing}
\text{\parbox{9cm}{a  play 
may be referenced by the \uline{title} of the play and the \uline{name} of the playwright it is \uwave{written by.}}}
\end{equation}
\end{itemize}
I have underlined  identifying attributes so as to draw attention to the number of them required.

\mynote
From inspecting the representation of the character type and in particular its identifying features then we see that:
\begin{itemize}
\item within the context of a specific play, 
\begin{equation} 
\label{absoluteCharacterReferencing}
\text{\parbox{9cm}{
a character may be referenced by their \uline{name}.}}
\end{equation}
Accordingly in the text of a play characters are referenced 
by name as for example in stage directions such as this one:  
\begin{equation*}
\text{\textit{Enter \rdash{Sebastian}.}}
\end{equation*}
\item within the context of a specific playwright (but with no particular play in mind), 
\begin{equation} 
\label{playwrightRelativeCharacterReferencing}
\text{\parbox{9cm}{
 a character from within a play 
may be referenced by their \uline{name} along with the \uline{title} of the play they are \uwave{in}.}}
\end{equation}
So in a discussion of our favourite Shakespearean characters  we might 
make reference to
\begin{equation*}
\text{\textit{\rdash{Sebastian} from \rdash{Twelfth Night}.}}
\end{equation*}
\item
without any context at all, 
\begin{equation} 
\label{absoluteCharacterReferencing}
\text{\parbox{9cm}{a character from within a play 
may be referenced by their \uline{name} along with the \uline{title} of the play they are \uwave{in} and the \uline{name} of the playwright it is \uwave{written by}.}}
\end{equation}
Thus, without context, three referentials are required for the referencing of a character
as  when I reference the following character:
 \begin{equation*}
\label{TounchstoneReferenceFromAbsolute}
\text{\parbox{9cm}{\textit{\rdash{Touchstone} from \rdash{Shakespeare}'s \rdash{As You Like It}. }}}
\end{equation*}
\end{itemize}

\begin{oldtt}
\begin{notebox}
In this example there were two identifying relationships arranged end to end. It was by looking at the subject type (character) and the two entity types reached directly and indirectly through the identifying relationships
 that I gathered the identifying attributes whose values are required as referentials. 
I mention this because there is the beginnings of a simple algorithm here by which entity models can be transformed to definitions of tabular structure.
\end{notebox}
\end{oldtt}

\subsubsection{Referencing Productions of Plays}
Now we move on to another area within the overall model of figure \ref{dramaticArts1}. From this detail 
\begin{equation*}
\input{\ImagesFolder/dramaticArtsProductionFragment.tex}
\end{equation*}
regarding the production entity type  we see that
\begin{itemize}
  \item
  without any context, 
  \begin{equation} 
\label{absoluteCharacterReferencing}
\text{\parbox{9cm}{a production can be referenced by referencing the play it is a production \uwave{of} 
  and by giving the \underline{name} of the venue  the production is \uwave{at} along with the \underline{season} 
  over which it plays.}}
\end{equation}
We have already seen that to reference a play requires two referentials and so
we can count up the number of referentials required to reference a production
  as one for the venue, two for the play and one for the season so four referentials in all. 
As an example consider the following prescription
\begin{erquote}
\parbox{9cm}{a production of \mbox{\rdash{Shakespeare}'s} \rdash{As You Like It}
 performed \mbox{\rdash{April – May 1975},} at \rdash{Oxford Playhouse}.}\\
\end{erquote}
As is to be expected in this description there are four referentials present.\footnote{
I found the literal description online as ``a production of the play As You Like It (by William Shakespeare), April – May 1975, at Oxford Playhouse''.  
} 
\end{itemize}
For entity types character and production we have been able to inspect the entity model diagram for identifying  attributes and relationships and from the inspection posit required referentials  for the referencing of entities of the type.
We need beware though becuase referencing doesn't always work out by simple aggregation. Because sometimes,
in the words of Shlaer and Lang, referentials collapse. 
To see this we are going to move on to another area within our model and look at how dramatic roles are identified and referenced.
 \subsubsection{Referencing Dramatic Roles}
\mynote
In figure \ref{dramaticArts1}, the entity type \textit{dramatic role} is
depicted, somewhat similar to an intersection entity, as shown having
two identifying relationships and no identifying attributes.
The relevant detail is  this
\begin{equation*}
\input{\ImagesFolder/dramaticArtsDramaticRoleFragment.tex}
\end{equation*}
We can interpret this detail as telling that
\begin{equation}
\label{DramaticRoleReferencing}
\text{\parbox{9cm}{to reference a dramatic role it is necessary  
to reference both a character and  a production.}}
\end{equation}

Now, as we have already discussed, characters from plays need be referenced using three referentials
and productions need be referenced using four referentials 
and so we can expect that, without context, a reference to
a dramatic role will require seven referentials
 --- three for the character and four for the production. 
So we will need seven, right?
 Well no, rather surprisingly, wrong! Only five referentials are required. 
 What happened to the other two? Can you examine the model in figure \ref{dramaticArts1} and figure this out?

That only five referentials are needed can be seen from this reference to a dramatic role:
\begin{erquote}
\parbox{9.0cm}{the role of \rdash{Touchstone} in the production of \mbox{\rdash{Shakespeare}'s} \rdash{As You Like It} performed \mbox{\rdash{April – May 1975},} at \rdash{Oxford Playhouse}.
}
\end{erquote}

To see why five only we have to spell out our declaration, (\ref{DramaticRoleReferencing}), in more detail
and declare more specifically that
\begin{equation}
\label{DramaticRoleReferencingRevised}
\text{\parbox{9cm}{To reference a dramatic role it is necessary 
to both reference a character \textbf{from a play} and to reference a production \textbf{of that same play}.}}
\end{equation}
It is because both the character and the production will be in relationship with the very same play
that in referencing a dramatic role, the referencing of the character and the referencing of
the production will not be independent
--- each of these two references --- the referencing of the character and the referencing of the production ---
 will include reference to the very same play --- but this reference need not be made twice. 
It is in describing a situation like this that Shlaer and Lang coined the term collapsed referentials. 
 When they coined the term they had in mind tabular database structure 
 but we have got to an understanding of the same phenomonon in our discussion here 
 of how referencing works in ordinary speech. 

 The conclusion I come to is that in an entity model it is pretty significant to specify more than we see in the diagram of relationships. We need to specify additional information such as, in the declaration above,
 is captured by qualifying as ``in the same path''. 

To see what form this additional information ought to take we have to focus on this detail 
% \begin{equation}
% \label{dramaticArtsPortrayalScopeReversedwithIds}
% \input{\ImagesFolder/dramaticRoleScopeReversedwithIds.tex}
% \end{equation}
of figure \ref{dramaticArts1}
and observe that the ``in the same path'' injunction is necessary
and appropriate just because in this diagram 
the two comparable paths from entity type dramatic role and entity type play are equivalent.
This is what we need specify in our entity model. It is beyond 
what is shown on the diagram of figure \ref{dramaticArts1}.
For now we can imagine annotating the diagram in some way to indicate that these two paths are equivalent 
or else specifying in a separate document or in a separate diagram. 
One way is to focus on diagram (\ref{dramaticArtsPortrayalScopeReversedwithIds}), 
as we have done, maybe to flip it around like this
\begin{equation}
\label{dramaticArtsPortrayalScopeAppearance1}
\input{\ImagesFolder/dramaticArtsPortrayalScope.tex}
\end{equation}
and to assert that this diagram commutes.

\begin{noteforfuture}
I might be able to get to the equivalence of paths by examining
a noun phrase involving seven referentials.

dramatic role is referenced by reference to production reference to play
\end{noteforfuture}

\subsection{Entity Models and Equivalent Paths}
However we specify it we should think of the specification of equivalent paths as 
an important supplement to the entity relationship diagram. 
We need to think that it is the totality of, 
at least,
the entity relationship diagram  plus the statement of path equivalences that comprises the entity model.

I don't expect the reader to be a mathematician but, for those readers that are, there is a quick way of saying this. 
For mathematicians, then,  the entity model is a presentation (or, equivalently, a sketch)
 of a category of some kind.  


\subsection{Naive Algorithm for Accumulation of Identifying Attributes}
Accumulate into the referential attributes the identifying attributes of the subject entity type
with all the referential attributes of all entity types reached by traversing an identifying relationship.
\subsection{Adjusted Algorithm for Accumulating of Identifying Attributes}
\commentary{referential accumulation algorithm}

Describe the algorithm.

Next need to refine this algorithm to take account of commutative relationships. 

To do use define paths of identifying relationships.
