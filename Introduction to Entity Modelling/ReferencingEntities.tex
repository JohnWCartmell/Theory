
\newcommand{\BarkerEllisIdentiyingRelationship}{\barkerEllisJ}

\section{Referencing Entities}
\label{ReferencingEntities}

 We now explore how the arrangement of identifying features of a type of entity guides us in the phrasing of references to instances of the type, 
 and how this, in turn, shapes the ways we convey, communicate, and store instances of relationships.
There is more to this than initially meets the eye.
Through examples, we will see that the existence of comparable paths that are equivalent 
(as described in Section \ref{comparisonOfPaths}) can affect how  some references are phrased.
Consequently, equivalence between paths has a direct impact on both the structure of data and on how simple, everyday facts are expressed.

This section is divided into subsections, each addressing one particular configuration of identifying features.
We begin with the simplest cases and proceed to examples involving branching chains of identifying relationships, and, in some cases, comparable or equivalent paths.
At each step, we examine how these affect the way that entities are referenced.

\subsection{Identifying Relationships and Nested References}

In what follows, references that other references depend on will generally be called subordinate references, 
and when a subordinate reference is literally contained within another --- in phrasing or structure --- we will describe it as nested.

We begin with a simple example in which there are two entity types, $A$ and $B$, connected by an identifying relationship
$A$ \BarkerEllisIdentiyingRelationship\ $B$.
The logic of identifying features dictates that in such a situation, a stand-alone reference to an entity of type $A$ includes, nested within it, a subordinate reference to an entity of type $B$  which, after the next example, we will see extends naturally when identifying relationships form a linear path.

\subsubsection{Example — Referencing an Entity of Type \textit{Play}}

Consider the type \textit{play} from the model of the dramatic arts introduced earlier in Figure~\ref{dramaticArts1..diagram}.
Its identifying features are its attribute \textit{title} and its identifying relationship \textit{written\_by}, relating each play to a playwright, as shown here:
\begin{equation*}
\input{\ImagesFolder/dramaticArtsPlayPlaywright..diagram.tex}
\end{equation*}
From this we see that a play is identified by its title together with a reference to the playwright it was written by.
Thus we may refer to:
\begin{equation}
\mbox{the play \textit{Twelfth Night} by playwright William Shakespeare}
\end{equation}
which, of course, can  be paraphrased as
\begin{equation}
\mbox{\textit{Shakespeare’s Twelfth Night}.}
\end{equation}

Either way, explicitly or implicitly, there is a reference to a play containing within it a nested reference to a playwright.
The nested reference may be omitted when the playwright is clear from context—for example, when listing Shakespeare’s comedies:
\textit{Twelfth Night, As You Like It, A Midsummer Night’s Dream}, and so on.
In general, however,
\begin{itemize}
\item without context,
\begin{equation}
\label{absolutePlayReferencing}
\text{\parbox{9cm}{
a play is referenced by a combination of the \uline{title} of the play and the \uline{name} of the playwright it is \uwave{written by.}
}}
\end{equation}
\end{itemize}
In this I have underlined the identifying attributes so as to highlight the number required in the reference --- three in ths case.


\begin{erboxedFigure}{H}{TwelfthNight}
{
An ER analysis of a two level reference to the play Twelfth Night --- this is an example of a reference with another reference nested within it.
}
\newcommand{\dashRefOne}{2pt 2pt}
\newcommand{\dashRelationship}{1pt 0pt}
\newcommand{\dashRefTwo}{1pt 1pt}
\newcommand{\synLabel}[3]
{
  \Rnode{#1}{\parbox[t]{#2cm}{\textit{#3}}}
}
\begin{tabular}{l}
the 
\Rnode{et}{\uline{play}}
\Rnode{attrvalue}{\rdash{Twelfth Night}}
\Rnode{relname}{\uwave{by}}
\Rnode{nestedref}{\rdot{playwright Shakespeare}} \\[1.5cm]

\synLabel{tagET}{1}{name of entity type}
\kern0.35cm\synLabel{tagAV}{1.65}{value of identifying attribute}
\kern0.35cm\synLabel{tagRN}{1.625}{name of identifying relationship}
\kern0.5cm\synLabel{tagNestedRef}{1.95}{\kern0.5cmnested \\reference to entity of type playwright}\\[0.5cm]
\syntag{\dashRefOne}{tagET}{0.9}{et}{0}
\syntag{\dashRefOne}{tagAV}{0.9}{attrvalue}{-0.5}
\syntag{\dashRefOne}{tagRN}{0.9}{relname}{0}
\syntag{\dashRefTwo}{tagNestedRef}{0.9}{nestedref}{0}
\end{tabular}
\end{erboxedFigure}

\subsection{Linear Arrangements of Identifying Relationships}
The logic described in the previous subsection can be applied iteratively.
There we considered one type of entity, $A$, identified by its own features together with an identifying relationship to another type, $B$.
Now suppose that $B$ itself has a single identifying relationship to a further type, $C$, and perhaps $C$ to another, and so on.
In such a case there is a path of identifying relationships emanating from a type --- the arrangement is linear and unbranched --- logic now dicates that
 references to instances of that type contain multiple levels of nesting.
You can think of these as Russian-doll-structured references: each reference encloses another, except the innermost, which contains no further nested reference.

\subsubsection{Example --- Postal Addresses}

A classic and intuitively familiar example of this linear nesting is the postal address. 
When we see an address written on an envelope, we’re looking at a data-like representation of iteratively nested references.

In practice, postal addresses vary in format, but however represented, they are references with multiple levels of nesting.
For instance a reference to a particular house will usually have nested within it a reference to a street, usually within this there is a reference to a town or city and
as discussed this may contain a reference to a state or province.  
The multiple levels of nesting of references follows from the
the chaining of identifying relationships in an arrangement
of entity types and relationships like this one in which there are four levels of nesting:
\begin{equation*}
\input{\ImagesFolder/postalAddressISO20022.tex}
\end{equation*}
\mynote
What I say regarding nesting of references in spoken English also applies, though arguably with some exceptions, when references are communicated in data.
The following has been given as an example of a message structure for a postal address and is represented as XML
\begin{verbatim}
<PstlAdr>
  <StrtNm>South LaSalle Street</StrtNm>
  <BldgNb>120</BldgNb>
  <PstlCd>60690-0834</PstlCd>
  <TwnNm>Chicago</TwnNm>
  <CtrySubDvsn>IL</CtrySubDvsn>
  <Ctry>US</Ctry>
</PstlAdr>
\end{verbatim}

\subsubsection{Example --- Referencing Characters from Plays}
\label{exampleReferencingCharacters}
\mynote
 As a second example, consider the referencing of characters from  plays
 within the context of  the  dramatic arts
  as modelled earlier in figure \ref{dramaticArts1..diagram}.

To understand the phrasing of such references we need focus only on the details shown in this fragment \commentary{should I use a linear variant this diagram?}
\begin{equation*}
\input{\ImagesFolder/dramaticArtsCharacterFragment..diagram.tex}
\end{equation*}

\mynote
From inspecting the representation of the character type and in particular its identifying features  we see that:
\begin{itemize}
\item within the context of a specific play, 
\begin{equation} 
\label{playContextualisedCharacterReferencing}
\text{\parbox{9cm}{
a character may be referenced by their \uline{name}.}}
\end{equation}
Accordingly in the text of a play characters are referenced 
by name as for example in stage directions such as:  
\begin{equation*}
\text{\textit{Enter \rdash{Sebastian}.}}
\end{equation*}
\item within the context of a specific playwright (but with no particular play in mind), 
\begin{equation} 
\label{playwrightRelativeCharacterReferencing}
\text{\parbox{9cm}{
 a character from within a play 
may be referenced by their \uline{name} along with the \uline{title} of the play they are \uwave{in}.}}
\end{equation}
So in a discussion of our favourite Shakespearean characters  we might 
make reference to
\begin{equation*}
\text{\textit{\rdash{Sebastian} from \rdash{Twelfth Night}.}}
\end{equation*}
\item
without any context at all, 
\begin{equation} 
\label{absoluteCharacterReferencing}
\text{\parbox{9cm}{a character from within a play 
may be referenced by their \uline{name} along with the \uline{title} of the play they are \uwave{in} and the \uline{name} of the playwright it is \uwave{written by}.}}
\end{equation}
Thus, without context, three referentials are required for the referencing of a character
as  when I reference the following character:
 \begin{equation}
\label{TouchstoneReferenceFromAbsolute}
\text{\parbox{9cm}{\textit{\rdash{Touchstone} from \rdash{Shakespeare}'s \rdash{As You Like It}. }}}
\end{equation}
\end{itemize}
In this we see a reference to a playwright nested within a reference to a play nested within a reference to a character from a play.



\subsection{Arrangements with Branching Paths of Identifying Relationships}
Now consider that a type $A$ may have multiple identifying relationships emanating from it so that there is a branching at $A$ in the
arrangement of identifying relationships.
In such a situation logic dictates that references to entities of type $A$ will have multiple references directly nested within them, one for each outgoing identifying relationship.
\commentary{ words for elsewhere: What isn't obvious is that in some cases the nested references overlap
and in some other cases  not so and the nested references overlap.} 
It would be natural to think that these nested references would be completely distinct so that though the Russian doll analogy breaks down it can be replaced by the nested box analogy --- open any box and there are multiple and distict boxes nested within it. 
We now give an example where this is so. Indeed it is necessarily the case provided that, as in the next example,
 among the branching paths of identifying relationships emanating from $A$ 
no two distinct paths are comparable or, in other words no two distinct paths of identifying relationships have a type in common other than $A$. 

\subsubsection{Example --- Productions of Plays}

\label{exampleReferencingProductions}

To find an example of example of this we just have to move on to another type within the overall model of the dramatic arts (figure \ref{dramaticArts1..diagram})
 --- the type \textit{production}. From the following detail 
\begin{equation*}
\input{\ImagesFolder/dramaticArtsProductionFragment..diagram.tex}
\end{equation*}
we see that
\begin{itemize}
  \item
  without any context, 
  \begin{equation} 
\label{absoluteProductionReferencing}
\text{\parbox{9cm}{a production can be referenced by referencing the play it is a production \uwave{of} 
  and by giving the \underline{name} of the venue  the production is \uwave{at} along with the \underline{season} 
  over which it plays.}}
\end{equation}
\end{itemize}
We have already seen that to reference a play requires two referentials and so
we can count up the number of referentials required to reference a production
as one for the venue, two for the play and one for the season so four referentials in all. 

For instance consider the following 
  \begin{equation} 
\label{referenceToAsYouLikeItProduction}
\text{\parbox{9cm}{the production of \mbox{\rdash{Shakespeare}'s} \rdash{As You Like It}
 performed \mbox{\rdash{April – May 1975},} at \rdash{Oxford Playhouse}.}
 }\\
\end{equation}
This references a production, and as expected, four referentials are present with in it.\footnote{
I found the literal description online as ``a production of the play As You Like It (by William Shakespeare), April – May 1975, at Oxford Playhouse''.  
} 

\subsection{Arrangements with Comparable Paths of Identifying Relationships}


Now consider the situation where a type $A$ has multiple paths of identifying relationships emanating from it, and two of these paths intersect in the sense that there is a type in common — $B$, say — between them (in addition to the branching point). The general arrangement of identifying relationships will then include two distinct paths from $A$ to $B$, which we can visualise as follows:

\begin{equation*}
\scalebox{\thumbnailscale}{
\input{\handCraftedImagesFolder/thumbnailA2BComparablePathsIdentifying}}
\begin{explanationForAI}
This diagram shows six entity types, four of which are anonymous. It has an entity type named A on the left and an entity type named B on the right. There are two paths of identifying relationships from A to B — an upper path and a lower path. Each path passes through two intermediate entity types. In all, there are six identifying relationships. The diagram is schematic, with ellipses on both paths indicating that their lengths are indeterminate.
\end{explanationForAI}
\end{equation*}

As we saw in the previous example, a reference to such an $A$ will have two subordinate references nested within it. In that example, the nested references were contiguous subphrases and distinct from each other — one was \textit{Shakespeare's Twelfth Night} and the other \textit{the Oxford Playhouse}. 

With the arrangement of identifying relationships as extended here, references to $A$ again have two subordinate references, but now with the additional feature that each subordinate itself includes a further subordinate reference to an entity of type $B$.  

However, since there are two paths from $A$ to $B$ --- the upper and the lower --- 
there are two ways of relating each $A$ to a particular $B$ and
we must consider the possibility that these two paths always lead to the same $B$; in other words, that the upper and lower paths may be equivalent. Significantly, if this is so, then in a reference to an $A$ there need be only a single subordinate reference to $B$. 

Since only one is needed, maintaining both is superfluous---there should be a single representative; this logic follows a general principle: 
unnecessary repetition is undesirable in ordinary speech and amounts to improper redundancy
in data (we will come back to good and bad data practices later). Consequently, when the two paths from $A$ to $B$ are equivalent, 
all references to $A$ should properly have two directly nested references that share a common subordinate reference to $B$. 
In such cases, even the nested-box analogy begins to break down because the nested references overlap and may no longer be contiguous. 
We shall illustrate this by giving two examples 
--- one where the analogy holds, and one where it does not
--- the key difference being the presence or absence of equivalent paths.

In both of the next two examples, the upper and lower paths are each of length two, so the arrangement can be visualised as follows:
\begin{equation*}
\scalebox{\thumbnailscale}{
\input{\handCraftedImagesFolder/thumbnailA2BShortComparablePathsIdentifying}}
\begin{explanationForAI}
This is a simplified version of the earlier diagram, with just four entity types and two paths of length two.
\end{explanationForAI}
\end{equation*}

In the very next example, the upper and lower paths (as visualised here) are equivalent; in the subsequent example, they are not.

 \subsubsection{Example --- Dramatic Role from Figure \ref{dramaticArts1..diagram}}
\mynote
This example is based on the dramatic role entity type from the model of the dramatic arts (figure \ref{dramaticArts1..diagram}).
We consider the identifying features  and in particular this specific detail:
\begin{equation*}
\input{\ImagesFolder/dramaticArtsDramaticRoleFragment..diagram.tex}
\end{equation*}
from within the model
and we consider how dramatic roles are to be referenced. 
We see the type \textit{dramatic role} 
with  two identifying relationships emanating from it and that it  has no identifying attributes;
this detail informs us that
\begin{equation}
\label{DramaticRoleReferencing}
\text{\parbox{9cm}{\textit{to reference a dramatic role it is necessary  
to reference both a character and  a production.}}}
\end{equation}

Now, as we have already discussed, \textit{character}s from plays need be referenced using three referentials
(section \ref{exampleReferencingCharacters})
and \textit{production}s need be referenced using four (section \ref{exampleReferencingProductions})
and so, from this, we can expect that, without context, a reference to
a dramatic role will require seven referentials
 --- three for the character and four for the production. 
So we will need seven, right?
 Well no, rather surprisingly, not so --- only five referentials are required. 
 What happened to the other two? 
In what follows, we will explore the answer to this question from a number of points of view;
one of them is mathematical in nature --- this point of view may or may not suit you depending on your background.

First though, that only five referentials are needed can be seen from this reference to a dramatic role in which I have dash underlined the referentials:
\begin{equation}
\label{theRoleOfTouchstone}
\text{
\parbox{8.0cm}{the role of \rdash{Touchstone} in the production of \mbox{\rdash{Shakespeare}'s} \rdash{As You Like It} performed \mbox{\rdash{April – May 1975},} at \rdash{Oxford Playhouse}.
}
}
\end{equation}

To see why five only we have to spell out our declaration, (\ref{DramaticRoleReferencing}), in more detail
and make something clear that couldn't be inferred from the diagram alone,  namely that
\begin{equation}
\label{DramaticRoleReferencingRevised}
\text{\parbox{9cm}{to reference a dramatic role it is necessary 
to both reference a character \textbf{from a play} and to reference a production \textbf{of that same play}.}}
\end{equation}
In this restatement of (\ref{DramaticRoleReferencing}) as (\ref{DramaticRoleReferencingRevised}) we make clear that in a reference to a dramatic role, the referenced character and the referenced production will be in relationship with the very same play
and that, consequently,  in referencing a dramatic role, the referencing of the character and the referencing of
the production will not be independent in that
each of these two references --- that to a character and that to a production ---
must require a subordinate reference to the very same play;  
these two, required subordinate references collapse to a single reference(see figure \ref{theRoleOfTouchstoneAnalysed}) --- 
the subordinate reference to a play need not be duplicated. 
Finally, as we have seen, a reference to a play consist of two referentials;
by requiring this subordinate reference only once, we save two referentials, which explains why only five  are required, not seven.

If we zoom out as far as this detail
\begin{equation}
\label{dramaticArtsPortrayalScopeFragment..diagram}
\input{\ImagesFolder/dramaticArtsPortrayalScopeFragment..diagram.tex}
\end{equation}
and see a bit more of the detail of figure \ref{dramaticArts1..diagram} we see that the entity type \textit{dramatic role}
has two comparable paths of identifying relationships  emanating from it that intersect at the type \textit{play}. 
Because of the
`in the same play prescription' these two comparable paths are equivalent. 
By applying the argument given earlier for such comparable paths that are equivalent,  it follows from this
that a reference to a dramatic role should properly contain one reference to a play, not two.

Note that if we were to violate prescription (\ref{DramaticRoleReferencingRevised}), 
and, therefore, ignore the equivalence of the two paths,
 --- for instance, by claiming that in a given season an actor appeared in a production
of  Ibsen's \textit{A Doll's House} at the Royal Exchange, Manchester, playing the role of Touchstone from Shakespeare's \textit{As You like It} --- the result would not merely be incorrect but nonsensical. If a data structure allowed such prescriptions as this then it would be said that the defining structure was not in normal-form ---  which in this case at least is as an innocent-looking way for saying admits of pure nonsense.

Situations like this were noticed long ago by Shlaer and Lang, 
who coined the term ‘collapsed referentials’.\footnote{Note that we are talking about referentials 
which \textit{a priori} collapse,
rather than contingently as when we a particular marriage might be identified as being between parties \textbf{of the same parish}}. They were working with tabular structures, whereas here we are exploring the phenomenon through the lens of phrasal structure. We will be going into formal detail, but for now the concept gives a sense of why the counting of referentials isn’t always straightforward. Later we will return to this idea and also introduce the related notion of ‘absent referentials’.

\begin{erboxedFigure}{H}{theRoleOfTouchstoneAnalysed}
{
A reference to a dramatic role has two nested references within it. 
One to an entity of type character: 
\begin{equation*}
\text{
T. in  Shakespeare's As You Like It
}
\end{equation*}
and one to an entity of type production, namely that of:
\begin{equation*}
\text{
\parbox{9.0cm}{Shakespeare's As You Like It performed Spring '75 at the OP.}
}
\end{equation*}
 In this example the nested references overlap. The overlap is Shakespeare's As You Like It --- a reference to a play that is subordinate to both of the two nested references.
}
\newcommand{\dashRefOne}{2pt 2pt}
\newcommand{\dashRelationship}{1pt 0pt}
\newcommand{\dashRefTwo}{1pt 1pt}
\begin{tabular}{l}
the role of 
\Rnode{w1}{\rdash{T}} in 
\Rnode{w2}{\rdot{\rdash{Shakespeare}}}’s 
\Rnode{w3}{\rdot{\rdash{As You Like It}}} performed 
\Rnode{w4}{\rdot{Spring '75}}, at 
\Rnode{w5}{\rdot{OP}} \\[1.4cm]
\kern2cm\Rnode{ref1}{\parbox[t]{1.95cm}{\textit{reference to entity of type character}}}
\kern3.0cm\Rnode{ref2}{\parbox[t]{1.95cm}{\textit{reference to entity of type production}}} \\[0.5cm]
\syntag{\dashRefOne}{ref1}{0.9}{w1}{0}
\syntag{\dashRefOne}{ref1}{0.9}{w2}{-0.2}
\syntag{\dashRefOne}{ref1}{0.9}{w3}{-0.2}
\syntag{\dashRefTwo}{ref2}{0.4}{w2}{0.2}
\syntag{\dashRefTwo}{ref2}{0.4}{w3}{0.3}
\syntag{\dashRefTwo}{ref2}{0.4}{w4}{0.3}
\syntag{\dashRefTwo}{ref2}{0.4}{w5}{0}
\end{tabular}
\end{erboxedFigure}

In conclusion, we see that, to fully account for reference structure, an entity model must go beyond what the relationship diagram alone conveys. It requires explicit prescriptions governing the use of its types and relationships, which can be captured through path equivalences. Historically, without such prescriptions, entity modelling provided only a partial explanation --- a gap that, in the realm of data modelling, was traditionally addressed by data normalisation. Incorporating path equivalences closes this gap, enabling a complete and coherent account of reference.

\subsubsection {Example 6 --- Route City State}


Not all comparable paths are equivalent. When they are not, subordinate references do not collapse automatically. Consider the following reference:

\begin{equation*}
\text{the route from Hot Springs, Arkansas to Jacksonville, Alabama.}
\end{equation*}

The types, relationships, and identifying features instantiated here can be visualised as:

\begin{equation*}
\input{\ImagesFolder/routeCityState..leftright..diagram.tex}
\end{equation*}

\mynote
As in the previous example, this reference has two nested references (to the origin and destination cities). These nested references themselves include a secondary reference — in this case, to the state. However, unlike the dramatic-role example, this secondary reference is not guaranteed to be shared between the two primary references. That is, the equivalence of paths that ensured automatic collapse in the prior example does not hold here. 

In other words, the following comparable paths are \textit{not equivalent}, which can be visualised as a non-commuting diagram:

\begin{equation*}
\input{\ImagesFolder/routeCityCityState..leftright..diagram.tex}
\end{equation*}

\textbf{Contingent versus \textit{a priori} collapse.}  

In this model, cities in different states are connected by routes. Occasionally, cities may happen to be in the same state. In such cases, it is possible—but not guaranteed—to collapse the shared referential for the state:

\begin{equation*}
\text{the route from Hot Springs, Arkansas to Jacksonville, Arkansas}
\end{equation*}

can be rephrased anaphorically as:

\begin{equation*}
\text{the route from Hot Springs, Arkansas to Jacksonville in the same state,}
\end{equation*}

or by collapsing the repeated referential:

\begin{equation*}
\text{the route in Arkansas from Hot Springs to Jacksonville.}
\end{equation*}

Since this collapsing depends on the actual data rather than being mandated by the model, we call it \textit{contingent} rather than \textit{a priori}. In contrast, the collapse in the dramatic-role example was guaranteed by equivalent paths. The distinction between a priori and contingent collapsing is worth making explicit because it clarifies what kind of structure an entity model provides. When a collapse is a priori, it arises from the model itself — from an equivalence of paths that ensures certain references must coincide. When it is contingent, the coincidence occurs only in the data.


\subsection{The Methodological Derivation Of Referentials}

Here we to look again at the dramatic arts example --- specifically at how the model of entity types and relationships,
together with the knowledge of this path equivalence:
\begin{equation}
\label{playedBy.Scope.asEquivalence}
r4 \comp d1 \;\equiv\; d2 \comp r2
\end{equation}
determines how entities
of the various types are to be referenced or represented in data. 
We revisit the examples (\ref{TouchstoneReferenceFromAbsolute}), (\ref{theRoleOfTouchstone}) and (\ref{referenceToAsYouLikeItProduction}).

Laying out the identifying features as we do in figure \ref{dramaticArtsRole..identificationScheme..diagramAgain} allows us
to see at a glance how the referentials arise.

\begin{erboxedFigure}{H}{dramaticArtsRole..identificationScheme..diagramAgain}
{Identification Scheme diagram for the dramatic role type
from the model of the dramatics arts (figure \ref{dramaticArts1..diagram}). This diagram doesn't add to the information
contained in that model, it simply represents the information regarding identifying features in a  different
 and for our purposes here, more convenient way. \textit{This diagram was shown earlier
in figure \ref{dramaticArtsRole..identificationScheme..diagram} and is reproduced here for ease of reference.}
} %end of caption
\begin{equation*}
\input{\ImagesFolder/dramaticArtsRole..identificationScheme..diagram.tex}
\end{equation*}
\end{erboxedFigure}

This identification-scheme diagram along with the path equivalence (\ref{playedBy.Scope.asEquivalence})
 \textit{fully} explains how entities are to be referenced — both in natural phrasing and in data representation.

\subsubsection{Referencing Characters from Plays}

From the diagram in figure \ref{dramaticArtsRole..identificationScheme..diagramAgain} 
we can quickly see that there are 3 paths from the type character on the diagram across to the right hand side of the diagram.
 
It isn't germane to what I am doing here but if we wish, we can put English descriptions to these paths:
\begin{center}
\begin{tabular}{c p{8cm}}
$a1$ & the name of the character \\
$d1 \comp a2$ & the title of the play the character is in \\
$d1 \comp r1 \comp a3$ & the playwright that the play the character is in is written by 
\end{tabular}
\end{center} 

In a reference to an entity of type character each of these paths must be filled by a referential, 
we can think of the three paths as determining slots that need to be filled  in the phrasing of a reference. 
In example (\ref{TouchstoneReferenceFromAbsolute}) these slots are filled as follows:


\begin{center}
\begin{tabular}{l l}
\textbf{Path}          & \textbf{Referential} \\
$d1 \comp r1 \comp a3$ & Shakespeare          \\
$d1 \comp a2$          & As You Like It       \\
$a3         $          & Touchstone
\end{tabular}
\end{center}

\subsubsection{Referencing Productions of Plays}

From the diagram in figure \ref{dramaticArtsRole..identificationScheme..diagramAgain} 
we can also see that there are 4 paths from the type production on the diagram
across to the right hand side of the diagram. 
As the paths get longer precise descriptions in English  get tortuous but we can convey the four paths as follows:
\begin{center}
\begin{tabular}{c p{8cm}}
$r2 \comp a2$           & the title of the play that the production is of\\
$r2 \comp r1 \comp a3$  & the name of the playwright the play ... was written by\\
$a4$                    & the season of the production\\
$r3 \comp a5$           & the name of the venue the production was at\\
\end{tabular}
\end{center} 

These correspond to the four referentials included in phrasal references or data references to entities of 
type production.
The referentials that instantiate these paths in 
the reference to a production of 
\textit{As You Like It} mentioned earlier in (\ref{referenceToAsYouLikeItProduction}) 
are\\
\newline
\begin{center}
\begin{tabular}{l l}
\textbf{Path}          & \textbf{Referential} \\
$r2 \comp r1 \comp a3$ & ``Shakespeare''       \\
$r2\comp a2$           & ``As You Like It''   \\
$a4$                   & ``April-May 1975''   \\
$r3 \comp a5$          & ``Oxford Playhouse''
\end{tabular}
\end{center}

This could be getting boring and repetitive but the next case, that of referencing dramatic roles, we have already seen breaks the pattern.

\subsubsection{Referencing Dramatic Roles}

There are seven ways of getting from the representation of type dramatic role at the left hand side of the diagram in figure \ref{dramaticArtsRole..identificationScheme..diagramAgain} to the right hand side. Naively, this implies seven referentials are required to reference a dramatic role, these corresponding to the following paths from left to right across the diagram:
\begin{displaymath}
\begin{array}{l c l}
\text{path 1:} &  & r4 \comp a1 \\
\text{path 2:} & & r4 \comp d1 \comp a2 \\
\text{path 3:} & & r4 \comp d1 \comp r1 \comp a3 \\
\text{path 4:} &  & d2 \comp r2 \comp a2 \\
\text{path 5:} &  & d2 \comp r2 \comp r1 \comp a3 \\
\text{path 6:} &  & d2 \comp a4 \\
\text{path 7:} &  & d2 \comp r3 \comp a5
\end{array}
\end{displaymath}

Now we an see the effect of the path equivalence.

Because 
\begin{equation}
\label{dramaticroleequivalence}
r4 \comp d1 \;\equiv\; d2 \comp r2
\end{equation}
then paths 1 and 3 do not determine distinct referentials but a single referential because
\begin{equation}
r4 \comp d1 \comp a2 \;\equiv\; d2 \comp r2 \comp a2
\end{equation} 
follows from (\ref{dramaticroleequivalence})
and likewise neither do paths 1 and 2 determine a single referential but a single one because
\begin{equation}
r4 \comp d1 \comp r1 \comp a3 \;\equiv\; d2 \comp r2 \comp r1 \comp a3
\end{equation}
also follows from (\ref{dramaticroleequivalence}).

The slots required in and phrasal or data representation of a reference to a dramatic role are thus
\begin{displaymath}
\begin{array}{l c l}
\text{slot 1:} &  & r4 \comp a1 \\
\text{slot 2:} &  & r4 \comp d1 \comp a2 = d2 \comp r2 \comp a2 \\
\text{slot 3:} &  & r4 \comp d1 \comp r1 \comp a3 = d2 \comp r2 \comp r1 \comp a3 \\
\text{slot 4:} &  & d2 \comp a4 \\
\text{slot 5:} &  & d2 \comp r3 \comp a5
\end{array}
\end{displaymath}
Slots 2 and  3 are collapsed referentials in the Shlaer-Lang terminology.

We can now see, in precise terms, how the a priori equivalences we discussed earlier translate into the collapsing of referentials.

\textbf{Mathematically} \commentary{I can probably develop this further so as to speak about the set of identifying slots for each type of entity. In the relational model each of these identifying slots corresponds to a primary key column.}

In categorical terms, each slot corresponds not to an individual path but to an equivalence class of paths — and these equivalence classes themselves form a category. The set of slots at a type in this category is a jointly monomorphic set of morphisms.

\subsection{Entity Models and Equivalent Paths}
\begin{worktt}
Path equivalences are essential if an entity model is to fully explain the structures it represents. 
This raises the methodological question: how should such equivalences be expressed within an entity model? 
Well we are not being prescriptive here about the precise way diagrams and accompanying information should be represented. Here are some thoughts though and they reflect the software tools that the author has used in the past.
\end{worktt} 
\mynote \commentary{Somewhere happen}
The recognition and explicit statement of such path equivalences are essential steps in closing the gap between modelling and data definition. They enable the model to serve not merely as a structural schema but as a full explanation of how references are to be phrased and how facts are to be expressed.
\mynote
In these examples we have shown that, however expressed,  the specifications of equivalent paths are
an important supplement to entity relationship diagrams. 
An entity model in the main part consists of at least an entity relationship diagram  
plus a statement of path equivalences.


As we have seen two subordinate references to a play are shared in all proper references to dramatic roles 
and this is because of
the equivalence of two particular paths of identifying relationships. 
Note that the simple existence of these comparable paths in the diagram of figure \ref{dramaticArts1..diagram}
does not imply their equivalence.

\commentary{fully understand this is one part of closing the gap that we spoke about in the introduction}
\commentary{To fully understand how references to dramatic roles are phrased we need to understand the equivalence of these two paths. If we don't fully understand then the entity model cannot guide us fully in the phrasing of facts 
regarding dramatic role should be represented in data. }
To understand the referencing of roles we need understand the equivalence of these two paths. 
So significant is this that the equivalence ought to be specified in the entity model in some way.
For now we can imagine annotating the diagram in some way to indicate that these two paths are equivalent 
or else specifying in a separate document or in a separate diagram. 
One way of specifying is by writing the equation
\begin{equation}
\label{dramaticArtsDramaticRolePathEquivalence}
r4 \comp d1 = d2 \comp r2
\end{equation}

Another way is to take diagram ((\ref{dramaticArtsPortrayalScopeFragment..diagram})), 
to flip it  around, and to draw  in this reduced form like this
\begin{equation}
\label{dramaticArtsPortrayalScopeAppearance1}
\input{\ImagesFolder/dramaticArtsPortrayalScope..diagram.tex}
\end{equation}
and to assert that this diagram commutes.

This is our preferred diagrammatic way of presenting equivalent paths in this book and we return to this subject in a later section where we refer to such a diagram as this as a scope diagram. 
We also in the habit of writing equations such as (\ref{dramaticArtsDramaticRolePathEquivalence}) on the entity relationships diagram itself.
We can think of dramatic roles coming into being when productions of plays are being cast. What the commutivity of this diagram expresses is when a production of a play is being cast then it is all characters from the play that are being cast not characters from plays in general. 
The relationship ``the portray of'', we say, is restricted in scope.



\subsection{Mathematically}
\mynote
I don't expect the reader to be a mathematician but, for those readers that are, 
an entity model in the main part is a presentation 
(or, equivalently, a sketch) of a category of some kind for the entity model diagram is a directed graph, 
the path equivalences are commuting diagrams. 
In this category, the identifying features are jointly monomorphic families of morphisms.
What we have seen in this section is that categorical structure lies behind what might seem like linguistic or representational questions.

