

\newcommand{\sect}{Sect}
\newcommand{\insect}[2]{#1 \in Sect(#2)}

\newcommand {\OO}{Ob^2}
\newcommand {\OOO}{Ob^3}
\newcommand {\OOOO}{Ob^4}
\newcommand{\HomOb}{\crossx{Hom}{Ob}{1}}
\newcommand{\fid}{\qq{id}}
\newcommand{\fcomp}{\qq{\circ}}

\newcommand{\leftidentitylhsterm}{({x_1}^*\qq{id})^*\tuple{x_1,x_1,x_2}^*\fcomp}
\newcommand{\rightidentitylhsterm}{({x_2}^*\qq{id})^*\tuple{x_1,x_2,x_2}^*\fcomp}
\newcommand{\HomHom}{\crossx{Hom}{Hom}{\OO}}

\newcommand {\yOOO}{\ofT{y_1,y_2,y_3}{Ob}}
\newcommand {\yOOOfH}{\yOOO,\,\ofT{f}{Hom(y_1,y_2)}}
\newcommand{\yOOOfHgH}{\yOOOfH,\,\ofT{g}{Hom(y_2,y_3)}}

\newcommand {\yOOOfHmapped}{\tuple{y_1,y_2}^*Hom}
\newcommand {\yOOOfHgHmapped}{\crossx{\yOOOfHmapped}{\tuple{y_2,y_3}^*Hom}{\OOO}}
\newcommand {\yOOOfHgHHmapped}{\crossx{\big(\yOOOfHgHmapped\big)}{{\tuple{y_1,y_3}^*Hom}}{\OOO}}

\iffalse

\note
Consider as an example
what constitutes an interpretation $I$ of the (generalised algebraic) theory of categories ($tc$) in some 
 contextual category \catc.
The sorts of $tc$ are $Ob$ and $Hom$ 
and an interpretation $I$ must map these to objects $I(Ob)$ and  $I(Hom)$ of \catc.
The operators symbols of
$tc$ are  $id$ and $\circ$ and these must be mapped by $I$ to sections $I(id)$ and $I(\circ)$ of \catc.

A useful simplication for the description that follows is to write $Ob$ for $I(Ob)$, $Hom$ for $I(Hom)$, $\qq{id}$ for $I(id)$ and   $\qq{\circ}$ for $I(\circ)$.   I will ask the reader  to distinguish for themselves 
those uses of `$Ob$' and `$Hom$' in reference to sorts of the theory $tc$ from those uses in reference to the interpretation of these sorts in the contextual category \catc. 

Because we want to explain and to some extent validate the definition of interpretation we will go through the
requirements on the interpretations of $Ob$, $Hom$, $id$ and $\circ$ in some detail.  For this purpose we
need make use of the stratification 
$tc_0 \subseteq tc_1 \subseteq tc_2 \subseteq tc_3 \subseteq tc_4$
of the theory of categories mentioned earlier\footnote{$tc_0$ is the empty theory, $tc_1$ has introductory rule 
$r_{Ob}$ of sort $Ob$, $tc_2$ has introductory rule $r_{Hom}$ of sort symbol $Hom$, $tc_3$ has introductory rules
$r_{id}$ for operator $id$ and  $r_\circ$ for operator $\circ$, $tc_4$ has the three axioms -- left and right identity and associativity.}.


\begin{enumerate}[$tc_1$]
\item By clause (i) of the definition of interpretation (case $n=1$), the sort $Ob$ must be mapped to an object $Ob$ of \catcw such that $1 \base Ob$ in \catc. Given this much, i.e. given the interpretation of the sort $Ob$ in the theory by such an object $Ob$ of the contextual category, then are able to interpret in \catcw any rule of the theory $tc_1$ i.e. any rule that can be derived solely from the introductory rule for $Ob$. 
In particular we can derive the rule \gatdisplayrule{\ofT{x}{Ob}}{\isT{Ob}} 
 and this is interpreted by $I$ (see earlier\commentary{\tbd})
 as the object $\OO$ in \catc . This rule is the one we need  have an interpretation of in \catcw in order to determine whether the interpretation of $Hom$ by $I$ is well-typed.

\item The sort $Hom$ of the theory $tc$ is introduced by the rule 
\gatdisplayrule{\ofT{x}{Ob},\, \ofT{y}{Ob}}{\isT{Hom(x,y)}} 
and therefore, given what we have said of the interpretation of rule 
\gatdisplayrule{\ofT{x}{Ob}}{\isT{Ob}}, 
by clause (i) of the definition of interpretation (case $n=1$), the sort $Hom$ must be mapped to some object of \catc,  which, as we have said, we denote $Hom$, such that $\crossx{Ob}{Ob}{1} \base Hom$ in \catc.

Once we have this interpretation of $Hom$ then we can interpret any derived rule of the theory $tc_2$ i.e.
any rule which can be derived from just the introductory rules
for $Ob$ and $Hom$. In particular we can derive the rules which 
the introductory rules of $\qq{id}$ and $\qq{\circ}$ rely on for their
well-typedness which are \gatdisplayrule{\ofT{x}{Ob}}{\isT{Hom(x,x)}} and
\gatdisplayrule{\ofT{y_1}{Ob},\, \ofT{y_2}{Ob},\,\ofT{y_3}{Ob},\, \ofT{f}{Hom(y_1,y_2)},\, \ofT{g}{Hom(y_2,y_3)} }{\isT{Hom(y_1,y_3)}}.
In fact it follows from something earlier (\tbd) that the first of these rules will be interpreted 
as the object ${\delta_{Ob}}^*Hom$ of \catcw and that the second of these rules will be interpreted by
the object $\yOOOfHgHHmapped$. 

\begin{equation*}
\begin{array}{c c}
\tuple{y''_1,y''_3}^*Hom         \\ [1cm]
\tuple{y'_2,y'_3}^*Hom           \\ [1cm]
\Rnode{e}{\yOOOfHmapped}         \\ [1cm]
\Rnode{d}{\OOO} & \Rnode{h}{Hom} \\ [1cm]
\Rnode{c}{\OO}                   \\ [1cm]
\Rnode{b}{Ob}                    \\ [1cm]
\Rnode{a}{1}           
\end{array}
\ncsar{g}{f}
\ncsar{f}{e}
\ncsar{e}{d}
\ncsar{d}{c}
\ncsar{c}{b}
\ncsar{b}{a}
\ncsar{h}{c}
\end{equation*}


\item 
From clause (ii) of the definition of interpretation and from the observations just  made, it
follows, since the interpretation $I$ must be well typed for operator symbols $id$,
that the operator symbol $id$ must be interpreted by $I$ as a section of the object $\delta_{Ob}^*Hom$ of \catcw
and we shall refer to as $\qq{id}$, so that $\qq{id} : Ob \morph {\delta_{Ob}}^*Hom$ of \catc. 

Now consider the operator symbol $\circ$ whose introcutory rule is
\gatdisplayrule{\yOOOfHgH}{\ofT{f \circ g}{Hom(z_1,z_3)}}.
Let $H_2$ be the premise $\yOOOfHgH$ then $H_2$ is mapped by $I$ to the object $yOOOfHgHmapped$ of \catc.
Let $\qq{H_2}$ be this object. 
 

Likewise for $I$ to be well-typed on the introductory rule for $\circ$, the operator symbol $\circ$ must be interpreted by $I$ as a section of the object 
$\yOOOfHgHHmapped$ of \catcw 
where $y_1,y_2,y_3$ are the projection morphisms $y_1,y_2,vy_3: \OOO \morph Ob$ defined earlier (\tbd\footnote{
$y_1: \OOO \morph Ob$ is defined to be $p_{\OOO} \circ p_{\OO}$ \\
$y_2: \OOO \morph Ob$ is defined to be $p_{\OOO} \circ q(p_{Ob},Ob)$\\
$vy_3: \OOO \morph Ob$ is defined to be $q(p_{\OO},Ob)$
}) and we shall refer to it as $\qq{\circ}$ so that we have $\qq{\circ}: \yOOOfHgHmapped \morph \yOOOfHgHHmapped$ in \catc.
At this stage we are now able to interpret any derived rule of the theory $tc3$ i.e. any rule 
which can be derived just from the introductory rules for $Ob, Hom, id and \circ$. In particular we can
interpret the left and right sides of the three axioms. In fact we will have: 

 
\item % tc_4
\end{enumerate}
\fi


\newcommand{\gatinterpretationcontext}[1]{&\multicolumn{5}{p{15cm}}{#1}}

%\newcommand{\gatinterpretationwhere}[1]{&\multicolumn{5}{r}{\parbox{12cm}{#1}}}
\newcommand{\compfour}{\tuple{y_1,y_2}^*Hom}
\newcommand{\compfive}{\tuple{\dot y_2,\dot y_3}^*Hom}
\newcommand{\compsix}{\tuple{\ddot y_1,\ddot y_3}^*Hom}

\newcommand{\associativitypremise}
       {\ofT{z_1,z_2,z_3,z_4}{Ob},\,
                                \ofT{f}{Hom(z_1,z_2)},\,\ofT{g}{Hom(z_2,z_3)},\,\ofT{h}{Hom(z_3,z_4)}}
																
\newcommand{\associativitypremisepoppopmapped}{\tuple{z_1,z_2}^*Hom}

\newcommand{\associativitypremisepopmapped}{	\crossx{\associativitypremisepoppopmapped}
																									   {\tuple{z_2,z_3}^*Hom} 
                                                     {Ob^4}
																					 }														
\newcommand{\associativitypremisemapped}{\crossx 
                                            {\big(\associativitypremisepopmapped \big)}
																						{\tuple{z_3,z_4}^*Hom} 
																						{Ob^4}  
																				 }

\newcommand{\associativitylhstype}{\isT{{Hom(z_1,z_4)}}}
\newcommand{\associativitylhstypemapped}{\crossx{\Big(\associativitypremisemapped\Big)}
                                        {\tuple{\dddot z_1,\dddot z_4}^*Hom}{Ob^4}}
\newcommand{\associativitylhstermtyping}{\ofT{(f \circ g) \circ h}{Hom(z_1,z_4)}}
\newcommand{\associativityrhstermtyping}{\ofT{f \circ (g \circ h)}{Hom(z_1,z_4)}}	

\newcommand {\assocfogmapped}{\tuple{\dddot z_1,\dddot z_2,\dddot z_3,f,g}^*\fcomp }
\newcommand {\assochmapped}{s(id_{\associativitypremisemapped})}
\newcommand {\assoclhsmapped}{\tuple{z_1,z_3,z_4,\assocfogmapped,\assochmapped}^*\fcomp}

\iffalse AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA

\begin{table}[H]
\caption{Deriving what constitutes an intepretation of the theory of categories $tc$ in a contextual category \catc.
Part One - Introductory rules for $Ob$, $Hom$ and $id$.
}
\label{internalcategorytableone}
%\setlength{\arrayrulewidth}{1mm}
\setlength{\tabcolsep}{2pt}
\begin{tabular}{l l  c  p{0cm} l  l}
\multicolumn{2}{l}{Derived Rule} &&& Interpretation by $I$ in \catcw & Reason why\\
\hline
\gatinterpretationintro {obintro}{}{\isT{Ob}}{Ob \in Cover(1)}{(i)}                                   \\
\gatinterpretationdetail{homintrohelper}{\ofT{x_1}{Ob}}{\isT{Ob}}{Ob^2 \in Cover(Ob)}
                                                               {(v) and (\lref{obintro})}             \\
\gatinterpretationintro {homintro}{\ofT{x_1}{Ob},\ofT{x_2}{Ob}}{\isT{Hom}}{Hom \in Cover(Ob^2)}
                                                               {(i) and (\lref{homintrohelper})}      \\
\gatinterpretationdetail{idintrohelperhelper}{\ofT{x}{Ob}}{\ofT{x}{Ob}}{s(id_{Ob})}
                                                               {(ii)(b) and (\lref{homintrohelper})}  \\
\gatinterpretationdetail{idintrohelper}{\ofT{x}{Ob}}
                                 {\isT{Hom(x,x)}}{s(id_{Ob})^*Hom }
                                 {(vii) (\lref{homintro}) and (\lref{idintrohelperhelper})}           \\
\gatinterpretationintro {idintro}{\ofT{x}{Ob}}{\ofT{id(x,x)}{Hom(x,x)}} 
                                 {\fid \in Sect(s(id_{Ob})^*Hom) }
                                 {(ii)and (\ref{idintrohelper})}                                      \\
\end{tabular}
\end{table}



\begin{table}[H]
\caption{Deriving what constitutes an intepretation of the theory of categories $tc$ in a contextual category \catc.
Part Two Introductory rule for $\circ$. Indication of the reasoning is not included due to lack of space. 
The reasoning follows the patterns indicated in accompanying tables \ref{internalcategorytableone} and \ref{internalcategorytablethree}.
}
\label{internalcategorytabletwo}
Define $y_1 : \OOO \morph Ob$ in \catcw  by $y_1 = p_{\OOO,Ob}$ 
and define $y_i : \OOO \morph Ob$, for $i = 2,3$,  by $y_i = p_{Ob^3,Ob^i}\circ q(p_{Ob^i},Ob)$.

Define  $\dot y_i : \compfour \morph Ob$ in \catc, for $i = 1, 2,3$, 
                                           by $\dot y_i = p_{\compfour}\circ y_i$.	
%\setlength{\arrayrulewidth}{1mm}
\setlength{\tabcolsep}{2pt}
\begin{tabular}{l l  c  p{0cm} l  l}
\hline
\multicolumn{2}{l}{Derived Rule} &&& Interpretation by $I$ in \catcw \\
\hline
\gatinterpretationdetail{comp1}{\ofT{x_1,x_2}{Ob}}{\isT{Ob}}{ \OOO \in Cover(\OO) }{}              \\
\gatinterpretationdetail{comp2}{\ofT{y_1,y_2,y_3}{Ob}}{\isT{Hom(y_1,y_2)}}{ \compfour \in Cover(\OOO) }{} \\
\gatinterpretationdetail{comp3}{\ofT{y_1,y_2,y_3}{Ob}, \ofT{f_1}{Hom(y_1,y_2)}}{\isT{Hom(y_2,y_3)}}
                        {  \compfive \in Cover(\compfour) }{} \\
\gatinterpretationdetail{comp4}{\ofT{y_1,y_2,y_3}{Ob}, \ofT{f}{Hom(y_1,y_2)},\ofT{g}{Hom(y_2,y_3)}} {\isT{Hom(y_1,y_3)}}
                        { \compsix \in Cover(\compfive) }{} \\
\gatinterpretationintro {compintro}	{\ofT{y_1,y_2,y_3}{Ob}, \ofT{f}{Hom(y_1,y_2)},\ofT{g}{Hom(y_2,y_3)}} 
                                    {\ofT{f \circ g}{Hom(y_1,y_3)}}
																    {\fcomp \in Sect(\compsix)}
\end{tabular}
\end{table}


\begin{table}[H]
\caption{Deriving what constitutes an intepretation of the theory of categories $tc$ in a contextual category \catc.
Part Three. The right identity axiom.
}
\label{internalcategorytablethree}
%\setlength{\arrayrulewidth}{1mm}
\setlength{\tabcolsep}{2pt}
\begin{tabular}{l l  c  p{0cm} l  l}
\gatinterpretationcontext{Let $P$ be the context $\ofT{x_1}{Ob},\,\ofT{x_2}{Ob},\,\ofT{f}{Hom(x_1,x_2)} $
                                 then $ P \mapsto Hom \in Cover(Ob^2)$.} \\
\gatinterpretationcontext{	 Define morphisms $\rule[-10pt]{0pt}{30pt}\Rnode{Hom}{Hom} \hspace{1cm} \Rnode{Ob}{Ob}$ 
               \ncline[nodesepA=5pt,nodesepB=5pt,offsetA=3pt,offsetB=3pt,arrowsize=5pt,arrowinset=0.7]{->}{Hom}{Ob}
							 \alabel{x_1}
							 \ncline[nodesepA=5pt,nodesepB=5pt,offsetA=-3pt,offsetB=-3pt,arrowsize=5pt,arrowinset=0.7]{->}{Hom}{Ob}
							 \blabel{x_2}
							  in \catcw by $x_1 = p_{Hom,Ob}$ and $x_2=p_{Hom,Ob^2}\circ q(p_{Ob},Ob)$.
							           } \\
\hline
\multicolumn{2}{l}{Derived Rule} &&& Interpretation by $I$ in \catcw & Reason why\\
\hline
\gatinterpretationdetail{hom1}{P}{\isT{Ob}}{ \HomOb \in Cover(Hom) }{(v), (\lref{Pcontext}) and (\ref{obintro})}              \\
\gatinterpretationdetail{hom2}{P}{\ofT{x_1}{Ob}}{ s(p_{Hom,Ob}) \in Section(\HomOb) }{(ii)(b)}                    \\
\gatinterpretationmapeqv        {s(x_1)}                                            {defn. of $x_1$}             \\
\gatinterpretationdetail{hom3}{P}{\ofT{x_2}{Ob}}{ s(p_{Hom,Ob^2}) \in Section(\HomOb) }{(ii)(b)}                  \\
\gatinterpretationmapeqv        {s(x_2)}                                            {defn. of $x_2$}             \\
\gatinterpretationdetail{hom4}{P}{\isT{Hom(x_1,x_1)}}{ \duple{s(x_1),s(x_1}^*Hom \in Cover(Hom) }
                                                                                      {(vii), (\lref{homintro}) and (\ref{hom2})}   \\
\gatinterpretationmapeqv                           {\tuple{x_1,x_1}^*Hom}             {lemma \lref{thedupletuplelemma}} \\
\gatinterpretationdetail{hom5}{P}{\ofT{id(x_1)}{Hom(x_1,x_1)}}
                               {\duple{s({x_1})}^*\fid \in Sect(\tuple{x_1,x_1}^*Hom) }{(viii), (\lref{idintro}) and (\ref{hom2})}  \\
\gatinterpretationmapeqv       {{x_1}^*\fid}                                           {lemma \lref{thedupletuplelemma}} \\
\gatinterpretationmapeqv       {s(x_1\circ \fid)}                                      {lemma \lref{sfglemma} check}     \\
\gatinterpretationdetail{hom6}{P}{\ofT{f}{Hom(x_1,x_2)}}{s(id_{Hom}) \in Sect(\HomHom) }{(ii)(b)}                         \\
\gatinterpretationdetail{hom7}{P}{\ofT{id(x_1) \circ f}{Hom(x_1,x_2)}}
                                {\duple{s(x_1),s(x_1),s(p_{Hom,\OO}),s(x_1\circ \fid),s(id_{Hom})}^*\fcomp  }
																                                       {(viii), (\ref{hom2}),(\ref{hom3}) and (\ref{hom8})}  \\
																&&&&\hspace{4.5cm}$\in Sect(\HomHom)$&(viii)                                             \\
\gatinterpretationmapeqv        {\tuple{x_1,x_1,x_2,x_1\circ \fid,id_{Hom}}^*\fcomp}
                                                                    {lemma \lref{thedupletuplelemma} and defn. of $x_2$} \\
\gatinterpretationaxcond{tcaxiomone}{P}{\ofT{id(x_1) \circ f}{Hom(x_1,x_2)=f}}
                                       {\tuple{x_1,x_1,x_2,x_1\circ \fid,id_{Hom}}^*\fcomp=s(id_{Hom})}{}                 \\
\gatinterpretationaxeqv{\tuple{x_1,x_1,x_2,x_1\circ \fid,id_{Hom}} \circ \fcomp \circ q(p_{\tuple{\ddot y_1,\ddot y_3}},Hom)=id_{Hom}}
                       {lemma \lref{sfglemma} CHECK and put this in separate lemma}
\end{tabular}
\end{table}

\newpage


\begin{table}[H]
\caption{Deriving what constitutes an intepretation of the theory of categories $tc$ in a contextual category \catc.
Part Four. Associativity axiom.
}
\label{internalcategorytablefour}
%\setlength{\arrayrulewidth}{1mm}
\setlength{\tabcolsep}{2pt}
\begin{tabular}{l l  c  p{0cm} l  l}
\gatinterpretationcontext{Let $Q$ be the context $\associativitypremise$} \\
\gatinterpretationcontext{then $Q \mapsto \associativitypremisemapped \in Cover(\associativitypremisepopmapped)$ in \catc.} \\
\gatinterpretationcontext{	 Define morphisms $\rule[-10pt]{0pt}{30pt}\Rnode{Hom}{Hom} \hspace{1cm} \Rnode{Ob}{Ob}$ 
               \ncline[nodesepA=5pt,nodesepB=5pt,offsetA=3pt,offsetB=3pt,arrowsize=5pt,arrowinset=0.7]{->}{Hom}{Ob}
							 \alabel{x_1}
							 \ncline[nodesepA=5pt,nodesepB=5pt,offsetA=-3pt,offsetB=-3pt,arrowsize=5pt,arrowinset=0.7]{->}{Hom}{Ob}
							 \blabel{x_2}
							  in \catcw by $x_1 = p_{Hom,Ob}$ and $x_2=p_{Hom,Ob^2}\circ q(p_{Ob},Ob)$.
							           } \\
\hline
\multicolumn{2}{l}{Derived Rule} &&& Interpretation by $I$ in \catcw & Reason why\\
\hline
\gatinterpretationdetail{assoc1}{Q}{\ofT{f \circ g}{Hom(z_1,z_3)}}
                                   { \assocfogmapped \in Sect(\tuple{\dddot z_1,\dddot z_3}^*Hom) }
																	 {}              \\
\gatinterpretationdetail{assoc2}{Q}{\ofT{h}{Hom(z_3,z_4)}}{\assochmapped}{}         \\
\gatinterpretationdetail{assoc3}{Q}{\associativitylhstermtyping}{\assoclhsmapped}{} \\
\gatinterpretationdetail{assoc4}{Q}{\associativityrhstermtyping}{TBD}{}            \\
\gatinterpretationdetail{assocxx}{Q}{\associativitylhstype}{\associativitylhstypemapped}{} \\
\end{tabular}
\end{table}

\fi %AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
%\ncarc[arcangle=#1,nodesepA=5pt,nodesepB=5pt,offsetA=#2pt,offsetB=#2pt,arrowsize=5pt,arrowinset=0.7]{->}{#3}{#4}

\newcommand{\ncarrNEGZZ}[3][0]{\ncarc[arcangle=#1,nodesepA=2pt,nodesepB=2pt,offsetA=-2pt,offsetB=-2pt,arrowsize=5pt,arrowinset=0.7]{->}{#2}{#3}}
\newcommand{\ncarrZ}[3][0]{\ncarc[arcangle=#1,nodesepA=2pt,nodesepB=2pt,offsetA=0pt,offsetB=0pt,arrowsize=5pt,arrowinset=0.7]{->}{#2}{#3}}
\newcommand{\ncarrZZ}[3][0]{\ncarc[arcangle=#1,nodesepA=2pt,nodesepB=2pt,offsetA=2pt,offsetB=2pt,arrowsize=5pt,arrowinset=0.7]{->}{#2}{#3}}
\newcommand{\ncarrZZZ}[3][0]{\ncarc[arcangle=#1,nodesepA=2pt,nodesepB=2pt,offsetA=4pt,offsetB=4pt,arrowsize=5pt,arrowinset=0.7]{->}{#2}{#3}}
\newcommand{\ncarrZZZZ}[3][0]{\ncarc[arcangle=#1,nodesepA=2pt,nodesepB=2pt,offsetA=6pt,offsetB=6pt,arrowsize=5pt,arrowinset=0.7]{->}{#2}{#3}}



\newcommand{\ccsquare}
{\begin{displaymath}
\begin{array}{cp{.9cm}c}
\Rnode{fstarz}{f^*z} & & \Rnode{z}{z}\\ [1.2cm]
\Rnode{x}{x}         & & \Rnode{y}{y}
\end{array}
\end{displaymath}
\ncbsar{p_{f \sub z}}{fstarz}{x}
\jcbarr{f}{x}{y}
\ncaarr{q(f,z)}{fstarz}{z}
\ncasar{p_z}{z}{y}
}

\newcommand{\ccsquareoutline}[6]
{\begin{array}{cp{#1}c}
\Rnode{TL}{#3}  & &  \Rnode{TR}{#4}\\ [#2]
\Rnode{BL}{#5}  & &  \Rnode{BR}{#6}
\end{array}
}
\newcommand{\ccsquareacross}[2]
{\ncarr{TL}{TR}
\alabel{#1}
\ncarr{BL}{BR}
\blabel{#2}
}
\newcommand{\ccsquaredown}[2]
{\ncsar{TL}{BL}
\blabel{#1}
\ncsar{TR}{BR}
\alabel{#2}
}



\begin{equation*}
\ccsquareoutline{2.5cm}{1.2cm}{\associativitypremisemapped}{Hom}{\OOOO}{\OO}
\mbox{
\nccdar{TL}{BL}
\ncsar{TR}{BR}
\ccsquareacross{f}{\tuple{\dddot z_1, \dddot z_2}}
}
\end{equation*}

\newcommand{\ccplaceholder}{\rule[-0.2cm]{0cm}{0.6cm}\kern0.2cm}

\newcommand{\rightend}[1] { \kern-0.2cm\Rnode{#1} {\ccplaceholder} }

\begin{equation*}
\begin{array}{r  p{4cm} c}
\associativitypremisemapped  =  \tuple{\ddot z_1,\ddot z_2}^*Hom  \rightend{Q}                    \\ [1cm]
\associativitypremisepopmapped  =  \tuple{\dot z_1,\dot z_2}^*Hom \rightend{Qp}                   \\ [1cm]
\associativitypremisepoppopmapped                                 \rightend{Qpp}                  \\ [1cm]
\OOOO                                                             \rightend{O4} && \Rnode{Ob}{Ob}              
\end{array}
\mbox{
\ncsar{Q}{Qp}
\ncsar{Qp}{Qpp}
\ncsar{Qpp}{O4}
\ncarr{Q}{Ob}
\alabel{\dddot z_i}
\ncarr{Qp}{Ob}
\alabel{\ddot z_i}
\ncarr{Qpp}{Ob}
\alabel{\dot z_i}
\ncarr{O4}{Ob}
\alabel{z_i}
}
\end{equation*}


\begin{newtt}
\begin{equation*}
\begin{array}{r c p{4cm} c}
\associativitypremisemapped        \kern-1cm & \Rnode{Q}{\cdot}             \\ [1cm]
\associativitypremisepopmapped     \kern-1cm &\Rnode{Qp}{\cdot}          \\ [1cm]
\associativitypremisepoppopmapped  \kern-1cm & \Rnode{Qpp}{\cdot}      \\ [1cm]
&\Rnode{O4}{\OOOO}                                         \\ [1cm]
&\Rnode{O3}{\OOO}            & & \Rnode{H}{Hom}            \\ [1cm]
&\Rnode{O2}{\OO}             & & \Rnode{Hp}{\OO}           \\ [1cm]
&\Rnode{O}{Ob}               & & \Rnode{Hpp}{Ob}           \\ [1cm]
&\Rnode{abs}{1}           
\end{array}
\mbox{
\ncsar{Q}{Qp}
\ncsar{Qp}{Qpp}
\ncsar{Qpp}{O4}
\ncsar{O4}{O3}
\ncsar{O3}{O2}
\ncsar{O2}{O}   
\ncsar{O}{abs}
\ncsar{H}{Hp}
\ncsar{Hp}{Hpp}
\ncsar{Hpp}{abs}
\ncarrNEGZZ[-10]{Q}{H}    \alabel{f}
\ncarrZ{Q}{H}             \alabel{g}
\ncarrZZ[10]{Q}{H}        \alabel{h}
\ncarrNEGZZ[-10]{O4}{Hpp} \alabel{z_1}
\ncarrZ{O4}{Hpp}          \alabel{z_2}
\ncarrZZ[10]{O4}{Hpp}     \alabel{z_3}
\ncarrZZZ[20]{O4}{Hpp}    \alabel{z_4}
%\ncarrZZZZ{O4}{Hpp}
}
\end{equation*}

\end{newtt}

\begin{oldtt}
$$
\ccsquareoutline{3cm}{1.2cm}{A}{B}{C}{D}
\mbox{
\ccsquareacross{f}{g}
\ccsquaredown{p_A}{p_B}
}
$$
\end{oldtt}




