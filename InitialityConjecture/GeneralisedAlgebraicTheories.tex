\newcommand{\inlinedisplay}[1]
{
\setlength{\fboxsep}{1.5pt}
\setlength{\fboxrule}{0pt}
\fbox{$\displaystyle #1$}
}

\newcommand{\gatdisplayrule}[2]
{
\setlength{\fboxsep}{1pt}
\setlength{\fboxrule}{0pt}
\fbox{$\displaystyle \frac{#1}{#2}$}
}
\newcommand{\Isort}{I_{sort}}
\newcommand{\Iop}{I_{op}}
\newcommand {\Ihat}{\hat{I}}

% workaround when used with Rnode for size of font used under the cross
\renewcommand{\crossx}[3]{#1 \underset{\tiny #3}{\cross} #2}
\newcommand{\fonestar}   {{f_1}\kern-.15em^*}
\newcommand{\ftwostar}   {{f_2}\kern-.15em^*}
\newcommand{\fjstar}     {{f_j}\kern-.2em^*}
\newcommand{\fjpstar}    {{f_{j-1}}\kern-.25em^*}
\newcommand{\smstar}{{s_m}\kern-.25em^*}
\newcommand{\sonestar}{{s_1}\kern-.15em^*}

\newcommand{\Trule} {T-rule\ }
\newcommand{\trule} {$\in$-rule\ }
\newcommand{\Teqrule} {T=-rule\ }
\newcommand{\teqrule} {$\in=$-rule\ }

\newcommand{\genericAintroductoryrule} {\gatdisplayrule{\xDelta{n}}{\isT{A(\xn}}}
\newcommand{\genericfintroductoryrule}  {\gatdisplayrule{\xDelta{n}}{\ofT{f(\xn}{\Delta}}}




\note
We give the broadest possible notion of `model
of a generalised algebraic theory \gatUw' by defining the notion of an `interpretation of  a generalised algebraic theory \gatUw in a contextual category \catc'.
\note To make the definition precise I use material from my thesis  \cite{Cartmell78} which isn't contained in
the summary that I  published as \cite{Cartmell86} and so I summarise it here.
\note 
In my thesis (\cite{Cartmell78}) and as written up in \cite{Cartmell86}, I define what it is for a rule written in the alphabet of a generalised algebraic theory to be \term{well-formed}. Here I will use the adjective \term{well-typed} instead.
With this revised terminology, definition 2(a) from \cite{Cartmell86}, states that in  a generalised algebraic theory \gatUw:
\begin{enumerate} [(i)]
\item 
a \Trule \gatdisplayrule{\xDelta{n}}{\isT{\Delta}} is well-typed  iff 
$\xDelta{n}$ is a context in \gatUw i.e. iff 
\gatdisplayrule{\xDelta{n-1}}{\isT{\Delta_n}} is a derived rule of \gatUw and $x_n$ is distinct from all of $x_1,...x_{n-1}$, 
\item 
an \trule \gatdisplayrule{\xDelta{n}}{\ofT{t}{\Delta}} is well-typed iff
the rule \gatdisplayrule{\xDelta{n}}{\isT{\Delta}} is a derived rule of \gatU,
\item 
a \Teqrule \gatdisplayrule{\xDelta{n}}{\Delta=\Delta'} is well-typed iff
both \gatdisplayrule{\xDelta{n}}{\isT{\Delta}} and \gatdisplayrule{\xDelta{n}}{\isT{\Delta'}} are derived rules
of \gatU,
\item 
an \teqrule \gatdisplayrule{\xDelta{n}}{t=t' \in \Delta} is well-typed iff
both \gatdisplayrule{\xDelta{n}}{\ofT{t}{\Delta}} and \gatdisplayrule{\xDelta{n}}{\ofT{t'}{\Delta}} are derived rules
of \gatU.
\end{enumerate}
In \cite{Cartmell78} and \cite{Cartmell86}, a \term{pretheory} (which is defined as a collection of symbols each with an introductory rule and a set of axioms) is defined to be \term{well-typed} iff all its introductory rules and axioms are. A \term{generalised algebraic theory} is defined to be a well-typed pretheory.

\note In my thesis there are a number of housekeeping lemmas which are aimed at showing that the formal definitions inclusive of the `principles of derivation' (\cite{Cartmell78}, \cite{Cartmell86}) work out as they ought to. Some of these lemmas are summarised in \cite{Cartmell86} but not all of them. Here I will summarise each one of them and name those that were previously unnamed. In the following, assume that \gatUw is a generalised algeabraic theory.

\note The Substitution Lemma: In brief, every type-correct substitutional instance of a derived rule is a derived rule. More precisely, for $m \geq 1$, if \gatdisplayrule{\yOmega{m}}{Conclusion} is a derived rule of \gatUw 
and if  \foreachj, \gatdisplayrule{Q}{\ofT{s_j}{\Omega_j[s_1|y_1,...s_{j-1}|y_{j-1}]}} is a derived rule of \gatUw
then \gatdisplayrule{\yOmega{m}}{Conclusion[s_1|y_1,...s_m|y_m]} is a derived rule of \gatU, where
for any expression $expr$ we write
$expr[s_1|y_1,...s_m|y_m]$ to mean
the result of substituting each instance of variable $y_j$ in $expr$ by $s_j$, \foreachj.

\note The Well-Typedness Lemma\footnote{Lemma on page 1-33 of \cite{Cartmell78}}. Every derived rule of \gatUw is well-typed. 

\note The Derivation Lemma\footnote{page 1.34 of \cite{Cartmell78}}. 
\begin{enumerate}[(a)]

\item Every derived \Trule of \gatUw is of the form
\gatdisplayrule{\yOmega{m}}{\isT{A(\tn)}} for some sort symbol $A$ of \gatUw with introductory rule of the form
\gatdisplayrule{\xDelta{n}}{\isT{A(\xn)}} and for some expressions $\tn$ such that \foreachi, the rule
\gatdisplayrule{\yOmega{m}}{\ofT{t_i}{\Delta_i[t_1|x_1,...t_{i-1}|x_{i-1}]}} is a derived rule of \gatU.

\item Every derived \trule of \gatUw is of the form
\gatdisplayrule{\yOmega{m}}{\ofT{f(\tn)}{\Omega}} for some operator symbol $f$ of \gatUw 
with introductory rule of the form
\gatdisplayrule{\xDelta{n}}{\ofT{f(\xn)}{\Delta}} 
and for some expressions $\tn$ such that \foreachi, the rule
\gatdisplayrule{\yOmega{m}}{\ofT{t_i}{\Delta_i[t_1|x_1,...t_{i-1}|x_{i-1}]}} is a derived rule of \gatUw
and such that
\gatdisplayrule{\yOmega{m}}{\Delta[t_1|x_1,...t_{i-1}|x_{i-1}]=\Omega} is a derived rule of \gatU.
\end{enumerate}

\note The Weakening Lemma\footnote{Lemma 4 of section 1.7 of \cite{Cartmell78} (page 1.37)}. In brief, if the premise of a derived rule is weakened then the resulting rule is a derived rule. More precisely, if 
\gatdisplayrule{\xDelta{n}}{\isT{\Delta}}  and
\gatdisplayrule{\xDelta{n},\yOmega{m}}{Conclusion} are both derived rules of \gatUw then if $z$ is a variable
distinct from $\xn,\ym$ then
the (weakened) rule \gatdisplayrule{\xDelta{n},z \in \Delta,\yOmega{m}}{Conclusion} is a derived rule
of \gatU.

\note The Stratification Lemma\footnote{Lemma 3 of section 1.7 of \cite{Cartmell78} (page 1.36)}. For each generalised algebraic theory \gatUw  there is a sequence of finite theories 
$\gatU_0 \subseteq \gatU_1 \subseteq \gatU_2 \subseteq ...$ such that  \inlinedisplay{\gatU = \bigcup_i \gatU_i}
and such that each $\gatU_{i+1}$ is a simple extension of $\gatU_i$ in the sense that each introductory rule and axiom of $\gatU_{i+1}$ is a well-typed  with respect to $\gatU_i$.

\note We will also use the Finite Subtheory Lemma: if r is a derived rule of U then 
it is a derived rule of some finite subtheory $F \subseteq U$. 

\note 
An interpretation $I$ of \gatUw in \catcw is a  mapping 
of derived T- and $\in$- rules of \gatUw to objects, respectively sections, of \gatUw that satisfies the following:
\begin{enumerate}[(i)]
\setlength\itemindent{2cm}
\item \underline{\textbf{T-rules}} 
Suppose that  the rule
\gatdisplayrule{\xDelta{n}}{\isT{\Delta}} is a derived rule of \gatUw which is mapped by $I$ to an object $a$ of \catc. Denote this rule $r$. Recall that because $r$ is a derived rule then it follows  that for each $i$, 
$1 \leq i \leq n$, the rule \gatdisplayrule{\xDelta{i-1}}{\isT{\Delta_i}} is a derived rule of \gatU. Let $r_i$ denote this rule.
Suppose that $I$ maps each rule $r_i$ to an object $a_i$ of \catcw.
It is required that $1 \base a_1 \base ... \base a_n \base a$ in \catc.

Suppose that the  expression $\Delta$ is exactly the expression $\Delta_i$, for some $i$, $1 \leq i \leq n$. In this special case we require that the rule $r$  is mapped by $I$ to the object 
$\crossx{a_n}{a_i}{a_{i-1}}$. 

\item \underline{\textbf{$\boldsymbol {\in}$-rules}} 
In addition to the assumptions made in (i),  suppose that the rule
\gatdisplayrule{\xDelta{n}}{\ofT{t}{\Delta}} is a  derived rule of \gatU. 
Denote this rule $r_t$. It is required that $I$ maps the rule $r_t$ to a section
 $s:a_n \morph a$ in \catcw i.e. to a morphism $s:a_n \morph a$ such that $s \circ p_a = id_{a_n}$. 

Suppose that the  expression $\Delta$ is exactly the expression $\Delta_i$, for some $i$, $1 \leq i \leq n$ and that the expression $t_i$ is simply the variable $x_i$. 
In this special case we require that the rule $r_t$  is mapped by $I$ to the section\footnote{
With these assumptions, $s(p_{a_n,a_i}): a_n \morph \crossx{a_n}{a_i}{a_{i-1}}$ in \catcw because by definition  $s(p_{a_n,a_i}): a_n  \morph (p_{a_n,a_i} \circ p_{a_i})^*a_i$,
and we have 
\begin{align*}
(p_{a_n,a_i} \circ p_{a_i})^*a_i &= {p_{a_n,a_{i-1}}} ^* a_i  && \mbox{ because $p_{a_n,a_i} \circ p_{a_i}=p_{a_n,a_{i-1}}$,} \\
                                 &= \crossx{a_n}{a_i}{a_{i-1}} && \mbox{ by definition of $\crossx{}{}{w}$}.
\end{align*}
} % end footnote
$s(p_{a_n,a_i})$ of the object $\crossx{a_n}{a_i}{a_{i-1}}$. 

\item \underline{\textbf{T=-rules}} 
In addition to the assumptions made in (i), suppose that  
the rule \gatdisplayrule{\xDelta{n}}{\Delta = \Delta'} is a derived rule of \gatU. 
We may deduce that the
\gatdisplayrule{\xDelta{n}}{\isT{\Delta'}} is a derived rule of \gatU. Denote this latter rule $r'$.
It is required that the rule $r'$ is mapped by $I$ to the same object $a$ of \catcw that $r$ is mapped to.

\item \underline{\textbf{$\boldsymbol{\in=}$-rules}} 
In addition to the assumptions made in (ii),  suppose that the rule
\gatdisplayrule{\xDelta{n}}{t = t' \in \Delta}
is a derived rule of \gatU. We may deduce that the rule
\gatdisplayrule{\xDelta{n}}{\ofT{t'}{\Delta}} is a  derived rule of \gatU. 
Denote this latter rule $r'_t$.
It is required that the rule $r'_t$ is mapped by $I$ to the same section $s$ of $a$ that $r_t$ is mapped to.

\item \underline{\textbf{weakening T-rules}} 
Suppose now that $Q$ is any context of \gatUw and that the rule 
\gatdisplayrule{\yOmega{m}}{\isT{\Omega}} is a derived rule of \gatU. Denote this rule $r_\Omega$. 
It follows that \foreachj, the rule   \gatdisplayrule{\yOmega{j-1}}{\isT{\Omega_j}} is a derived rule of \gatU. Denote this rule $r_{\Omega_j}$.
Suppose that each rule $r_{\Omega_j}$ is mapped by $I$ to an object $b_j$ of \catcw and that rule $r_\Omega$ is mapped by $I$ to an object $b$ of \catcw so that
we have that $b_1 \base ... \base b_m \base b$ in \catc.

By the simple weakening lemma it follows that the rules
\gatdisplayrule{Q, \yOmega{j-1}}{\isT{\Omega_j}}, \foreachj, and 
\gatdisplayrule{Q, \yOmega{m}}{\isT{\Omega}} are  derived rule of \gatU. It is required that these rules are mapped by $I$ to the objects
$\crossx{a}{b_1}{1},...\crossx{a}{b_m}{1}$ and to $\crossx{a}{b}{1}$, respectively. 

\item \underline{\textbf{weakening $\boldsymbol {\in}$-rules}} 
Suppose in addition that the rule \gatdisplayrule{\yOmega{m}}{\ofT{s}{\Omega}} is a derived rule of \gatUw 
and that this rule is mapped by $I$ to a section $g$ of object $b$ in \catc.
By the simple weakening lemma it follows that the rule \gatdisplayrule{Q, \yOmega{m}}{\ofT{s}{\Omega}}
is a derived rule of \gatU. It is required that this rule is mapped by $I$ to the section $\crossx{a}{s}{1}$
of object $\crossx{a}{b}{1}$ of \catc.


\item \underline{\textbf{substituting in T-rules}} 
Suppose that, as in (v), above, the rule 
\gatdisplayrule{\yOmega{m}}{\isT{\Omega}} is a derived rule of \gatU.
We may deduce that \foreachj, the rule   \gatdisplayrule{\yOmega{j-1}}{\isT{\Omega_j}} is a derived rule of \gatU. 
Suppose that, as in (v), these rules are mapped by $I$ to objects $b_1,...b_n$ and $b$ so that
we have  $b_1 \base ... \base b_m \base b$ in \catc. Now suppose that for some $j$, $1 \leq j \leq m$, the rule
\gatdisplayrule{\yOmega{j-1}}{\ofT{t}{\Omega_j}} is a derived rule of \gatU. 
Now it follows by the substitution lemma that for each $j'$, $j < j' \leq m$ the rule

\gatdisplayrule{\yOmega{j-1}, y_{j+1}\in \Omega_{j+1}[t|y_j],... y_{j'-1} \in \Omega_{j'-1}[t|y_j] }{\isT{\Omega_j[t|y_j]}} is a derived rule of \gatUw and that likewise the rule

\gatdisplayrule{\yOmega{j-1}, y_{j+1}\in \Omega_{j+1}[t|y_j],... y_m \in \Omega_m[t|y_j] }{\isT{\Omega}[t|y_j]} is a derived rule of \gatU.
It is required that these rules are mapped by $I$ to objects $f^*b_{j+1},...f^*b_m$ and $f^*b$, respectively.
Note that as required we have that $f^*b_{j+1}\base ... \base f^*b_m \base f^*b$ in \catc.

\item \underline{\textbf{substituting in $\boldsymbol {\in}$-rules}} 
Suppose that in addition to the situation in (vii), above, the rule
\gatdisplayrule{\yOmega{m}}{\ofT{s}{\Omega}}
is a derived rule of \gatUw and suppose that this rule is mapped to a section $g$ of object $b$ of \catc.
Now it follows by the substitution lemma that the rule
\gatdisplayrule{\yOmega{j-1}, y_{j+1}\in \Omega_{j+1}[t|y_j],... y_m \in \Omega_m[t|y_j]}{\ofT{s[t|y_j]}{\Omega[t|y_j]}} 
is a derived rule of \gatU.
It is a requirement that this rule is mapped by $I$ to the section $f^*g$ of object $f^*b$ of \catc.
\end{enumerate}


\note
We can show that an interpretation $I$ of a contextual category \gatUw in a contextual category \catcw is
completely determined by its mapping of the introductory rules of sort symbols and operator symbols to
objects, respectively, sections of \catc. In order to show this first define a preinterpretation as follows:
\begin{definition}
If \gatUw is a generalised algebraic theory  and if \catcw is a contextual category then
a \term{preinterpretation} $I$ of  \gatU in \catcw consists of a pair :
\begin{itemize}
\item a mapping $\Isort$ that maps each sort symbol of \gatUw to  an object of \catc,
\item a mapping $\Iop$ that maps each operator symbol of \gatUw to a section of \catcw (i.e. to a morphism $f: A \morph B$ for some 
$A \base B$ in \catcw such that $f \circ p_B=id_A$).
\end{itemize}
\end{definition}












\note 
\begin{lemma}
\label{finiteinterpretationlemma}
If $F$ is a finite generalised algebraic theory and if $P$ is a preinterpretation of $F$ in a contextual category \catcw then there is at most one interpretation $I$ of $F$ in \catcw that is consistent with $P$.
\end{lemma}
\begin{proof}
By induction on the theory $F$. True for the empty theory. Then provably true as sort symbols and operator symbols are added.
\end{proof} 
\begin{lemma}
If \gatUw is any finite generalised algebraic theory and if $P$ is a preinterpretation of \gatUw in a contextual category \catcw then there is at most one interpretation $I$ of \gatUw in \catcw that is consistent with $P$.
\end{lemma}
\begin{proof}
Use lemma \ref{finiteinterpretationlemma} as follows.
Suppose $I$ and $I'$ are interpretations of \gatUw in \catc.
We aim to show that for all derived T-rules or $\in$-rules $r$ of \gatU, $I(r)=I'(r)$.
Suppose then that $r$ is a derived T-rule or $\in$-rule of \gatU. Since $r$ is a derived rule of \gatUw then by lemma \lref{stratification lemma} it is a derived rule of some finite subtheory $F \subseteq \gatU$. 
Now $I \restriction F$ and $I' \restriction F$ are interpretations
of $F$ that both extend the preinterpretation $P \restriction F$. Therefore $I \restriction F$ = $I' \restriction F$
from which we may derive $I(r) = (I \restriction F) (r) = (I' \restriction F)(r) = I'(r)$, as required. 
\end{proof}

\note
 For a preinterpretation to extend to an interpretation (we will say that it *is* an interpretation) 
it will need be type correct and to satisy the axioms of the theory. The definition of exactly what we mean by this has to proceed by induction there because, for example, we need an interpretation of the rule
\gatdisplayrule{\xDelta{n}}{\isT{\Delta}} (as an object $a$ of \catc, say) before we can say whether a preinterpretation of an operator with introductory rule \genericfintroductoryrule
is well-typed (i.e. a section of object $a$).
Similarly we need to be able to interpret both sides of an axiom before we can say whether it is respected. 

\note Suppose $P$ be a preinterpretation of \gatUw in contextual category \catc.
Let $\gatU_0 \subseteq \gatU_1 \subseteq \gatU_2 \subseteq ...$ be the stratification of \gatU. 
Let $P_i$ be the restriction of $P$ to $U_i$. 
We define $P$ to be well-typed and to respect all axioms 
providing that  each  $P_i$ is well-typed and respects all axioms of $\gatU_i$ and 
what we mean by this we define by induction. 
At the same time we prove that if $P_i$ is well-typed and respects all axioms of $\gatU_i$ then $P_i$
extends uniquely to an interpretation of $\gatU_i$.  

For the inductive step we require
\begin{lemma}
\item $P_{i+1}$ extends uniquely to an interpretation of $U_{i+1}$ iff  $P_i$ extends uniquely to an interpretation of $U_{i}$ and additionally:
\begin{enumerate}[(i)]
\item
$P_{i+1}$ is well-typed on sort symbol $A$ of $U_{i+1}$. This we define to mean that
for all sort symbols $A$ in $U_{i+1}$, if $A$ has introductory rule 
\genericAintroductoryrule and if this rule is mapped by $P_{i+1}$
to object $a$ of \catcw then $I_i(r_n) \base a$ in \catc, where $r_n$ is the rule 
\gatdisplayrule{\xDelta{n-1}}{\isT{\Delta_n}} (which, as required and due to the stratification, is a derived rule of $\gatU_i$).
\item  $P_{i+1}$ is well-typed on operator symbols  of $U_{i+1}$. This we define to mean that
for all sort symbols $f$ in $U_{i+1}$, if $f$ has introductory rule 
\genericfintroductoryrule then $P_{i+1}$ maps this rule to a section 
of $I_i(r)$ where $r$ is the rule
\gatdisplayrule{\xDelta{n}}{\isT{\Delta}} (which, as required and due to the stratification, is a derived rule of $\gatU_i$). 
\item
 $I_i$ respects the axioms of $U_{i+1}$. By this we mean that 
\begin{enumerate}[(i)]
\item \underline{\textbf{T=-axioms}} 
for all axioms of $U_{i+1}$ of the form
 \gatdisplayrule{\xDelta{n}}{\Delta = \Delta'},
$I_i(r) = I_i(r')$ where $r$ is the rule
\gatdisplayrule{\xDelta{n}}{\isT{\Delta}} and  
and $r'$ is the rule \gatdisplayrule{\xDelta{n}}{\isT{\Delta'}}
\item \underline{\textbf{$\boldsymbol{\in=}$-axioms}} 
for all axioms of $U_{i+1}$ of the form
\gatdisplayrule{\xDelta{n}}{t = t' \in \Delta}
$I_i(r_t) = I_i(r'_t)$ where $r_t$ is the rule
\gatdisplayrule{\xDelta{n}}{\ofT{r_t}{\Delta}} and  
and $r'_t$ is the rule \gatdisplayrule{\xDelta{n}}{\ofT{t'}{\Delta'}}.
\end{enumerate}
 
\end{enumerate}
\end{lemma}
\begin{proof}

\end{proof}

\newpage
\begin{oldtt}
\note The definition of $\Ihat$ from $\Isort$ and $\Iop$ whenever $I$ is an interpretation proceeds by induction 
on the derivation of rules in  \gatUw 
as described in the principles of derivation in Definition 2(b) of \cite{Cartmell86}. 
The only non-trivial parts of this definition relate to the rules
identified as CF1, CF2(a) and CF2(b)\footnote{So identified, by the way, as a mnemonic for cut-free.}. We consider each of these rules in turn.

\begin{point}
Rule CF1 states that for $n \geq 0$, for $1 \leq i \leq n+1$, from the derived rule 
$\frac{\xDelta{n}}{\isT{\Delta_{n+1}}}$ which we shall denote $R$ 
we may derive the rule
$\frac{\xDelta{n+1}}{\ofT{x_i}{\Delta_i}}$ which, in turn, we shall denote $R_{x_i}$.
Define $\Ihat(R_{x_i}) :  \Ihat(R) \morph \crossx{\Ihat(R)}{\Ihat(R_i)}{\Ihat(R_{i-1})}$
to be $\tuple{p_{\Ihat(R),\Ihat(R_{i-1})},p_{\Ihat(R),\Ihat(R_{i})}}$. 

This presumably is $s(p_{\Ihat(R),\Ihat(R_{i-1})})$ where $s$ is Vladimir's s-operator.
\end{point}
\begin{point}
CF2(a) states that if $A$ is a sort symbol introduced by
$\frac{\xDelta{n}}{\isT{A(\xn)}}$ 
and if $P$ is a context and $\tn$ are expressions then from the following rules, which we shall denote $R_{t_1}$,..$R_{t_n}$,
$\frac{P}{\ofT{t_1}{\Delta_1}}$,
$\frac{P}{\ofT{t_2}{\Delta_2[t_1|x_1]}}$,
... and 
$\frac{P}{\ofT{t_n}{\Delta_n[t_1|x_1,...t_{n-1}|x_{n-1}]}}$
we may derive the rule
$\frac{P}{\isT{A(t_1,...t_n)}}$ which we denote as $R$. 
Define $I(R)$ to be $\Ihat(R_n)^*...\Ihat(R_1)^*\crossx{\Ihat(R_n)}{I(A)}{1}$.\commentary{check this}
\end{point}
\begin{point}
CF2(b) \highlight{fill this in}
\end{point}
\end{oldtt}

\begin{oldtt}
\begin{displaymath}
\begin{array}{c}
\crossx{a_n}{a_i}{\Rnode{cross}{a_{i-1}}} \\[0.9cm]
\Rnode{an}{a_n}\\[0.7cm]
%\Rnode{highervdots}{\vdots}\\
\Rnode{ai}{\begin{array}{c}
\vdots\\
a_i\\
\vdots
\end{array}} \\[1.1cm]
%\Rnode{lowervdots}{\vdots}\\[0.4cm]
\Rnode{a1}{a_1}\\[0.7cm]
\Rnode{abs}{1}
\end{array}
\end{displaymath}
\ncsar{cross}{an}
%\ncsar{an}{highervdots}
%\ncsar{lowervdots}{a1}
\ncsar{an}{ai}
\ncsar{ai}{a1}
\ncsar{a1}{abs}
\ncarc[arcangle=30,nodesepA=5pt,offsetA=2pt,nodesepB=2pt,offsetB=2pt]{->}{an}{cross}
\alabel{s(p_{a_n,a_i})}
\end{oldtt}

\begin{oldtt}
\note 3
\label{omegarealisationwrtQ}
 Suppose also that $\encyOmega{m}$ is a context of generalised algebraic theory \gatUw and suppose that $Q$ is some other context and that for some $m \geq 1$,
 \foreachj, \gatdisplayrule{Q}{\ofT{s_j}{\Omega_j[s_1|y_1,...s_{j-1}|y_{j-1}]}} is a derived rule of \gatU\footnote{Recall that such an m-tuple $\tuple{\sm}$ is said to be a realisation of 
$\encyOmega{m}$ wrt $Q$.}.  Suppose that an interpretation $I$ of \gatUw in a contextual category \catcw maps the context $Q$ to an object $a$  of $\catc$ and maps
the context $\encyOmega{j}$ to an object $b_j$ of \catc, \foreachj, so that $1 \base b_1 ... \base b_m$ in \catc. In this situation the rule 
\gatdisplayrule{Q}{\ofT{s_1}{\Omega_1}} will be mapped by $I$ to some section $f_1:a \morph \crossx{a}{b_1}{1}$. The j'th rule,
\gatdisplayrule{Q}{\ofT{s_j}{\Omega_j[s_1|y_1,...s_{j-1}|y_{j-1}]}}, will be mapped to a section $f_j:a \morph \fjpstar ... \fonestar\crossx{a}{b_j}{1}$.
In the case that $m=3$  then in \catcw we will have objects and morphisms as follows:
\begin{displaymath}
\begin{array}{c p{1cm} c p {1cm} c  p{1cm} c}
                                                &&                                           && \Rnode{ab3}{\crossx{a}{b_3}{1}}                       \\[1.2cm]
                                                &&\Rnode{f1axb3}{\fonestar\crossx{a}{b_3}{1}}  && \Rnode{ab2}{\crossx{a}{b_2}{1}}                       \\[1.2cm]
 \Rnode{f3target}{\ftwostar\fonestar\crossx{a}{b_3}{1}} &&\Rnode{f2target}{\fonestar\crossx{a}{b_2}{1}}  && \Rnode{ab1}{\crossx{a}{b_1}{\Rnode{f1target}{1}}}     \\[1.2cm]
                                                &&\Rnode{a}{a}                               &&                                                       \\[-3.0cm]
																								&&                                           &&                         && \Rnode{b3}{b_3}             \\[1.2cm]
																								&&                                           &&                         && \Rnode{b2}{b_2}             \\[1.2cm]
																								&&                                           &&                         && \Rnode{b1}{b_1}             \\[1.1cm]
																								&&                                           && \Rnode{abs}{1} \ \ \ \ \ \ \ \ &&    
\end{array}
\end{displaymath}
\ncarr{ab3}{b3}
\ncarr{ab2}{b2}
\ncarr{ab1}{b1}
\ncarr{f1axb3}{ab3}
\ncarr{f2target}{ab2}
\ncarr{f3target}{f1axb3}
\ncarc[arcangle=10,nodesepA=5pt,offsetA=2pt,nodesepB=2pt,offsetB=2pt]{->}{a}{f1target}
\alabel{f_1}[0.25]
\ncarc[arcangle=15,nodesepA=5pt,offsetA=2pt,nodesepB=2pt,offsetB=2pt]{->}{a}{f2target}
\alabel{f_2}
\ncarc[arcangle=10,nodesepA=5pt,offsetA=2pt,nodesepB=2pt,offsetB=2pt]{->}{a}{f3target}
\alabel{f_3}
\ncsar{f3target}{a}
\ncsar{f2target}{a}
\ncsar{f1target}{a}
\ncsar{ab2}{ab1}
\ncsar{ab3}{ab2}
\ncsar{f1axb3}{f2target}
\ncsar{b3}{b2}
\ncsar{b2}{b1}
\ncsar{b1}{abs}
\nccdar{a}{abs}

\note 
How suppose that additional to the situation of para. \ref{omegarealisationwrtQ} the rules 
\gatdisplayrule{\yOmega{m}}{\isT{\Delta}} and  \gatdisplayrule{\yOmega{m}}{\ofT{t}{\Delta}} are derived rules of \gatUw. 
Let us denote these rules $r$ and $r_t$, respectively. Suppose that $I$ is an interpretation of $\gatUw$ in \catcw as mapping rules and contexts as described in para. \ref{omegarealisationwrtQ}.
From what we have said in para \ref{omegarealisationwrtQ}, the interpretation  $I$ will map rule $r$ to an object $b$ such that ${b_m \base b}$ in \catcw and it will map the rule $r_t$ to a section $g:b_m \morph b$.  

Now it follows by the substitution lemma (see \cite{Cartmell86})
that the substituted $r$ and $r_t$ rules: 
\gatdisplayrule{Q}{\isT{\Delta[s_1|y_1...s_m|y_m]}} 
and  \gatdisplayrule{Q}{\ofT{t[s_1|y_1...s_m|y_m]}{\Delta[s_1|y_1...s_m|y_m]}} are derived rules of \gatU. 

\highlight{We require that}
the substituted $r$ rule will be mapped by $I$ to the object $\smstar...\sonestar\crossx{a}{b}{1}$ and the substituted $r_t$ rule will
be mapped by $I$ to the morphism  $\smstar...\sonestar\crossx{a}{g}{1}$ (which is defined since $g$ is a section).
\end{oldtt}
